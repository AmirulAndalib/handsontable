(function(e){function t(t){for(var r,a,l=t[0],s=t[1],u=t[2],f=0,h=[];f<l.length;f++)a=l[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);c&&c(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0393":function(e,t,n){"use strict";n("b43b"),n("6b2f"),n("8116"),n("a0c5"),n("bebe"),n("5d07"),n("d562"),n("212c"),n("9827");var r,o=n("d1f5"),i=n("bb9b"),a=n("e0a9"),l=n("0d2c"),s=n("e015"),u=n("3731");function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var p=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],y=Object(s["a"])(r||(r=d(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.']))),v=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),g=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),b=function(){function e(){c(this,e),this.globalBucket=this.createEmptyBucket()}return h(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return Object(o["arrayEach"])(p,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))Object(o["arrayEach"])(t,(function(t){return n.add(e,t,r)}));else{v.has(e)&&Object(l["b"])(Object(a["substitute"])(y,{hookName:e,removedInVersion:v.get(e)})),g.has(e)&&Object(l["b"])(g.get(e));var i=this.getBucket(r);if("undefined"===typeof i[e]&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)){var s=!1;t.initialHook&&Object(o["arrayEach"])(i[e],(function(n,r){if(n.initialHook)return i[e][r]=t,s=!0,!1})),s||i[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?Object(o["arrayEach"])(t,(function(t){return n.once(e,t,r)})):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return"undefined"!==typeof r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,i,a,l){var s=this.globalBucket[t],c=s?s.length:0,f=0;if(c)while(f<c)if(s[f]&&!s[f].skip){var h=Object(u["fastCall"])(s[f],e,n,r,o,i,a,l);void 0!==h&&(n=h),s[f]&&s[f].runOnce&&this.remove(t,s[f]),f+=1}else f+=1;var d=this.getBucket(e)[t],p=d?d.length:0,y=0;if(p)while(y<p)if(d[y]&&!d[y].skip){var v=Object(u["fastCall"])(d[y],e,n,r,o,i,a,l);void 0!==v&&(n=v),d[y]&&d[y].runOnce&&this.remove(t,d[y],e),y+=1}else y+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(i["objectEach"])(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||p.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&p.splice(p.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return g.has(e)||v.has(e)}},{key:"isRegistered",value:function(e){return p.indexOf(e)>=0}},{key:"getRegistered",value:function(){return p}}],[{key:"getSingleton",value:function(){return w()}}]),e}(),m=new b;function w(){return m}t["a"]=b},"097b":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return f}));n("8116"),n("a0c5"),n("bebe"),n("5d07"),n("d562"),n("d3af"),n("841e");var r=n("c61e"),o=n("bb9b"),i=n("362c");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var u=0,c=function(){function e(){a(this,e),this.collection=new Map}return s(e,[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),u+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);Object(r["isDefined"])(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),u-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return Object(r["isUndefined"])(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}]),e}();function f(){return u}Object(o["mixin"])(c,i["a"])},"0d2c":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("c61e");function o(){var e;Object(r["isDefined"])(console)&&(e=console).warn.apply(e,arguments)}function i(){var e;Object(r["isDefined"])(console)&&(e=console).error.apply(e,arguments)}},"0da0":function(e,t,n){"use strict";n.r(t),n.d(t,"isNumeric",(function(){return c})),n.d(t,"isNumericLike",(function(){return f})),n.d(t,"rangeEach",(function(){return h})),n.d(t,"rangeEachReverse",(function(){return d})),n.d(t,"valueAccordingPercent",(function(){return p}));n("2931"),n("9dec"),n("60ed"),n("841e"),n("5d07"),n("8116"),n("bebe"),n("bdb6"),n("d562"),n("2a17"),n("2cf3"),n("bfe9"),n("ba9f"),n("7ae5"),n("2b96"),n("3d35"),n("213d"),n("b43b"),n("0a66");function r(e){return l(e)||a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e){if(Array.isArray(e))return s(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=u(e);if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var o=Array.from(new Set(["."].concat(r(t)))).map((function(e){return"\\".concat(e)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(o,")?\\d+((").concat(o,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&(!!e&&"number"===typeof e.valueOf()&&!(e instanceof Date))}function f(e){return c(e,[","])}function h(e,t,n){var r=-1;"function"===typeof t?(n=t,t=e):r=e-1;while(++r<=t)if(!1===n(r))break}function d(e,t,n){var r=e+1;"function"===typeof t&&(n=t,t=0);while(--r>=t)if(!1===n(r))break}function p(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}},"0f99":function(e,t,n){"use strict";n.r(t),n.d(t,"instanceToHTML",(function(){return d})),n.d(t,"_dataToHTML",(function(){return p})),n.d(t,"htmlToGridSettings",(function(){return y}));n("2cf3"),n("2931"),n("bfe9"),n("9dec"),n("60ed"),n("0ee2"),n("7ae5"),n("bebe"),n("2a17"),n("9827"),n("1b48"),n("1fe0"),n("89c5"),n("841e"),n("5d07"),n("129d"),n("6315"),n("267c"),n("986e"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("d562"),n("b43b"),n("0a66");var r=n("c61e");function o(e){return s(e)||l(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){if(e){if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function l(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function s(e){if(Array.isArray(e))return u(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},f=new RegExp(Object.keys(c).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function h(e){return"TABLE"===(e&&e.nodeName||"")}function d(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),o=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,o),a=i.length,l=a>0?i[0].length:0,s=["<table>","</table>"],u=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],f=n?1:0,h=t?1:0,d=0;d<a;d+=1){for(var p=t&&0===d,y=[],v=0;v<l;v+=1){var g=!p&&n&&0===v,b="";if(p)b="<th>".concat(e.getColHeader(v-f),"</th>");else if(g)b="<th>".concat(e.getRowHeader(d-h),"</th>");else{var m=i[d][v],w=e.getCellMeta(d-h,v-f),O=w.hidden,C=w.rowspan,S=w.colspan;if(!O){var R=[];if(C&&R.push('rowspan="'.concat(C,'"')),S&&R.push('colspan="'.concat(S,'"')),Object(r["isEmpty"])(m))b="<td ".concat(R.join(" "),"></td>");else{var k=m.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(R.join(" "),">").concat(k,"</td>")}}}y.push(b)}var E=["<tr>"].concat(y,["</tr>"]).join("");p?u.splice(1,0,E):c.splice(-1,0,E)}return s.splice(1,0,u.join(""),c.join("")),s.join("")}function p(e){for(var t=e.length,n=["<table>"],o=0;o<t;o+=1){var i=e[o],a=i.length,l=[];0===o&&n.push("<tbody>");for(var s=0;s<a;s+=1){var u=i[s],c=Object(r["isEmpty"])(u)?"":u.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l.push("<td>".concat(c,"</td>"))}n.push.apply(n,["<tr>"].concat(l,["</tr>"])),o+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},r=t.createDocumentFragment(),i=t.createElement("div");r.appendChild(i);var a=e;if("string"===typeof a){var l=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),r="</td>";return"".concat(t).concat(n).concat(r)}));i.insertAdjacentHTML("afterbegin","".concat(l)),a=i.querySelector("table")}if(a&&h(a)){var s=i.querySelector('meta[name$="enerator"]'),u=null!==a.querySelector("tbody th"),d=a.querySelector("tr"),p=d?Array.from(d.cells).reduce((function(e,t){return e+t.colSpan}),0)-(u?1:0):0,y=a.tFoot&&Array.from(a.tFoot.rows)||[],v=[],g=!1,b=0,m=0;if(a.tHead){var w=Array.from(a.tHead.rows).filter((function(e){var t=null!==e.querySelector("td");return t&&v.push(e),!t}));b=w.length,g=b>0,b>1?n.nestedHeaders=Array.from(w).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,t,n){if(u&&0===n)return e;var r=t.colSpan,o=t.innerHTML,i=r>1?{label:o,colspan:r}:o;return e.push(i),e}),[]);return e.push(n),e}),[]):g&&(n.colHeaders=Array.from(w[0].children).reduce((function(e,t,n){return u&&0===n||e.push(t.innerHTML),e}),[]))}v.length&&(n.fixedRowsTop=v.length),y.length&&(n.fixedRowsBottom=y.length);var O=[].concat(v,o(Array.from(a.tBodies).reduce((function(e,t){return e.push.apply(e,o(Array.from(t.rows))),e}),[])),o(y));m=O.length;for(var C=new Array(m),S=0;S<m;S++)C[S]=new Array(p);for(var R=[],k=[],E=0;E<m;E++)for(var j=O[E],T=Array.from(j.cells),P=T.length,M=0;M<P;M++){var A=T[M],I=A.nodeName,_=A.innerHTML,x=A.rowSpan,H=A.colSpan,N=C[E].findIndex((function(e){return void 0===e}));if("TD"===I){if(x>1||H>1){for(var D=E;D<E+x;D++)if(D<m)for(var L=N;L<N+H;L++)C[D][L]=null;var B=A.getAttribute("style"),V=B&&B.includes("mso-ignore:colspan");V||R.push({col:N,row:E,rowspan:x,colspan:H})}var F="";F=s&&/excel/gi.test(s.content)?_.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):_.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),C[E][N]=F.replace(f,(function(e){return c[e]}))}else k.push(_)}return R.length&&(n.mergeCells=R),k.length&&(n.rowHeaders=k),C.length&&(n.data=C),n}}},"103a":function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return R})),n.d(t,"d",(function(){return k}));n("2b96"),n("3d35"),n("bebe"),n("267c"),n("986e"),n("8116"),n("bdb6"),n("5d07"),n("d562"),n("841e"),n("0b09"),n("213d"),n("b43b"),n("0a66"),n("2931");var r=n("8b2a"),o=n("d1f5"),i=n("c61e");function a(e,t){return f(e)||c(e,t)||s(e,t)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function f(e){if(Array.isArray(e))return e}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}var d=0,p=1,y=2,v=3,g=[v,y],b=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],m=Symbol("root"),w=Symbol("child");function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;if(t!==m&&t!==w)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),o=t===m,i=d;if(n){var a=e[0];if(0===e.length)i=p;else if(o&&a instanceof r["a"])i=v;else if(o&&Array.isArray(a))i=O(a,w);else if(e.length>=2&&e.length<=4){var l=!e.some((function(e,t){return!b[t].includes(h(e))}));l&&(i=y)}}return i}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!g.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=e===v,a=n?t.from.row:t[0],l=n?t.from.col:t[1],s=n?t.to.row:t[2],u=n?t.to.col:t[3];if("function"===typeof o&&("string"===typeof l&&(l=o(l)),"string"===typeof u&&(u=o(u))),Object(i["isUndefined"])(s)&&(s=a),Object(i["isUndefined"])(u)&&(u=l),!r){var c=a,f=l,h=s,d=u;a=Math.min(c,h),l=Math.min(f,d),s=Math.max(c,h),u=Math.max(f,d)}return[a,l,s,u]}}function S(e){var t=O(e);if(t===d||t===p)return[];var n=C(t),r=new Set;Object(o["arrayEach"])(e,(function(e){var t=n(e),i=a(t,4),l=i[1],s=i[3],u=Math.max(l,0),c=s-u+1;Object(o["arrayEach"])(Array.from(new Array(c),(function(e,t){return u+t})),(function(e){r.has(e)||r.add(e)}))}));var i=Array.from(r).sort((function(e,t){return e-t})),l=Object(o["arrayReduce"])(i,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[]);return l}function R(e){var t=O(e);if(t===d||t===p)return[];var n=C(t),r=new Set;Object(o["arrayEach"])(e,(function(e){var t=n(e),i=a(t,3),l=i[0],s=i[2],u=Math.max(l,0),c=s-u+1;Object(o["arrayEach"])(Array.from(new Array(c),(function(e,t){return u+t})),(function(e){r.has(e)||r.add(e)}))}));var i=Array.from(r).sort((function(e,t){return e-t})),l=Object(o["arrayReduce"])(i,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[]);return l}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"===typeof e&&e>=0&&e<t}},"179d":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n("8116"),n("a0c5"),n("bebe"),n("5d07"),n("d562"),n("2b96"),n("3d35"),n("213d"),n("841e"),n("b43b"),n("0a66"),n("2931");function r(e){return l(e)||a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e){if(Array.isArray(e))return s(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=new Map;function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";u.has(e)||u.set(e,new Map);var t=u.get(e);function n(e,n){t.set(e,n)}function o(e){return t.get(e)}function i(e){return t.has(e)}function a(){return r(t.keys())}function l(){return r(t.values())}return{register:n,getItem:o,hasItem:i,getNames:a,getValues:l}}},"1af1":function(e,t,n){"use strict";n.d(t,"b",(function(){return X})),n.d(t,"a",(function(){return K})),n.d(t,"c",(function(){return $})),n.d(t,"d",(function(){return q}));n("2a17"),n("2b96"),n("3d35"),n("bebe"),n("213d"),n("8116"),n("5d07"),n("d562"),n("841e"),n("b43b"),n("0a66"),n("2931");var r=n("e0a9"),o=(n("a0c5"),n("60ed"),n("0b09"),n("0da0")),i=n("3731");function a(e){return u(e)||s(e)||h(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e){if(Array.isArray(e))return d(e)}function c(e,t){return y(e)||p(e,t)||h(e,t)||f()}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function y(e){if(Array.isArray(e))return e}var v="asc",g="desc",b=new Map([[v,[-1,1]],[g,[1,-1]]]),m=function(e){return"The priority '".concat(e,"' is already declared in a map.")},w=function(e){return"The priority '".concat(e,"' is not a number.")};function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,r=new Map;function l(e,i){if(!Object(o["isNumeric"])(e))throw new Error(n(e));if(r.has(e))throw new Error(t(e));r.set(e,i)}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=b.get(e)||b.get(v),n=c(t,2),o=n[0],i=n[1];return a(r).sort((function(e,t){return e[0]<t[0]?o:i})).map((function(e){return e[1]}))}return t=Object(i["isFunction"])(t)?t:m,n=Object(i["isFunction"])(n)?n:w,{addItem:l,getItems:s}}var C=n("1e0a");n("bdb6");function S(e){return j(e)||E(e)||k(e)||R()}function R(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){if(e){if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function E(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function j(e){if(Array.isArray(e))return T(e)}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;function r(e){if(n.has(e))throw new Error(t(e));n.add(e)}function o(){return S(n)}function a(){n.clear()}return t=Object(i["isFunction"])(t)?t:P,{addItem:r,clear:a,getItems:o}}function A(e,t){return x(e)||_(e,t)||D(e,t)||I()}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function x(e){if(Array.isArray(e))return e}function H(e){return B(e)||L(e)||D(e)||N()}function N(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){if(e){if("string"===typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}function L(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function B(e){if(Array.isArray(e))return V(e)}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var F=function(e){return'There is already registered "'.concat(e,'" plugin.')},W=function(e){return'There is already registered plugin on priority "'.concat(e,'".')},U=function(e){return'The priority "'.concat(e,'" is not a number.')},z=O({errorPriorityExists:W,errorPriorityNaN:U}),G=M({errorItemExists:F}),Y=Object(C["a"])({errorIdExists:F});function X(){return[].concat(H(z.getItems()),H(G.getItems()))}function K(e){var t=Object(r["toUpperCaseFirst"])(e);return Y.getItem(t)}function $(e){return!!K(e)}function q(e,t,n){var r=J(e,t,n),o=A(r,3);e=o[0],t=o[1],n=o[2],void 0===K(e)&&Q(e,t,n)}function Q(e,t,n){var o=Object(r["toUpperCaseFirst"])(e);if(Y.hasItem(o))throw new Error(F(o));void 0===n?G.addItem(o):z.addItem(n,o),Y.addItem(o,t)}function J(e,t,n){return"function"===typeof e&&(t=e,e=t.PLUGIN_KEY,n=t.PLUGIN_PRIORITY),[e,t,n]}},"1e0a":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n("8116"),n("a0c5"),n("bebe"),n("5d07"),n("d562"),n("e44e"),n("2b96"),n("3d35"),n("213d"),n("b43b"),n("0a66"),n("841e"),n("2931");var r=n("3731");function o(e){return l(e)||a(e)||c(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e){if(Array.isArray(e))return f(e)}function s(e,t){return d(e)||h(e,t)||c(e,t)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function d(e){if(Array.isArray(e))return e}var p=function(e){return"The id '".concat(e,"' is already declared in a map.")};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function i(e,r){if(h(e))throw new Error(t(e));n.set(e,r)}function a(e){return n.delete(e)}function l(){n.clear()}function u(e){var t=f().find((function(t){var n=s(t,2),r=n[0],o=n[1];return e===o&&r}))||[null],n=s(t,1),r=n[0];return r}function c(e){return n.get(e)}function f(){return o(n)}function h(e){return n.has(e)}return t=Object(r["isFunction"])(t)?t:p,{addItem:i,clear:l,getId:u,getItem:c,getItems:f,hasItem:h,removeItem:a}}},"1f1d":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return f}));n("2a17"),n("2931"),n("b43b"),n("6b2f");var r,o=n("c61e"),i=n("bb9b"),a=n("0d2c"),l=n("e015");function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function u(e,t){return Object(i["objectEach"])(t,(function(t,n){Object(o["isUndefined"])(e[n])&&(e[n]=t)})),e}function c(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=t.exec(e);return n?"".concat(n[1].toLowerCase(),"-").concat(n[2].toUpperCase()):e}function f(e){Object(o["isDefined"])(e)&&Object(a["a"])(Object(l["a"])(r||(r=s(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}},"27c2":function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return b}));n("267c"),n("986e"),n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562"),n("2b96"),n("3d35"),n("213d"),n("b43b"),n("0a66"),n("841e"),n("2931");var r=n("c89a"),o=n("b74a"),i=n("914e"),a=n("3225"),l=n("c61e");function s(e,t){return d(e)||h(e,t)||c(e,t)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function d(e){if(Array.isArray(e))return e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var g="editorManager.navigation",b="editorManager.handlingEditor",m=function(){function e(t,n,r){var o=this;p(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new a["a"](t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view._wt.update("onCellDblClick",(function(e,t,n){return o.onCellDblClick(e,t,n)}))}return v(e,[{key:"registerShortcuts",value:function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=t.getContext("editor"),i={group:b};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){e.closeEditorAndSaveChanges(t.isCtrlPressed()),e.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),e.activeEditor.focus()}}],i),n.addShortcuts([{keys:[["F2"]],callback:function(t){e.activeEditor&&e.activeEditor.enableFullEditMode(),e.openEditor(null,t)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(t,n){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.activeEditor&&(e.activeEditor.enableFullEditMode(),e.openEditor(null,t)):e.moveSelectionAfterEnter(n.includes("shift")),Object(o["stopImmediatePropagation"])(t)}}],i)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.selection.selectedRange.current().highlight,n=t.row,r=t.col,o=this.instance.runHooks("modifyGetCellCoords",n,r),a=n,l=r;if(Array.isArray(o)){var u=s(o,2);a=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(a,l);var c=this.instance.rootDocument.activeElement;if(c&&c.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var f=this.instance.getCellEditor(this.cellProperties),h=this.instance.getCell(n,r,!0);if(f&&h){var d=this.instance.colToProp(l),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(a),l);this.activeEditor=Object(i["b"])(f,this.instance),this.activeEditor.prepare(n,r,d,h,p,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=this;if(this.instance.isListening()){var n=e.keyCode;if(229!==n&&this.selection.isSelected()){var o=(e.ctrlKey||e.metaKey)&&!e.altKey;if(this.activeEditor&&!this.activeEditor.isWaiting()&&!Object(r["isFunctionKey"])(n)&&!Object(r["isCtrlMetaKey"])(n)&&!o&&!this.isEditorOpened()){var i=this.instance.getShortcutManager(),a=i.getContext("editor"),s={runOnlyIf:function(){return Object(l["isDefined"])(t.instance.getSelected())},group:g};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){t.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){t.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){t.instance.selection.transformStart(0,-1*t.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){t.instance.selection.transformStart(0,t.instance.getDirectionFactor())}}],s),this.openEditor("",e)}}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),w=new WeakMap;m.getInstance=function(e,t,n){var r=w.get(e);return r||(r=new m(e,t,n),w.set(e,r)),r},t["c"]=m},"2d75":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n("ba9f");var r=n("c9ef7"),o=n("8f61"),i=n("c61e"),a="text";function l(e,t,n,a,l,s,u){r["a"].apply(this,[e,t,n,a,l,s,u]);var c=s;if(!c&&u.placeholder&&(c=u.placeholder),c=Object(i["stringify"])(c),e.getSettings().trimWhitespace&&(c=c.trim()),u.rendererTemplate){Object(o["empty"])(t);var f=e.rootDocument.createElement("TEMPLATE");f.setAttribute("bind","{{}}"),f.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(f),f.model=e.getSourceDataAtRow(n),t.appendChild(f)}else Object(o["fastInnerText"])(t,c)}l.RENDERER_TYPE=a},"2e51":function(e,t,n){},3022:function(e,t,n){"use strict";n.r(t),n.d(t,"requestAnimationFrame",(function(){return h})),n.d(t,"isClassListSupported",(function(){return d})),n.d(t,"isTextContentSupported",(function(){return p})),n.d(t,"isGetComputedStyleSupported",(function(){return y})),n.d(t,"cancelAnimationFrame",(function(){return v})),n.d(t,"isTouchSupported",(function(){return g})),n.d(t,"hasCaptionProblem",(function(){return m})),n.d(t,"getComparisonFunction",(function(){return w})),n.d(t,"isPassiveEventSupported",(function(){return O}));n("74b4"),n("2b96"),n("3d35"),n("bebe"),n("213d"),n("8116"),n("5d07"),n("d562");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}for(var o,i,a,l=0,s=["ms","moz","webkit","o"],u=window.requestAnimationFrame,c=window.cancelAnimationFrame,f=0;f<s.length&&!u;++f)u=window["".concat(s[f],"RequestAnimationFrame")],c=window["".concat(s[f],"CancelAnimationFrame")]||window["".concat(s[f],"CancelRequestAnimationFrame")];function h(e){return u.call(window,e)}function d(){return!!document.documentElement.classList}function p(){return!!document.createTextNode("test").textContent}function y(){return!!window.getComputedStyle}function v(e){c.call(window,e)}function g(){return"ontouchstart"in window}function b(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),o=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function m(){return void 0===o&&b(),o}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i||(i="object"===("undefined"===typeof Intl?"undefined":r(Intl))?new Intl.Collator(e,t).compare:"function"===typeof String.prototype.localeCompare?function(e,t){return"".concat(e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1},i)}function O(){if(void 0!==a)return a;try{var e={get passive(){a=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(t){a=!1}return a}u||(u=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-l)),r=window.setTimeout((function(){e(t+n)}),n);return l=t+n,r}),c||(c=function(e){clearTimeout(e)})},"304f":function(e,t,n){"use strict";n.r(t),n.d(t,"setBrowserMeta",(function(){return l})),n.d(t,"setPlatformMeta",(function(){return s})),n.d(t,"isChrome",(function(){return u})),n.d(t,"isChromeWebKit",(function(){return c})),n.d(t,"isFirefox",(function(){return f})),n.d(t,"isFirefoxWebKit",(function(){return h})),n.d(t,"isSafari",(function(){return d})),n.d(t,"isEdge",(function(){return p})),n.d(t,"isEdgeWebKit",(function(){return y})),n.d(t,"isIE",(function(){return v})),n.d(t,"isIE9",(function(){return g})),n.d(t,"isMSBrowser",(function(){return b})),n.d(t,"isMobileBrowser",(function(){return m})),n.d(t,"isIOS",(function(){return w})),n.d(t,"isIpadOS",(function(){return O})),n.d(t,"isWindowsOS",(function(){return C})),n.d(t,"isMacOS",(function(){return S})),n.d(t,"isLinuxOS",(function(){return R}));n("2931");var r=n("bb9b"),o=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},i={chrome:o((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:o((function(e){return/CriOS/.test(e)})),edge:o((function(e){return/Edge/.test(e)})),edgeWebKit:o((function(e){return/EdgiOS/.test(e)})),firefox:o((function(e){return/Firefox/.test(e)})),firefoxWebKit:o((function(e){return/FxiOS/.test(e)})),ie:o((function(e){return/Trident/.test(e)})),ie9:o((function(){return!!document.documentMode})),mobile:o((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:o((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},a={mac:o((function(e){return/^Mac/.test(e)})),win:o((function(e){return/^Win/.test(e)})),linux:o((function(e){return/^Linux/.test(e)})),ios:o((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,o=e.vendor,a=void 0===o?navigator.vendor:o;Object(r["objectEach"])(i,(function(e){var t=e.test;t(n,a)}))}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;Object(r["objectEach"])(a,(function(e){var t=e.test;t(n)}))}function u(){return i.chrome.value}function c(){return i.chromeWebKit.value}function f(){return i.firefox.value}function h(){return i.firefoxWebKit.value}function d(){return i.safari.value}function p(){return i.edge.value}function y(){return i.edgeWebKit.value}function v(){return i.ie.value}function g(){return i.ie9.value}function b(){return i.ie.value||i.edge.value}function m(){return i.mobile.value}function w(){return a.ios.value}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&a.mac.value}function C(){return a.win.value}function S(){return a.mac.value}function R(){return a.linux.value}l(),s()},3137:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));n("129d"),n("bebe");var r=n("d1f5");function o(e,t){return Object(r["arrayMap"])(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function i(e,t){var n=t[0],o=t.length;return Object(r["arrayMap"])(e,(function(e){return e>=n?e+o:e}))}},3225:function(e,t,n){"use strict";n.d(t,"b",(function(){return f}));n("9827");var r=n("3022"),o=n("b74a");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var s=0,u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return l(e,[{key:"addEventListener",value:function(e,t,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function a(e){n.call(this,c(e))}return"boolean"===typeof i||Object(r["isPassiveEventSupported"])()||(i=!1),this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:a,options:i,eventManager:this}),e.addEventListener(t,a,i),s+=1,function(){o.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;while(i)if(i-=1,r=this.context.eventListeners[i],r.event===t&&r.element===e){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),s-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context){var t=this.context.eventListeners.length;while(t){t-=1;var n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),s-=1)}}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var n=e.document,r=e;n||(n=e.ownerDocument?e.ownerDocument:e,r=n.defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on".concat(t),o)}}]),e}();function c(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Object(o["stopImmediatePropagation"])(this)},e}function f(){return s}t["a"]=u},"32f9":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n("3128"),n("83a9"),n("bebe"),n("c9cc"),n("7003"),n("7cd7"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("b976"),o=n("349e"),i=n("3137");function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(){return c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function f(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=b(e),null===e)break;return e}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function p(e){var t=g();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===a(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var m=function(e){h(n,e);var t=p(n);function n(){return l(this,n),t.call(this,(function(e){return e}))}return u(n,[{key:"insert",value:function(e,t){var r=Object(i["b"])(this.indexedValues,t);this.indexedValues=Object(o["a"])(r,e,t),c(b(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=Object(o["b"])(this.indexedValues,e);this.indexedValues=Object(i["a"])(t,e),c(b(n.prototype),"remove",this).call(this,e)}}]),n}(r["a"])},"349e":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return f}));n("2a17"),n("b43b"),n("267c"),n("986e"),n("2b96"),n("3d35"),n("bebe"),n("213d"),n("8116"),n("5d07"),n("d562"),n("841e"),n("0a66"),n("2931");var r=n("d1f5");function o(e){return s(e)||l(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){if(e){if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function l(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function s(e){if(Array.isArray(e))return u(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n){return[].concat(o(e.slice(0,t)),o(n),o(e.slice(t)))}function f(e,t){return Object(r["arrayFilter"])(e,(function(e){return!1===t.includes(e)}))}},"362c":function(e,t,n){"use strict";var r=n("bb9b"),o=n("3731"),i="localHooks",a={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,i,a,l){if(this._localHooks[e])for(var s=this._localHooks[e].length,u=0;u<s;u++)Object(o["fastCall"])(this._localHooks[e][u],this,t,n,r,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Object(r["defineGetter"])(a,"MIXIN_NAME",i,{writable:!1,enumerable:!1}),t["a"]=a},3731:function(e,t,n){"use strict";n.r(t),n.d(t,"isFunction",(function(){return i})),n.d(t,"throttle",(function(){return a})),n.d(t,"throttleAfterHits",(function(){return l})),n.d(t,"debounce",(function(){return s})),n.d(t,"pipe",(function(){return u})),n.d(t,"partial",(function(){return c})),n.d(t,"curry",(function(){return f})),n.d(t,"curryRight",(function(){return h})),n.d(t,"fastCall",(function(){return d}));n("74b4"),n("b43b"),n("2a17"),n("edaf");var r=n("d1f5"),o=n("c61e");function i(e){return"function"===typeof e}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];var u=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);var f=t-(u-n);return c?(r.lastCallThrottled=!1,e.apply(this,l)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,e.apply(i,l),n=0,o=void 0}),f)),r}return i}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=a(e,t),o=n;function i(){o=n}function l(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return o?(o-=1,e.apply(this,n)):r.apply(this,n)}return l.clearHits=i,l}function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout((function(){t=e.apply(o,a)}),n),t}return o}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t[0],i=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(r["arrayReduce"])(i,(function(e,t){return t(e)}),o.apply(this,t))}}function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function f(e){var t=e.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i);return l=s.length>=t?e.apply(this,s):n(s),l}}return n([])}function h(e){var t=e.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i.reverse());return l=s.length>=t?e.apply(this,s):n(s),l}}return n([])}function d(e,t,n,r,i,a,l,s){return Object(o["isDefined"])(s)?e.call(t,n,r,i,a,l,s):Object(o["isDefined"])(l)?e.call(t,n,r,i,a,l):Object(o["isDefined"])(a)?e.call(t,n,r,i,a):Object(o["isDefined"])(i)?e.call(t,n,r,i):Object(o["isDefined"])(r)?e.call(t,n,r):Object(o["isDefined"])(n)?e.call(t,n):e.call(t)}},"38f3":function(e,t,n){"use strict";n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562");var r=n("5711");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var l=new WeakMap,s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,s=t.overrideFn,u=t.calculationType,c=t.scrollbarHeight;o(this,e),l.set(this,{viewportHeight:n,scrollOffset:r,totalRows:i,rowHeightFn:a,overrideFn:s,calculationType:u,horizontalScrollbarHeight:c}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return a(e,[{key:"calculate",value:function(){for(var t,n=0,o=!0,i=[],a=l.get(this),s=a.calculationType,u=a.overrideFn,c=a.rowHeightFn,f=a.scrollOffset,h=a.totalRows,d=a.viewportHeight,p=a.horizontalScrollbarHeight||0,y=0;y<h;y++)if(t=c(y),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=f&&s!==r["a"]&&(this.startRow=y),n>=f&&n+(s===r["a"]?t:0)<=f+d-p&&(null===this.startRow&&(this.startRow=y),this.endRow=y),i.push(n),n+=t,s!==r["a"]&&(this.endRow=y),n>=f+d-p){o=!1;break}if(this.endRow===h-1&&o){this.startRow=this.endRow;while(this.startRow>0){var v=i[this.endRow]+t-i[this.startRow-1];if((v<=d-p||s!==r["a"])&&(this.startRow-=1),v>=d-p)break}}s===r["b"]&&null!==this.startRow&&u&&u(this),this.startPosition=i[this.startRow],void 0===this.startPosition&&(this.startPosition=null),h<this.endRow&&(this.endRow=h-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();t["a"]=s},"3e74":function(e,t,n){"use strict";n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562");var r=n("5711");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var l=new WeakMap,s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,s=t.overrideFn,u=t.calculationType,c=t.stretchMode,f=t.stretchingItemWidthFn,h=void 0===f?function(e){return e}:f;o(this,e),l.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:i,columnWidthFn:a,overrideFn:s,calculationType:u,stretchingColumnWidthFn:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=c,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return a(e,[{key:"calculate",value:function(){for(var e,t=0,n=!0,o=[],i=l.get(this),a=i.calculationType,s=i.overrideFn,u=i.scrollOffset,c=i.totalColumns,f=i.viewportWidth,h=0;h<c;h++){e=this._getColumnWidth(h),t<=u&&a!==r["a"]&&(this.startColumn=h);var d=u>0?f+1:f;if(t>=u&&t+(a===r["a"]?e:0)<=u+d&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=h),this.endColumn=h),o.push(t),t+=e,a!==r["a"]&&(this.endColumn=h),t>=u+f){n=!1;break}}if(this.endColumn===c-1&&n){this.startColumn=this.endColumn;while(this.startColumn>0){var p=o[this.endColumn]+e-o[this.startColumn-1];if((p<=f||a!==r["a"])&&(this.startColumn-=1),p>f)break}}a===r["b"]&&null!==this.startColumn&&s&&s(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),c<this.endColumn&&(this.endColumn=c-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=l.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var a=this._getColumnWidth(i),s=n.stretchingColumnWidthFn(void 0,i);"number"===typeof s?t-=s:o+=a}var u=t-o;if("all"===this.stretch&&u>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var c=this._getColumnWidth(r-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=l.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var i=Math.round(t*this.stretchAllRatio),a=r.stretchingColumnWidthFn(i,e);this.stretchAllColumnsWidth[e]=void 0===a?i:isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){var t=l.get(this),n=t.totalColumns;return e===n-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=l.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();t["a"]=s},"509f":function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("179d"),o=Object(r["a"])("renderers"),i=o.register,a=o.getItem,l=o.hasItem,s=o.getNames;o.getValues;function u(e){if("function"===typeof e)return e;if(!l(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return a(e)}function c(e,t){"string"!==typeof e&&(t=e,e=t.RENDERER_TYPE),i(e,t)}},"54fd":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));n("3128"),n("83a9"),n("bebe"),n("c9cc"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("cffe"),o=n("d1f5");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function f(e){var t=p();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===i(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var v=function(e){u(n,e);var t=f(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a(this,n),t.call(this,e)}return s(n,[{key:"getTrimmedIndexes",value:function(){return Object(o["arrayReduce"])(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}]),n}(r["a"])},"55a6":function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return M})),n.d(t,"a",(function(){return A}));n("6b2f"),n("ba9f"),n("0a66"),n("267c"),n("3128"),n("83a9"),n("bebe"),n("c9cc"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562"),n("b43b"),n("841e"),n("2931");var r=n("c61e"),o=n("bb9b"),i=n("27c2"),a=n("d1f5"),l="hooksRefRegisterer",s={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;Object(a["arrayEach"])(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;Object(o["objectEach"])(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};Object(o["defineGetter"])(s,"MIXIN_NAME",l,{writable:!1,enumerable:!1});var u=s,c=n("8f61");function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(e,t){return g(e)||v(e,t)||p(e,t)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){if(e){if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function g(e){if(Array.isArray(e))return e}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function w(e){var t=S();return function(){var n,r=R(e);if(t){var o=R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===f(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return C(e)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var T="base",P=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),M="baseEditor",A=function(){function e(t){k(this,e),this.hot=t,this.instance=t,this.state=P.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return j(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=P.VIRGIN}},{key:"extend",value:function(){return function(e){b(n,e);var t=w(n);function n(){return k(this,n),t.apply(this,arguments)}return j(n)}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,o,i,a,l=this;if(t){var s=this.hot.getSelectedLast();n=Math.max(Math.min(s[0],s[2]),0),o=Math.max(Math.min(s[1],s[3]),0),i=Math.max(s[0],s[2]),a=Math.max(s[1],s[3])}else{var u=[this.row,this.col,null,null];n=u[0],o=u[1],i=u[2],a=u[3]}var c=this.hot.runHooks("modifyGetCellCoords",n,o);if(Array.isArray(c)){var f=h(c,2);n=f[0],o=f[1]}var d=this.hot.getShortcutManager(),p=d.getContext("editor"),y={runOnlyIf:function(){return Object(r["isDefined"])(l.hot.getSelected())},group:M};this.isInFullEditMode()&&p.addShortcuts([{keys:[["ArrowUp"]],callback:function(){l.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){l.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){l.hot.selection.transformStart(0,-1*l.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){l.hot.selection.transformStart(0,l.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(n,o,e,i,a,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===P.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=P.EDITING,this.isInFullEditMode()){var a="string"===typeof e?e:Object(r["stringify"])(this.originalValue);this.setValue(a)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,o=this;if(n){var a=this._closeCallback;this._closeCallback=function(e){a&&a(e),n(e),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),s=l.getContext("editor");if(s.removeShortcutsByGroup(M),s.removeShortcutsByGroup(i["b"]),this.state!==P.VIRGIN){if(this.state===P.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var u=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"===typeof u?String.prototype.trim.call(u||""):u]]:[[u]],this.state=P.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){o.state=P.FINISHED,o.discardEditor(e)})):(this.state=P.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=P.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){if(this.state===P.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=P.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=P.VIRGIN,this._fireCallbacks(!0);var t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===P.WAITING}},{key:"getEditedCellRect",value:function(){var e,t=this.getEditedCell();if(t){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,i=this.hot.rootWindow,a=Object(c["offset"])(t),l=Object(c["outerWidth"])(t),s=Object(c["offset"])(this.hot.rootElement),u=Object(c["outerWidth"])(this.hot.rootElement),f=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=f!==i?f.scrollTop:0,p=h!==i?h.scrollLeft:0,y=i.innerWidth-s.left-u,v=null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,g=v.wtTable,b=g.name,m=["master","inline_start"].includes(b)?d:0,w=["master","top","bottom"].includes(b)?p:0,O=a.top===s.top?0:1,C=a.top-s.top-O-m,S=0;S=this.hot.isRtl()?i.innerWidth-a.left-l-y-1+w:a.left-s.left-1-w,["top","top_inline_start_corner"].includes(b)&&(C+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(S+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var R=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),E=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),j=this.hot.rowIndexMapper.getRenderableIndexesLength(),T=j-this.hot.view._wt.getSetting("fixedRowsBottom");(R&&k<=0||k===T)&&(C+=1),E<=0&&(S+=1);var P=o.rowsRenderCalculator.startPosition,M=o.columnsRenderCalculator.startPosition,A=Math.abs(r.inlineStartOverlay.getScrollPosition()),I=r.topOverlay.getScrollPosition(),_=Object(c["getScrollbarWidth"])(this.hot.rootDocument),x=t.offsetTop+P-I,H=0;if(this.hot.isRtl()){var N=t.offsetLeft;H=N>=0?g.getWidth()-t.offsetLeft:Math.abs(N),H+=M-A-l}else H=t.offsetLeft+M-A;var D=Object(c["getComputedStyle"])(this.TD,this.hot.rootWindow),L=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",B=parseInt(D[L],10)>0?0:1,V=parseInt(D.borderTopWidth,10)>0?0:1,F=Object(c["outerWidth"])(t)+B,W=Object(c["outerHeight"])(t)+V,U=Object(c["hasVerticalScrollbar"])(f)?_:0,z=Object(c["hasHorizontalScrollbar"])(h)?_:0,G=this.hot.view.maximumVisibleElementWidth(H)-U+B,Y=Math.max(this.hot.view.maximumVisibleElementHeight(x)-z+V,23);return{top:C,start:S,height:W,maxHeight:Y,width:F,maxWidth:G}}}},{key:"getEditedCellsLayerClass",value:function(){var e=this.checkEditorSection();switch(e){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}],[{key:"EDITOR_TYPE",get:function(){return T}}]),e}();Object(o["mixin"])(A,u)},5711:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r=1,o=2},"5b54":function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("179d"),o=Object(r["a"])("validators"),i=o.register,a=o.getItem,l=o.hasItem,s=o.getNames;o.getValues;function u(e){if("function"===typeof e)return e;if(!l(e))throw Error('No registered validator found under "'.concat(e,'" name'));return a(e)}function c(e,t){"string"!==typeof e&&(t=e,e=t.VALIDATOR_TYPE),i(e,t)}},"75e0":function(e,t,n){"use strict";n("2e51")},"766e":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("8116"),n("a0c5"),n("bebe"),n("5d07"),n("d562");var r=n("349e"),o=n("8fc6"),i=new Map([["indexesSequence",{getListWithInsertedItems:r["a"],getListWithRemovedItems:r["b"]}],["physicallyIndexed",{getListWithInsertedItems:o["a"],getListWithRemovedItems:o["b"]}]]),a=function(e){if(!1===i.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return i.get(e)}},8034:function(e,t,n){"use strict";n.r(t),n.d(t,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return r})),n.d(t,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return o})),n.d(t,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return i})),n.d(t,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return a})),n.d(t,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return l})),n.d(t,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return s})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return u})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return c})),n.d(t,"CONTEXTMENU_ITEMS_UNDO",(function(){return f})),n.d(t,"CONTEXTMENU_ITEMS_REDO",(function(){return h})),n.d(t,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return d})),n.d(t,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return p})),n.d(t,"CONTEXTMENU_ITEMS_COPY",(function(){return y})),n.d(t,"CONTEXTMENU_ITEMS_CUT",(function(){return v})),n.d(t,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return g})),n.d(t,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return b})),n.d(t,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return m})),n.d(t,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return w})),n.d(t,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return O})),n.d(t,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return C})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return S})),n.d(t,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return R})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return k})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return E})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return j})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return T})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return P})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return M})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return A})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return I})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS",(function(){return _})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return x})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return H})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return N})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return D})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return L})),n.d(t,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return B})),n.d(t,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return V})),n.d(t,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return F})),n.d(t,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return W})),n.d(t,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return U})),n.d(t,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return z})),n.d(t,"FILTERS_NAMESPACE",(function(){return G})),n.d(t,"FILTERS_CONDITIONS_NAMESPACE",(function(){return Y})),n.d(t,"FILTERS_CONDITIONS_NONE",(function(){return X})),n.d(t,"FILTERS_CONDITIONS_EMPTY",(function(){return K})),n.d(t,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return $})),n.d(t,"FILTERS_CONDITIONS_EQUAL",(function(){return q})),n.d(t,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return Q})),n.d(t,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return J})),n.d(t,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return Z})),n.d(t,"FILTERS_CONDITIONS_CONTAINS",(function(){return ee})),n.d(t,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return te})),n.d(t,"FILTERS_CONDITIONS_BY_VALUE",(function(){return ne})),n.d(t,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return re})),n.d(t,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return oe})),n.d(t,"FILTERS_CONDITIONS_LESS_THAN",(function(){return ie})),n.d(t,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return ae})),n.d(t,"FILTERS_CONDITIONS_BETWEEN",(function(){return le})),n.d(t,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return se})),n.d(t,"FILTERS_CONDITIONS_AFTER",(function(){return ue})),n.d(t,"FILTERS_CONDITIONS_BEFORE",(function(){return ce})),n.d(t,"FILTERS_CONDITIONS_TODAY",(function(){return fe})),n.d(t,"FILTERS_CONDITIONS_TOMORROW",(function(){return he})),n.d(t,"FILTERS_CONDITIONS_YESTERDAY",(function(){return de})),n.d(t,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return pe})),n.d(t,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return ye})),n.d(t,"FILTERS_LABELS_CONJUNCTION",(function(){return ve})),n.d(t,"FILTERS_LABELS_DISJUNCTION",(function(){return ge})),n.d(t,"FILTERS_VALUES_BLANK_CELLS",(function(){return be})),n.d(t,"FILTERS_BUTTONS_SELECT_ALL",(function(){return me})),n.d(t,"FILTERS_BUTTONS_CLEAR",(function(){return we})),n.d(t,"FILTERS_BUTTONS_OK",(function(){return Oe})),n.d(t,"FILTERS_BUTTONS_CANCEL",(function(){return Ce})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Se})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return Re})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return ke}));var r="ContextMenu:items",o="".concat(r,".noItems"),i="".concat(r,".insertRowAbove"),a="".concat(r,".insertRowBelow"),l="".concat(r,".insertColumnOnTheLeft"),s="".concat(r,".insertColumnOnTheRight"),u="".concat(r,".removeRow"),c="".concat(r,".removeColumn"),f="".concat(r,".undo"),h="".concat(r,".redo"),d="".concat(r,".readOnly"),p="".concat(r,".clearColumn"),y="".concat(r,".copy"),v="".concat(r,".cut"),g="".concat(r,".freezeColumn"),b="".concat(r,".unfreezeColumn"),m="".concat(r,".mergeCells"),w="".concat(r,".unmergeCells"),O="".concat(r,".addComment"),C="".concat(r,".editComment"),S="".concat(r,".removeComment"),R="".concat(r,".readOnlyComment"),k="".concat(r,".align"),E="".concat(r,".align.left"),j="".concat(r,".align.center"),T="".concat(r,".align.right"),P="".concat(r,".align.justify"),M="".concat(r,".align.top"),A="".concat(r,".align.middle"),I="".concat(r,".align.bottom"),_="".concat(r,".borders"),x="".concat(r,".borders.top"),H="".concat(r,".borders.right"),N="".concat(r,".borders.bottom"),D="".concat(r,".borders.left"),L="".concat(r,".borders.remove"),B="".concat(r,".nestedHeaders.insertChildRow"),V="".concat(r,".nestedHeaders.detachFromParent"),F="".concat(r,".hideColumn"),W="".concat(r,".showColumn"),U="".concat(r,".hideRow"),z="".concat(r,".showRow"),G="Filters:",Y="".concat(G,"conditions"),X="".concat(Y,".none"),K="".concat(Y,".isEmpty"),$="".concat(Y,".isNotEmpty"),q="".concat(Y,".isEqualTo"),Q="".concat(Y,".isNotEqualTo"),J="".concat(Y,".beginsWith"),Z="".concat(Y,".endsWith"),ee="".concat(Y,".contains"),te="".concat(Y,".doesNotContain"),ne="".concat(Y,".byValue"),re="".concat(Y,".greaterThan"),oe="".concat(Y,".greaterThanOrEqualTo"),ie="".concat(Y,".lessThan"),ae="".concat(Y,".lessThanOrEqualTo"),le="".concat(Y,".isBetween"),se="".concat(Y,".isNotBetween"),ue="".concat(Y,".after"),ce="".concat(Y,".before"),fe="".concat(Y,".today"),he="".concat(Y,".tomorrow"),de="".concat(Y,".yesterday"),pe="".concat(G,"labels.filterByCondition"),ye="".concat(G,"labels.filterByValue"),ve="".concat(G,"labels.conjunction"),ge="".concat(G,"labels.disjunction"),be="".concat(G,"values.blankCells"),me="".concat(G,"buttons.selectAll"),we="".concat(G,"buttons.clear"),Oe="".concat(G,"buttons.ok"),Ce="".concat(G,"buttons.cancel"),Se="".concat(G,"buttons.placeholder.search"),Re="".concat(G,"buttons.placeholder.value"),ke="".concat(G,"buttons.placeholder.secondValue")},"844f":function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return f}));var r=n("179d"),o=n("914e"),i=n("509f"),a=n("5b54"),l=Object(r["a"])("cellTypes"),s=l.register,u=l.getItem,c=l.hasItem,f=l.getNames;l.getValues;function h(e){if(!c(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return u(e)}function d(e,t){"string"!==typeof e&&(t=e,e=t.CELL_TYPE);var n=t,r=n.editor,l=n.renderer,u=n.validator;r&&Object(o["e"])(e,r),l&&Object(i["d"])(e,l),u&&Object(a["d"])(e,u),s(e,t)}},"85c9":function(e,t,n){"use strict";n.r(t),n.d(t,"spreadsheetColumnLabel",(function(){return s})),n.d(t,"spreadsheetColumnIndex",(function(){return u})),n.d(t,"createSpreadsheetData",(function(){return c})),n.d(t,"createSpreadsheetObjectData",(function(){return f})),n.d(t,"createEmptySpreadsheetData",(function(){return h})),n.d(t,"cellMethodLookupFactory",(function(){return d})),n.d(t,"dataRowToChangesArray",(function(){return p})),n.d(t,"countFirstRowKeys",(function(){return y})),n.d(t,"isArrayOfArrays",(function(){return v})),n.d(t,"isArrayOfObjects",(function(){return g}));n("83a9"),n("bebe"),n("d3af"),n("0ee2"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("844f"),o=n("bb9b");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",l=a.length;function s(e){var t,n=e+1,r="";while(n>0)t=(n-1)%l,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/l,10);return r}function u(e){var t=0;if(e)for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(l,r)*(a.indexOf(e[n])+1);return t-=1,t}function c(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i=[];for(t=0;t<r;t++)i.push(s(t)+(e+1));o.push(i)}return o}function f(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i={};for(t=0;t<r;t++)i["prop".concat(t)]=s(t)+(e+1);o.push(i)}return o}function h(e,t){for(var n,r=[],o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function d(e,t){var n="undefined"===typeof t||t;return function(t,i){return function t(i){if(i){if(Object(o["hasOwnProperty"])(i,e)&&void 0!==i[e])return i[e];if(Object(o["hasOwnProperty"])(i,"type")&&i.type){if("string"!==typeof i.type)throw new Error('Cell "type" must be a string');var a=Object(r["a"])(i.type);if(Object(o["hasOwnProperty"])(a,e))return a[e];if(n)return}return t(Object.getPrototypeOf(i))}}("number"===typeof t?this.getCellMeta(t,i):t)}}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,o){r.push([n+t,o,e])})):Object.keys(e).forEach((function(o){r.push([n+t,o,e[o]])}))})),r}function y(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Object(o["isObject"])(e[0])&&(t=Object(o["deepObjectSize"])(e[0]))),t}function v(e){return!!(Array.isArray(e)&&e.length&&e.every((function(e){return Array.isArray(e)})))}function g(e){return!!(Array.isArray(e)&&e.length&&e.every((function(e){return"object"===i(e)&&!Array.isArray(e)&&null!==e})))}},"88eb":function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));n("212c"),n("3128"),n("83a9"),n("bebe"),n("c9cc"),n("7003"),n("7cd7"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562"),n("b43b"),n("0a66"),n("841e"),n("2931");var r=n("55a6"),o=n("3225"),i=n("304f"),a=n("8f61"),l=n("0da0"),s=n("c89a");n("74b4");function u(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(e,t,n){e.addEventListener(t,n,!1)},a=function(e,t,n){e.removeEventListener(t,n,!1)},l=function(i){var a,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=e.value+i:r.data=e.value+i,o.style.fontSize=f(e).fontSize,o.style.fontFamily=f(e).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>a?e.style.width=t.minWidth+"px":a>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=a+"px",l=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>l?e.style.height=t.minHeight+"px":t.maxHeight<l?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},s=function(){window.setTimeout(l,0)},u=function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(t.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(t.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var s=parseInt(n.maxWidth);isNaN(s)||(t.maxWidth=s)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))},c=function(n,r,o){e=n,u(r),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),o&&(i(e,"change",l),i(e,"cut",s),i(e,"paste",s),i(e,"drop",s),i(e,"keydown",s),i(e,"focus",l),i(e,"compositionstart",s),i(e,"compositionupdate",s),i(e,"compositionend",s)),l()};function f(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,n){c(e,t,n)},unObserve:function(){a(e,"change",l),a(e,"cut",s),a(e,"paste",s),a(e,"drop",s),a(e,"keydown",s),a(e,"focus",l),a(e,"compositionstart",s),a(e,"compositionupdate",s),a(e,"compositionend",s)},resize:l}}var c=n("c61e"),f=n("27c2");n("b503");function h(e,t){for(var n=Object(a["getCaretPosition"])(t),r=t.value.split("\n"),o=n,i=0,l=0;l<r.length;l++){var s=r[l];0!==l&&(i+=r[l-1].length+1);var u=i+s.length;if("home"===e?o=i:"end"===e&&(o=u),n<=u)break}Object(a["setCaretPosition"])(t,o)}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e,t){return m(e)||b(e,t)||v(e,t)||y()}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function m(e){if(Array.isArray(e))return e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(){return S="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=R(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},S.apply(this,arguments)}function R(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=A(e),null===e)break;return e}function k(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function j(e){var t=M();return function(){var n,r=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}function T(e,t){if(t&&("object"===d(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var I="ht_editor_visible",_="ht_editor_hidden",x="textEditor",H="text",N=function(e){k(n,e);var t=j(n);function n(e){var r;return w(this,n),r=t.call(this,e),r.eventManager=new o["a"](P(r)),r.autoResize=u(),r.TEXTAREA=void 0,r.textareaStyle=void 0,r.TEXTAREA_PARENT=void 0,r.textareaParentStyle=void 0,r.layerClass=void 0,r.createElements(),r.bindEvents(),r.hot.addHookOnce("afterDestroy",(function(){return r.destroy()})),r}return C(n,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement();var t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(t){return e.onAfterDocumentKeyDown(t)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(e,t,o,a,l,s){var u=this.state;if(S(A(n.prototype),"prepare",this).call(this,e,t,o,a,l,s),!s.readOnly){this.refreshDimensions(!0);var c=s.allowInvalid,f=s.fragmentSelection;c&&(this.TEXTAREA.value=""),u!==r["b"].FINISHED&&this.hideEditableElement();var h=!f;h&&!Object(i["isMobileBrowser"])()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===r["b"].VIRGIN&&(this.TEXTAREA.value="",S(A(n.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),Object(a["setCaretPosition"])(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Object(a["addClass"])(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Object(a["addClass"])(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(a["hasClass"])(this.TEXTAREA_PARENT,this.layerClass)&&Object(a["removeClass"])(this.TEXTAREA_PARENT,this.layerClass),Object(a["addClass"])(this.TEXTAREA_PARENT,_),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Object(i["isIE"])()||Object(i["isEdge"])())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(a["removeClass"])(this.TEXTAREA_PARENT,this.layerClass),Object(a["addClass"])(this.TEXTAREA_PARENT,_)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;Object(l["rangeEach"])(e.length-1,(function(n){var r=e[n];if(Object(a["hasClass"])(r,"handsontableEditor"))return t=!0,!1})),Object(a["hasClass"])(this.TEXTAREA_PARENT,_)&&Object(a["removeClass"])(this.TEXTAREA_PARENT,_),t?(this.layerClass=I,Object(a["addClass"])(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(a["addClass"])(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===r["b"].EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),n=t.top,o=t.start,i=t.width,l=t.maxWidth,s=t.height,u=t.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),this.showEditableElement();var c=Object(a["getComputedStyle"])(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var f=Object(a["getComputedStyle"])(this.TEXTAREA),h=parseInt(f.paddingLeft,10)+parseInt(f.paddingRight,10),d=parseInt(f.paddingTop,10)+parseInt(f.paddingBottom,10),p=i-h,y=s-d,v=l-h,g=u-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(p,v),minHeight:Math.min(y,g),maxWidth:v,maxHeight:g},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),Object(i["isIOS"])()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),n=t.getContext("editor"),r={runOnlyIf:function(){return Object(c["isDefined"])(e.hot.getSelected())},group:x},o=function(){e.hot.rootDocument.execCommand("insertText",!1,"\n")};n.addShortcuts([{keys:[["Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(t){return!e.hot.selection.isMultiple()&&!t.altKey},relativeToGroup:f["a"],position:"before"},{keys:[["Meta","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(){return!e.hot.selection.isMultiple()},relativeToGroup:f["a"],position:"before"},{keys:[["Alt","Enter"]],callback:function(){return o(),!1},relativeToGroup:f["a"],position:"before"},{keys:[["PageUp"]],callback:function(){e.hot.selection.transformStart(-e.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){e.hot.selection.transformStart(e.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(t,n){var r=p(n,1),o=r[0];h(o,e.TEXTAREA)}},{keys:[["End"]],callback:function(t,n){var r=p(n,1),o=r[0];h(o,e.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}}],r)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager(),t=e.getContext("editor");t.removeShortcutsByGroup(f["b"]),t.removeShortcutsByGroup(x),t.removeShortcutsByGroup(r["c"])}},{key:"onAfterDocumentKeyDown",value:function(e){var t=[s["KEY_CODES"].ARROW_UP,s["KEY_CODES"].ARROW_RIGHT,s["KEY_CODES"].ARROW_DOWN,s["KEY_CODES"].ARROW_LEFT];-1===t.indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return H}}]),n}(r["a"])},"8b2a":function(e,t,n){"use strict";n("267c"),n("986e"),n("212c"),n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562");var r=n("e901");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){s(e,t),t.set(e,n)}function s(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=d(e,t,"get");return f(e,n)}function f(e,t){return t.get?t.get.call(e):t.value}function h(e,t,n){var r=d(e,t,"set");return p(e,r,n),n}function d(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function p(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var y=new WeakMap,v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o(this,e),u(this,"highlight",null),u(this,"from",null),u(this,"to",null),l(this,y,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=r.clone(),h(this,y,i)}return a(e,[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=t&&o.row>=t&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=e.getOuterTopStartCorner(),i=e.getOuterBottomEndCorner(),a=Math.min(t.row,o.row),l=Math.min(t.col,o.col),s=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=this._createCellCoords(a,l),f=this._createCellCoords(s,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break;default:break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}},{key:"flipDirectionHorizontally",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return c(this,y)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return c(this,y)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return c(this,y)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return c(this,y)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return c(this,y)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return c(this,y)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return c(this,y)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return c(this,y)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||(e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner()))}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof r["a"]))return!1;if(t){var n=t.from,o=t.to;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return t.top===n.top&&r.push("top"),t.right===n.right&&r.push("right"),t.bottom===n.bottom&&r.push("bottom"),t.left===n.left&&r.push("left"),r}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++){var i=e(r,o);if(!1===i)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,c(this,y))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,t){return new r["a"](e,t,c(this,y))}}]),e}();t["a"]=v},"8d66":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));n("2931"),n("1b48"),n("7ae5"),n("8125"),n("b43b"),n("9dec"),n("1eaf"),n("212c");var r=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,i=/^\t/;function a(e){var t=[[""]];if(0===e.length)return t;var n,a=0,l=0;while(e.length>0){if(n===e.length)break;if(n=e.length,e.match(i))e=e.replace(i,""),a+=1,t[l][a]="";else if(e.match(r))e=e.replace(r,""),a=0,l+=1,t[l]=[""];else{var s="";if(e.startsWith('"')){var u=0,c=!0;while(c){var f=e.slice(0,1);'"'===f&&(u+=1),s+=f,e=e.slice(1),(0===e.length||e.match(/^[\t\r\n]/)&&u%2===0)&&(c=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var h=e.match(o);s=h?h[0]:"",e=e.slice(s.length)}t[l][a]=s}}return t}function l(e){var t,n,r,o,i,a="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(a+="\t"),i=e[t][r],"string"===typeof i?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:a+=null===i||void 0===i?"":i;t!==n-1&&(a+="\n")}return a}},"8f61":function(e,t,n){"use strict";n.r(t),n.d(t,"getParent",(function(){return y})),n.d(t,"getFrameElement",(function(){return v})),n.d(t,"getParentWindow",(function(){return g})),n.d(t,"hasAccessToParentWindow",(function(){return b})),n.d(t,"closest",(function(){return m})),n.d(t,"closestDown",(function(){return w})),n.d(t,"isChildOf",(function(){return O})),n.d(t,"index",(function(){return C})),n.d(t,"overlayContainsElement",(function(){return S})),n.d(t,"hasClass",(function(){return j})),n.d(t,"addClass",(function(){return T})),n.d(t,"removeClass",(function(){return P})),n.d(t,"removeTextNodes",(function(){return M})),n.d(t,"empty",(function(){return A})),n.d(t,"HTML_CHARACTERS",(function(){return _})),n.d(t,"fastInnerHTML",(function(){return x})),n.d(t,"fastInnerText",(function(){return H})),n.d(t,"isVisible",(function(){return N})),n.d(t,"offset",(function(){return D})),n.d(t,"getWindowScrollTop",(function(){return L})),n.d(t,"getWindowScrollLeft",(function(){return B})),n.d(t,"getScrollTop",(function(){return V})),n.d(t,"getScrollLeft",(function(){return F})),n.d(t,"getScrollableElement",(function(){return W})),n.d(t,"getTrimmingContainer",(function(){return U})),n.d(t,"getStyle",(function(){return z})),n.d(t,"matchesCSSRules",(function(){return G})),n.d(t,"getComputedStyle",(function(){return Y})),n.d(t,"outerWidth",(function(){return X})),n.d(t,"outerHeight",(function(){return K})),n.d(t,"innerHeight",(function(){return $})),n.d(t,"innerWidth",(function(){return q})),n.d(t,"addEvent",(function(){return Q})),n.d(t,"removeEvent",(function(){return J})),n.d(t,"getCaretPosition",(function(){return Z})),n.d(t,"getSelectionEndPosition",(function(){return ee})),n.d(t,"getSelectionText",(function(){return te})),n.d(t,"clearTextSelection",(function(){return ne})),n.d(t,"setCaretPosition",(function(){return re})),n.d(t,"getScrollbarWidth",(function(){return ie})),n.d(t,"hasVerticalScrollbar",(function(){return ae})),n.d(t,"hasHorizontalScrollbar",(function(){return le})),n.d(t,"setOverlayPosition",(function(){return se})),n.d(t,"getCssTransform",(function(){return ue})),n.d(t,"resetCssTransform",(function(){return ce})),n.d(t,"isInput",(function(){return fe})),n.d(t,"isOutsideInput",(function(){return he})),n.d(t,"selectElementIfAllowed",(function(){return de})),n.d(t,"isDetached",(function(){return pe}));n("83a9"),n("267c"),n("986e"),n("b43b"),n("212c"),n("129d"),n("bebe"),n("2931"),n("b503"),n("2cf3"),n("bfe9"),n("9dec"),n("ba9f"),n("7ae5"),n("2a17"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562"),n("841e"),n("0a66");var r,o,i,a=n("3022"),l=n("304f"),s=n("e0a9");function u(e){return d(e)||h(e)||f(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function h(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){if(Array.isArray(e))return p(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=e;while(null!==o){if(n===t){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function v(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function g(e){return v(e)&&e.parent}function b(e){return!!Object.getPrototypeOf(e.parent)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=e;while(null!==a&&void 0!==a&&a!==n){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;a=f&&s===i?f:a.parentNode}return null}function w(e,t,n){var r=[],o=e;while(o){if(o=m(o,t,n),!o||n&&!n.contains(o))break;r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode}var i=r.length;return i?r[i-1]:null}function O(e,t){var n=e.parentNode,r=[];"string"===typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);while(null!==n){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function C(e){var t=0,n=e;if(n.previousSibling)while(n=n.previousSibling)t+=1;return t}function S(e,t,n){var r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function R(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(Object(a["isClassListSupported"])()){var k=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};r=function(e,t){return void 0!==e.classList&&"string"===typeof t&&""!==t&&e.classList.contains(t)},o=function(e,t){var n=e.ownerDocument,r=t;if("string"===typeof r&&(r=r.split(" ")),r=R(r),r.length>0)if(k(n)){var o;(o=e.classList).add.apply(o,u(r))}else{var i=0;while(r[i])e.classList.add(r[i]),i+=1}},i=function(e,t){var n=e.ownerDocument,r=t;if("string"===typeof r&&(r=r.split(" ")),r=R(r),r.length>0)if(k(n)){var o;(o=e.classList).remove.apply(o,u(r))}else{var i=0;while(r[i])e.classList.remove(r[i]),i+=1}}}else{var E=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};r=function(e,t){return void 0!==e.className&&E(t).test(e.className)},o=function(e,t){var n=e.className,r=t;if("string"===typeof r&&(r=r.split(" ")),r=R(r),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!E(r[o]).test(n)&&(n+=" ".concat(r[o]));e.className=n},i=function(e,t){var n=0,r=e.className,o=t;"string"===typeof o&&(o=o.split(" ")),o=R(o);while(o[n])r=r.replace(E(o[n])," ").trim(),n+=1;e.className!==r&&(e.className=r)}}function j(e,t){return r(e,t)}function T(e,t){o(e,t)}function P(e,t){i(e,t)}function M(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,n=t.length-1;n>=0;n--)M(t[n])}function A(e){var t;while(t=e.lastChild)e.removeChild(t)}var I,_=/(<(.*)>|&(.*);)/;function x(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_.test(t)?e.innerHTML=n?Object(s["sanitize"])(t):t:H(e,t)}function H(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?a["isTextContentSupported"]?n.textContent=t:n.data=t:(A(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function N(e){var t=e.ownerDocument.documentElement,n=e;while(n!==t){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return N(n.host.impl);if(n.host)return N(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function D(e){var t,n,r,o,i=e.ownerDocument,l=i.defaultView,s=i.documentElement,u=e;if(Object(a["hasCaptionProblem"])()&&u.firstChild&&"CAPTION"===u.firstChild.nodeName)return o=u.getBoundingClientRect(),{top:o.top+(l.pageYOffset||s.scrollTop)-(s.clientTop||0),left:o.left+(l.pageXOffset||s.scrollLeft)-(s.clientLeft||0)};t=u.offsetLeft,n=u.offsetTop,r=u;while(u=u.offsetParent){if(u===i.body)break;t+=u.offsetLeft,n+=u.offsetTop,r=u}return r&&"fixed"===r.style.position&&(t+=l.pageXOffset||s.scrollLeft,n+=l.pageYOffset||s.scrollTop),{left:t,top:n}}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?L(t):e.scrollTop}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?B(t):e.scrollLeft}function W(e){var t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);var r=["auto","scroll"],o=Object(a["isGetComputedStyleSupported"])(),i=e.parentNode;while(i&&i.style&&t.body!==i){var l=i.style,s=l.overflow,u=l.overflowX,c=l.overflowY;if([s,u,c].includes("scroll"))return i;if(o){var f=n.getComputedStyle(i);if(s=f.overflow,u=f.overflowX,c=f.overflowY,r.includes(s)||r.includes(u)||r.includes(c))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(c)||r.includes(s)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(u)||r.includes(s)))return i;i=i.parentNode}return n}function U(e){var t=e.ownerDocument,n=t.defaultView,r=e.parentNode;while(r&&r.style&&t.body!==r){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=Y(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return r;r=r.parentNode}return n}function z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;var r=e.style[t];if(""!==r&&void 0!==r)return r;var o=Y(e,n);return""!==o[t]&&void 0!==o[t]?o[t]:void 0}}function G(e,t){var n=t.selectorText,r=!1;return t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?r=e.msMatchesSelector(n):e.matches&&(r=e.matches(n))),r}function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function X(e){return e.offsetWidth}function K(e){return Object(a["hasCaptionProblem"])()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function $(e){return e.clientHeight||e.innerHeight}function q(e){return e.clientWidth||e.innerWidth}function Q(e,t,n){e.addEventListener(t,n,!1)}function J(e,t,n){e.removeEventListener(t,n,!1)}function Z(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function ee(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange();return r.text.indexOf(n.text)+n.text.length}return 0}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function re(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}}function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var o=t.offsetWidth;return r===o&&(o=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-o}function ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===I&&(I=oe(e)),I}function ae(e){return e.offsetWidth!==e.clientWidth}function le(e){return e.offsetHeight!==e.clientHeight}function se(e,t,n){Object(l["isIE9"])()?(e.style.top=n,e.style.left=t):Object(l["isSafari"])()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function ue(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function ce(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function fe(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function he(e){return fe(e)&&!1===e.hasAttribute("data-hot-input")}function de(e){var t=e.ownerDocument.activeElement;he(t)||e.select()}function pe(e){return!e.parentNode}},"8fc6":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return h}));n("2a17"),n("b43b"),n("60ed"),n("267c"),n("986e"),n("2b96"),n("3d35"),n("bebe"),n("213d"),n("8116"),n("5d07"),n("d562"),n("841e"),n("0a66"),n("2931");var r=n("3731"),o=n("d1f5");function i(e){return u(e)||s(e)||l(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){if(e){if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function s(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e){if(Array.isArray(e))return c(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,o){var a=n.length?n[0]:void 0;return[].concat(i(e.slice(0,a)),i(n.map((function(e,t){return Object(r["isFunction"])(o)?o(e,t):o}))),i(void 0===a?[]:e.slice(a)))}function h(e,t){return Object(o["arrayFilter"])(e,(function(e,n){return!1===t.includes(n)}))}},"914e":function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c}));n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562");var r=n("0393"),o=n("179d"),i=new WeakMap,a=Object(o["a"])("editors"),l=a.register,s=a.getItem,u=a.hasItem,c=a.getNames;a.getValues;function f(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},r["a"].getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function h(e,t){var n;if("function"===typeof e)i.get(e)||p(null,e),n=i.get(e);else{if("string"!==typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=s(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function d(e){if(!u(e))throw Error('No registered editor found under "'.concat(e,'" name'));return s(e).getConstructor()}function p(e,t){e&&"string"!==typeof e&&(t=e,e=t.EDITOR_TYPE);var n=new f(t);"string"===typeof e&&l(e,n),i.set(t,n)}},"9f0c":function(e,t,n){var r={"./af":"f818","./af.js":"f818","./ar":"b5ba","./ar-dz":"9d08","./ar-dz.js":"9d08","./ar-kw":"fd3d","./ar-kw.js":"fd3d","./ar-ly":"0df6","./ar-ly.js":"0df6","./ar-ma":"f5f8","./ar-ma.js":"f5f8","./ar-sa":"86cd","./ar-sa.js":"86cd","./ar-tn":"5830","./ar-tn.js":"5830","./ar.js":"b5ba","./az":"9fdf","./az.js":"9fdf","./be":"4d36","./be.js":"4d36","./bg":"e883","./bg.js":"e883","./bm":"4298","./bm.js":"4298","./bn":"2b2e","./bn-bd":"b971","./bn-bd.js":"b971","./bn.js":"2b2e","./bo":"a8fe","./bo.js":"a8fe","./br":"ab02","./br.js":"ab02","./bs":"cac3","./bs.js":"cac3","./ca":"727c","./ca.js":"727c","./cs":"db15","./cs.js":"db15","./cv":"2866","./cv.js":"2866","./cy":"e2e0","./cy.js":"e2e0","./da":"d190","./da.js":"d190","./de":"5731","./de-at":"6776","./de-at.js":"6776","./de-ch":"6bd9","./de-ch.js":"6bd9","./de.js":"5731","./dv":"7827","./dv.js":"7827","./el":"3350","./el.js":"3350","./en-au":"e68e","./en-au.js":"e68e","./en-ca":"b4a9","./en-ca.js":"b4a9","./en-gb":"2e0f","./en-gb.js":"2e0f","./en-ie":"2007","./en-ie.js":"2007","./en-il":"30dc","./en-il.js":"30dc","./en-in":"5259","./en-in.js":"5259","./en-nz":"fa4c","./en-nz.js":"fa4c","./en-sg":"590d","./en-sg.js":"590d","./eo":"fb0d","./eo.js":"fb0d","./es":"bd0c","./es-do":"fe85","./es-do.js":"fe85","./es-mx":"3f53","./es-mx.js":"3f53","./es-us":"c1c2","./es-us.js":"c1c2","./es.js":"bd0c","./et":"8e51","./et.js":"8e51","./eu":"8047","./eu.js":"8047","./fa":"ace3","./fa.js":"ace3","./fi":"3512","./fi.js":"3512","./fil":"9519","./fil.js":"9519","./fo":"296d","./fo.js":"296d","./fr":"62ae","./fr-ca":"f520","./fr-ca.js":"f520","./fr-ch":"a9d9","./fr-ch.js":"a9d9","./fr.js":"62ae","./fy":"bb83","./fy.js":"bb83","./ga":"faac","./ga.js":"faac","./gd":"4f30","./gd.js":"4f30","./gl":"1f7c","./gl.js":"1f7c","./gom-deva":"835f","./gom-deva.js":"835f","./gom-latn":"daa2","./gom-latn.js":"daa2","./gu":"59f1","./gu.js":"59f1","./he":"b952","./he.js":"b952","./hi":"3630","./hi.js":"3630","./hr":"d705","./hr.js":"d705","./hu":"10c9","./hu.js":"10c9","./hy-am":"4b6a","./hy-am.js":"4b6a","./id":"74fa","./id.js":"74fa","./is":"c329","./is.js":"c329","./it":"ee47","./it-ch":"baae","./it-ch.js":"baae","./it.js":"ee47","./ja":"6b6c","./ja.js":"6b6c","./jv":"ce38","./jv.js":"ce38","./ka":"7ad5","./ka.js":"7ad5","./kk":"1868","./kk.js":"1868","./km":"af4b","./km.js":"af4b","./kn":"6933","./kn.js":"6933","./ko":"3b09","./ko.js":"3b09","./ku":"d7a2","./ku.js":"d7a2","./ky":"44da","./ky.js":"44da","./lb":"3aac","./lb.js":"3aac","./lo":"4d72","./lo.js":"4d72","./lt":"5337","./lt.js":"5337","./lv":"9a31","./lv.js":"9a31","./me":"c9ef","./me.js":"c9ef","./mi":"e590","./mi.js":"e590","./mk":"0492","./mk.js":"0492","./ml":"62fe","./ml.js":"62fe","./mn":"5f6e","./mn.js":"5f6e","./mr":"aa17","./mr.js":"aa17","./ms":"61d0","./ms-my":"8aef","./ms-my.js":"8aef","./ms.js":"61d0","./mt":"695b","./mt.js":"695b","./my":"e0ea","./my.js":"e0ea","./nb":"41e0","./nb.js":"41e0","./ne":"d02b","./ne.js":"d02b","./nl":"69b6","./nl-be":"0728","./nl-be.js":"0728","./nl.js":"69b6","./nn":"fc22","./nn.js":"fc22","./oc-lnc":"8d44","./oc-lnc.js":"8d44","./pa-in":"fa72","./pa-in.js":"fa72","./pl":"8021","./pl.js":"8021","./pt":"cf2a","./pt-br":"97ff","./pt-br.js":"97ff","./pt.js":"cf2a","./ro":"3b5b","./ro.js":"3b5b","./ru":"6883","./ru.js":"6883","./sd":"e8a1","./sd.js":"e8a1","./se":"7db1","./se.js":"7db1","./si":"1386","./si.js":"1386","./sk":"d645","./sk.js":"d645","./sl":"e61f","./sl.js":"e61f","./sq":"ee34","./sq.js":"ee34","./sr":"ea94","./sr-cyrl":"1ab0","./sr-cyrl.js":"1ab0","./sr.js":"ea94","./ss":"e78a","./ss.js":"e78a","./sv":"010c","./sv.js":"010c","./sw":"1450","./sw.js":"1450","./ta":"aa14","./ta.js":"aa14","./te":"beb6","./te.js":"beb6","./tet":"27da","./tet.js":"27da","./tg":"4bde","./tg.js":"4bde","./th":"2dd6","./th.js":"2dd6","./tk":"478a","./tk.js":"478a","./tl-ph":"a36c","./tl-ph.js":"a36c","./tlh":"86c9","./tlh.js":"86c9","./tr":"6755","./tr.js":"6755","./tzl":"5cfd","./tzl.js":"5cfd","./tzm":"4812","./tzm-latn":"6636","./tzm-latn.js":"6636","./tzm.js":"4812","./ug-cn":"ab75","./ug-cn.js":"ab75","./uk":"9f61","./uk.js":"9f61","./ur":"adf5","./ur.js":"adf5","./uz":"fb6d","./uz-latn":"9d50","./uz-latn.js":"9d50","./uz.js":"fb6d","./vi":"99a5","./vi.js":"99a5","./x-pseudo":"c3cf","./x-pseudo.js":"c3cf","./yo":"3ed5","./yo.js":"3ed5","./zh-cn":"eb15","./zh-cn.js":"eb15","./zh-hk":"b7e2","./zh-hk.js":"b7e2","./zh-mo":"b829","./zh-mo.js":"b829","./zh-tw":"1abb","./zh-tw.js":"1abb"};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id="9f0c"},b0e6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return s}));var r="active-header",o="area",i="cell",a="fill",l="header",s="custom-selection"},b44c:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return U}));var r=n("f65c"),o=n("216e");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function b(e){var t=y();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}var m=Symbol("unassigned"),w=null,O="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function C(e){e.hotInstance&&(e.hotInstance.addHook("beforeChange",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeCreateRow",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeCreateCol",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeRemoveRow",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeRemoveCol",(function(){e.__internalEdit=!0})))}function S(e){var t=r["a"].hooks.getRegistered(),n={};for(var o in Object.assign(n,r["a"].DefaultSettings),n)n[o]={default:m};for(var i=0;i<t.length;i++)n[t[i]]={default:m};return n.settings={default:m},"HotTable"===e&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function R(e){var t={},n=e["settings"];if(n!==m)for(var r in n)n.hasOwnProperty(r)&&n[r]!==m&&(t[r]=n[r]);for(var o in e)e.hasOwnProperty(o)&&"settings"!==o&&e[o]!==m&&(t[o]=e[o]);return t}function k(e,t){var n=R(e),r=e.settings?e.settings:n,o=e.settings?n:null,i={};for(var a in r)!r.hasOwnProperty(a)||void 0===r[a]||t&&"data"!==a&&P(t[a],r[a])||(i[a]=r[a]);for(var l in o)!o.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===o[l]||t&&"data"!==l&&P(t[l],o[l])||(i[l]=o[l]);return i}function E(e,t){var n=null;return e.every((function(e,r){return!e.data||!e.data.attrs||void 0===e.data.attrs[t]||(n=e,!1)})),n}function j(e){return e.filter((function(e){return"HotColumn"===e.$options.name}))}function T(e,t,n,r){var o=t.$el?t.$el.ownerDocument:document,i={propsData:n,parent:t,data:r};w||(w=o.createElement("DIV"),w.id="vueHotComponents",o.body.appendChild(w));var a=o.createElement("DIV");return w.appendChild(a),new e.componentOptions.Ctor(i).$mount(a)}function P(e,t){return JSON.stringify(e)===JSON.stringify(t)}var M="12.1.1";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e||"undefined"!==typeof self&&self;function A(e,t){return t={exports:{}},e(t,t.exports),t.exports}var I=A((function(e,t){(function(e,n){var r=t;n(r)})(0,(function(e){var t=Symbol("newer"),n=Symbol("older");function r(e,t){"number"!==typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}function o(e,r){this.key=e,this.value=r,this[t]=void 0,this[n]=void 0}e.LRUMap=r,r.prototype._markEntryAsUsed=function(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][n]=e[n]),e[n]&&(e[n][t]=e[t]),e[t]=void 0,e[n]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)},r.prototype.assign=function(e){var r,i=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var a=e[Symbol.iterator](),l=a.next();!l.done;l=a.next()){var s=new o(l.value[0],l.value[1]);if(this._keymap.set(s.key,s),r?(r[t]=s,s[n]=r):this.oldest=s,r=s,0==i--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value},r.prototype.set=function(e,r){var i=this._keymap.get(e);return i?(i.value=r,this._markEntryAsUsed(i),this):(this._keymap.set(e,i=new o(e,r)),this.newest?(this.newest[t]=i,i[n]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[n]=void 0,this._keymap["delete"](e.key),--this.size,[e.key,e.value]},r.prototype.has=function(e){return this._keymap.has(e)}}))})),_=I.LRUMap,x={name:"HotTable",props:S("HotTable"),watch:{mergedHotSettings:function(e){this.hotInstance&&void 0!==e&&(e.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete e.data),Object.keys(e).length?this.hotInstance.updateSettings(e):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var e=this,t=new _(this.wrapperRendererCacheSize);return t.shift=function(){var e=_.prototype.shift.call(this);return e[1].component.$destroy(),e},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:t,editorCache:new Map,get hotInstance(){return!e.__hotInstance||e.__hotInstance&&!e.__hotInstance.isDestroyed?e.__hotInstance:(console.warn(O),null)},set hotInstance(t){e.__hotInstance=t}}},computed:{mergedHotSettings:function(){return k(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var e=this.getGlobalRendererVNode(),t=this.getGlobalEditorVNode(),n=k(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,t&&(n.editor=this.getEditorClass(t,this),t.child.$destroy()),e&&(n.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new r["a"].Core(this.$el,n),this.hotInstance.init(),C(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,n=this.hotInstance.getSourceData(),r=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(n&&n.length!==i&&n.length<i)for(var s=n.length;s<i;s++)r.push(s);if(a)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(t=n[0])||void 0===t?void 0:t.length)!==l&&n[0].length<l)for(var u=n[0].length;u<l;u++)o.push(u);this.hotInstance.batch((function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(i-1,n.length-i),a&&0!==n.length&&(o.length>0?e.hotInstance.columnIndexMapper.removeIndexes(o):e.hotInstance.columnIndexMapper.insertIndexes(l-1,n[0].length-l))}))}},getGlobalRendererVNode:function(){var e=this.$slots["default"]||[];return E(e,"hot-renderer")},getGlobalEditorVNode:function(){var e=this.$slots["default"]||[];return E(e,"hot-editor")},getColumnSettings:function(){var e=j(this.$children),t=!1,n=e.map((function(e){return e.usesRendererComponent&&(t=!0),a({},e.columnSettings)}));return t&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(e,t){var n=this;return function(r,o,i,a,l,s,u){if(o&&!o.getAttribute("ghost-table")){var c=n.rendererCache,f={hotInstance:r,TD:o,row:i,col:a,prop:l,value:s,cellProperties:u,isRenderer:!0};if(c&&!c.has("".concat(i,"-").concat(a))){var h=T(e,t,e.componentOptions.propsData,f);c.set("".concat(i,"-").concat(a),{component:h,lastUsedTD:null})}var d=c.get("".concat(i,"-").concat(a)),p=d.component,y=d.lastUsedTD;if(Object.assign(p.$data,f),!p.$el.parentElement||y!==o){while(o.firstChild)o.removeChild(o.firstChild);o.appendChild(p.$el),d.lastUsedTD=o}}return o}},getEditorClass:function(e,t){var n=e.key?e.key.toString():null,r=e.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,i=this.editorCache,a=null;return i.has(o)?a=i.get(o):(a=T(e,t,e.componentOptions.propsData,{isEditor:!0}),i.set(o,a)),a.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:M};function H(e,t,n,r,o,i,a,l,s,u){"boolean"!==typeof a&&(s=l,l=a,a=!1);const c="function"===typeof n?n.options:n;let f;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),r&&(c._scopeId=r),i?(f=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=f):t&&(f=a?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),f)if(c.functional){const e=c.render;c.render=function(t,n){return f.call(n),e(t,n)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,f):[f]}return n}var N=x,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:e.id}},[e._t("default")],2)},L=[],B=void 0,V=void 0,F=void 0,W=!1,U=H({render:D,staticRenderFns:L},B,N,V,W,F,!1,void 0,void 0,void 0);S("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function z(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function G(e){return G="function"===typeof Symbol&&"symbol"===l(Symbol.iterator)?function(e){return l(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":l(e)},G(e)}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){return K(e)||$(e)||q()}function K(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function $(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function q(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Q(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function J(e,t){Z(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(n){Z(e.prototype,t.prototype,n)})),Object.getOwnPropertyNames(t).forEach((function(n){Z(e,t,n)}))}function Z(e,t,n){var r=n?Reflect.getOwnMetadataKeys(t,n):Reflect.getOwnMetadataKeys(t);r.forEach((function(r){var o=n?Reflect.getOwnMetadata(r,t,n):Reflect.getOwnMetadata(r,t);n?Reflect.defineMetadata(r,o,e,n):Reflect.defineMetadata(r,o,e)}))}var ee={__proto__:[]},te=ee instanceof Array;function ne(e){var t=G(e);return null==e||"object"!==t&&"function"!==t}function re(e,t){var n=t.prototype._init;t.prototype._init=function(){var t=this,n=Object.getOwnPropertyNames(e);if(e.$options.props)for(var r in e.$options.props)e.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t},configurable:!0})}))};var r=new t;t.prototype._init=n;var o={};return Object.keys(r).forEach((function(e){void 0!==r[e]&&(o[e]=r[e])})),o}var oe=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(e){if("constructor"!==e)if(oe.indexOf(e)>-1)t[e]=n[e];else{var r=Object.getOwnPropertyDescriptor(n,e);void 0!==r.value?"function"===typeof r.value?(t.methods||(t.methods={}))[e]=r.value:(t.mixins||(t.mixins=[])).push({data:function(){return Y({},e,r.value)}}):(r.get||r.set)&&((t.computed||(t.computed={}))[e]={get:r.get,set:r.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return re(this,e)}});var r=e.__decorators__;r&&(r.forEach((function(e){return e(t)})),delete e.__decorators__);var i=Object.getPrototypeOf(e.prototype),a=i instanceof o["a"]?i.constructor:o["a"],l=a.extend(t);return le(l,e,a),Q()&&J(l,e),l}var ae={prototype:!0,arguments:!0,callee:!0,caller:!0};function le(e,t,n){Object.getOwnPropertyNames(t).forEach((function(r){if(!ae[r]){var o=Object.getOwnPropertyDescriptor(e,r);if(!o||o.configurable){var i=Object.getOwnPropertyDescriptor(t,r);if(!te){if("cid"===r)return;var a=Object.getOwnPropertyDescriptor(n,r);if(!ne(i.value)&&a&&a.value===i.value)return}Object.defineProperty(e,r,i)}}}))}function se(e){return"function"===typeof e?ie(e):function(t){return ie(t,e)}}se.registerHooks=function(e){oe.push.apply(oe,X(e))};var ue=function(e){h(n,e);var t=b(n);function n(){var e;return s(this,n),e=t.apply(this,arguments),e.name="BaseEditorComponent",e.instance=null,e.row=null,e.col=null,e.prop=null,e.TD=null,e.originalValue=null,e.cellProperties=null,e.state=null,e.hot=null,e}return c(n,[{key:"mounted",value:function(){var e=this;this.$data.hotCustomEditorClass=function(){var t=function(t){h(r,t);var n=b(r);function r(t){var o;return s(this,r),o=n.call(this,t),e.$data.hotCustomEditorInstance=v(o),o}return c(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(r["a"].editors.BaseEditor);return Object.getOwnPropertyNames(r["a"].editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=e[n]).call.apply(t,[this].concat(o))})})),t}()}},{key:"_fireCallbacks",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(e=r["a"].editors.BaseEditor.prototype._fireCallbacks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.beginEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.cancelChanges).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.checkEditorSection).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.close).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.discardEditor).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.enableFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.extend).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.finishEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.focus).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.getValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.init).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.isInFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.isOpened).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.isWaiting).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.open).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(e,t,n,o,i,a){return this.$data.hotInstance=a.instance,this.$data.row=e,this.$data.col=t,this.$data.prop=n,this.$data.TD=o,this.$data.originalValue=i,this.$data.cellProperties=a,r["a"].editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,e,t,n,o,i,a)}},{key:"saveValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.saveValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.setValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.addHook).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.removeHooksByKey).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.clearHooks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.getEditedCell).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.getEditedCellRect).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r["a"].editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(o["a"]);ue=z([se({})],ue)}).call(this,n("a42b"))},b74a:function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return!1===e.isImmediatePropagationEnabled}function i(e){return 2===e.button}function a(e){return 0===e.button}n.r(t),n.d(t,"stopImmediatePropagation",(function(){return r})),n.d(t,"isImmediatePropagationStopped",(function(){return o})),n.d(t,"isRightClick",(function(){return i})),n.d(t,"isLeftClick",(function(){return a}))},b976:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n("b43b");var r=n("0da0"),o=n("bb9b"),i=n("3731"),a=n("362c");function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,e),this.indexedValues=[],this.initValueOrFn=t}return u(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(i["isFunction"])(this.initValueOrFn)?Object(r["rangeEach"])(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):Object(r["rangeEach"])(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();Object(o["mixin"])(c,a["a"])},bb9b:function(e,t,n){"use strict";n.r(t),n.d(t,"duckSchema",(function(){return a})),n.d(t,"inherit",(function(){return l})),n.d(t,"extend",(function(){return s})),n.d(t,"deepExtend",(function(){return u})),n.d(t,"deepClone",(function(){return c})),n.d(t,"clone",(function(){return f})),n.d(t,"mixin",(function(){return h})),n.d(t,"isObjectEqual",(function(){return d})),n.d(t,"isObject",(function(){return p})),n.d(t,"defineGetter",(function(){return y})),n.d(t,"objectEach",(function(){return v})),n.d(t,"getProperty",(function(){return g})),n.d(t,"setProperty",(function(){return b})),n.d(t,"deepObjectSize",(function(){return m})),n.d(t,"createObjectPropListener",(function(){return w})),n.d(t,"hasOwnProperty",(function(){return O}));n("267c"),n("986e"),n("bebe"),n("2931"),n("b503"),n("d3af"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("d1f5");function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e){var t;return Array.isArray(e)?t=[]:(t={},v(e,(function(e,n){"__children"!==n&&(e&&"object"===i(e)&&!Array.isArray(e)?t[n]=a(e):Array.isArray(e)?e.length&&"object"===i(e[0])&&!Array.isArray(e[0])?t[n]=[a(e[0])]:t[n]=[]:t[n]=null)}))),t}function l(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function s(e,t,n){var r=Array.isArray(n);return v(t,(function(t,o){(!1===r||n.includes(o))&&(e[o]=t)})),e}function u(e,t){v(t,(function(n,r){t[r]&&"object"===i(t[r])?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),u(e[r],t[r])):e[r]=t[r]}))}function c(e){return"object"===i(e)?JSON.parse(JSON.stringify(e)):e}function f(e){var t={};return v(e,(function(e,n){t[n]=e})),t}function h(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Object(r["arrayEach"])(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),v(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"===typeof t)e.prototype[n]=t;else{var r=function(e,t){var n="_".concat(e),r=function(e){var t=e;return(Array.isArray(t)||p(t))&&(t=c(t)),t};return function(){return void 0===this[n]&&(this[n]=r(t)),this[n]}},o=function(e){var t="_".concat(e);return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:o(n),configurable:!0})}}))})),e}function d(e,t){return JSON.stringify(e)===JSON.stringify(t)}function p(e){return"[object Object]"===Object.prototype.toString.call(e)}function y(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function v(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function g(e,t){var n=t.split("."),r=e;return v(n,(function(e){if(r=r[e],void 0===r)return r=void 0,!1})),r}function b(e,t,n){var r=t.split("."),o=e;r.forEach((function(e,t){t!==r.length-1?(O(o,e)||(o[e]={}),o=o[e]):o[e]=n}))}function m(e){if(!p(e))return 0;var t=function e(t){var n=0;return p(t)?v(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n};return t(e)}function w(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),i=(t={_touched:!1},o(t,r,e),o(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(i,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),i}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},c61e:function(e,t,n){"use strict";n.r(t),n.d(t,"stringify",(function(){return d})),n.d(t,"isDefined",(function(){return p})),n.d(t,"isUndefined",(function(){return y})),n.d(t,"isEmpty",(function(){return v})),n.d(t,"isRegExp",(function(){return g})),n.d(t,"_injectProductInfo",(function(){return P}));n("b43b"),n("6b2f"),n("bebe"),n("bfe9"),n("3647"),n("2931"),n("7ae5"),n("b503"),n("970e"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r,o,i,a,l,s,u=n("1f22"),c=n("e015");function f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e){var t;switch(h(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function p(e){return"undefined"!==typeof e}function y(e){return"undefined"===typeof e}function v(e){return null===e||""===e||y(e)}function g(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var b="length",m=function(e){return parseInt(e,16)},w=function(e){return parseInt(e,10)},O=function(e,t,n){return e["substr"](t,n)},C=function(e){return e["codePointAt"](0)-65},S=function(e){return"".concat(e).replace(/\-/g,"")},R=function(e){return m(O(S(e),m("12"),C("F")))/(m(O(S(e),C("B"),~~![][b]))||9)},k=function(){return"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},E=!1,j={invalid:function(){return Object(c["a"])(r||(r=f(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return Object(c["a"])(o||(o=f(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return Object(c["a"])(i||(i=f(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},T={invalid:function(){return Object(c["a"])(a||(a=f(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return Object(c["a"])(l||(l=f(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return Object(c["a"])(s||(s=f(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function P(e,t){var n,r=!v(e),o="string"===typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="12.1.1",a="invalid",l="invalid";e=S(e||"");var s=M(e);if(r||o||s)if(s){var c=u("05/07/2022","DD/MM/YYYY"),f=Math.floor(c.toDate().getTime()/864e5),h=R(e);if(n=u(864e5*(h+1),"x").format("MMMM DD, YYYY"),f>h){var d=u().diff(c,"days");a=d<=1?"valid":"expired",l=d<=15?"valid":"expired"}else a="valid",l="valid"}else o?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(k()&&(a="valid",l="valid"),!E&&"valid"!==a){var p=j[a]({keyValidityDate:n,hotVersion:i});p&&console["non_commercial"===a?"info":"warn"](j[a]({keyValidityDate:n,hotVersion:i})),E=!0}if("valid"!==l&&t.parentNode){var y=T[l]({keyValidityDate:n,hotVersion:i});if(y){var g=document.createElement("div");g.id="hot-display-license-info",g.innerHTML=T[l]({keyValidityDate:n,hotVersion:i}),t.parentNode.insertBefore(g,t.nextSibling)}}}function M(e){var t=[][b],n=t;if(e[b]!==C("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=C(o.shift());i;i=C(o.shift()||"A"))--i<""[b]?n|=(w("".concat(w(m(r)+(m(O(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=O(e,i,i?1===o[b]?9:8:6);return n===t}},c76a:function(e,t,n){"use strict";n.d(t,"a",(function(){return kh}));n("267c"),n("0b09"),n("9827"),n("4e92"),n("acdb"),n("b43b"),n("2a17"),n("1eaf"),n("60ed"),n("2931"),n("7ae5"),n("841e"),n("5d07"),n("212c"),n("edaf"),n("bebe"),n("d3af"),n("74b4"),n("5350"),n("8116"),n("a0c5"),n("d562"),n("2b96"),n("3d35"),n("213d"),n("0a66");var r=n("8f61"),o=n("3731"),i=n("c61e"),a=n("304f"),l=n("27c2"),s=n("3225"),u=n("bb9b"),c=n("d1f5"),f=n("0f99"),h=n("1af1"),d=n("509f"),p=n("5b54"),y=n("e0a9"),v=n("0da0"),g=(n("dd0b"),n("b74a")),b=(n("3128"),n("83a9"),n("c9cc"),n("3022"));function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var C=new WeakMap,S=function(){function e(t,n,r,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;m(this,e),this.wtSettings=r,this.domBindings=n,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,C.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return O(e,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",(function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout((function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},n=function(){e.eventManager.addEventListener(e.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)}))};Object(a["isMobileBrowser"])()?t():(Object(b["isTouchSupported"])()&&t(),n())}},{key:"selectedCellWasTouched",value:function(e){var t=C.get(this),n=this.parentCell(e),r=n.coords;if(t.selectedCellBeforeTouchEnd&&r){var o=[r.row,t.selectedCellBeforeTouchEnd.from.row],i=o[0],a=o[1],l=[r.col,t.selectedCellBeforeTouchEnd.from.col],s=l[0],u=l[1];return i===a&&s===u}return!1}},{key:"parentCell",value:function(e){var t={},n=this.wtTable.TABLE,o=Object(r["closestDown"])(e,["TD","TH"],n);return o?(t.coords=this.wtTable.getCoords(o),t.TD=o):Object(r["hasClass"])(e,"wtBorder")&&Object(r["hasClass"])(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Object(r["hasClass"])(e,"wtBorder")&&Object(r["hasClass"])(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=C.get(this),n=this.domBindings.rootDocument.activeElement,i=Object(o["partial"])(r["getParent"],e.target),a=e.target;if(a!==n&&i(0)!==n&&i(1)!==n){var l=this.parentCell(a);Object(r["hasClass"])(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,l.coords,l.TD),(0===e.button||this.touchApplied)&&l.TD&&(t.dblClickOrigin[0]=l.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var t=this.wtTable.TABLE,n=Object(r["closestDown"])(e.target,["TD","TH"],t),o=this.parent||this;n&&n!==o.lastMouseOver&&Object(r["isChildOf"])(n,t)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var t=this.wtTable.TABLE,n=Object(r["closestDown"])(e.target,["TD","TH"],t),o=Object(r["closestDown"])(e.relatedTarget,["TD","TH"],t);n&&n!==o&&Object(r["isChildOf"])(n,t)&&this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n)}}},{key:"onMouseUp",value:function(e){var t=C.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(Object(r["hasClass"])(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){var t=C.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,o=Object(i["isDefined"])(r)&&r.row>=0&&r.col>=0,l=e.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];Object(a["isIOS"])()&&(Object(a["isChromeWebKit"])()||Object(a["isFirefoxWebKit"])())&&this.selectedCellWasTouched(n)&&!s.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,t,n,r){var o=this.wtSettings.getSettingPure(e);o&&o(t,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var e=C.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}(),R=S,k=n("c89a");function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var P=function(){function e(t,n,r){E(this,e),this.offset=t,this.total=n,this.countTH=r}return T(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),M=P;function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var x=function(){function e(t,n,r){A(this,e),this.offset=t,this.total=n,this.countTH=r}return _(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),H=x,N=0,D=1,L=2;function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t&&V(e.prototype,t),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var W=function(){function e(){B(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return F(e,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),e}();function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t,n){return t&&z(e.prototype,t),n&&z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Y=function(){function e(){U(this,e),this.size=new W,this.workingSpace=N,this.sharedSize=null}return G(e,[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof W}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=D,e.workingSpace=L,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=L,e.workingSpace=D,this.sharedSize=e.getViewSize()}}]),e}();function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t,n){return t&&K(e.prototype,t),n&&K(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var q=function(){function e(t,n,r){X(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new Y,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return $(e,[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet()){var r=e.firstElementChild;while(r){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(D))break;r=r.nextElementSibling}}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize(),o=r.nextSize,i=this.getRenderedChildCount();while(i<o){var a=this.nodesPool();!n||n&&t.isPlaceOn(L)?e.appendChild(a):e.insertBefore(a,e.firstChild),i+=1}var l=n&&t.isPlaceOn(D);while(i>o)e.removeChild(l?e.firstChild:e.lastChild),i-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(L)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t,n){return t&&Z(e.prototype,t),n&&Z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function te(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ne(e,t)}function re(e){var t=ae();return function(){var n,r=le(e);if(t){var o=le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oe(this,n)}}function oe(e,t){if(t&&("object"===Q(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ie(e)}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}var se=function(e){te(n,e);var t=re(n);function n(){return J(this,n),t.apply(this,arguments)}return ee(n,[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}]),n}(q);function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t,n){return t&&ce(e.prototype,t),n&&ce(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var he=function(){function e(t){ue(this,e),this.nodeType=t.toUpperCase()}return fe(e,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t,n){return t&&pe(e.prototype,t),n&&pe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ve=function(){function e(t,n){de(this,e),this.nodesPool="string"===typeof t?new he(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}return ye(e,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t,n){return t&&me(e.prototype,t),n&&me(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oe(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}function Ce(e,t){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ce(e,t)}function Se(e){var t=Ee();return function(){var n,r=je(e);if(t){var o=je(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Re(this,n)}}function Re(e,t){if(t&&("object"===ge(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ke(e)}function ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function je(e){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},je(e)}var Te=function(e){Oe(n,e);var t=Se(n);function n(){var e;return be(this,n),e=t.call(this,"TH"),e.orderViews=new WeakMap,e.sourceRowIndex=0,e}return we(n,[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new se(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,i=e.cells,a=0;a<t;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](l,h,f)}u.end()}}}]),n}(ve);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e,t,n){return t&&Ae(e.prototype,t),n&&Ae(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _e(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xe(e,t)}function xe(e,t){return xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xe(e,t)}function He(e){var t=Le();return function(){var n,r=Be(e);if(t){var o=Be(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ne(this,n)}}function Ne(e,t){if(t&&("object"===Pe(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return De(e)}function De(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Le(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Be(e){return Be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Be(e)}var Ve=function(e){_e(n,e);var t=He(n);function n(e){return Me(this,n),t.call(this,null,e)}return Ie(n,[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,o=this.rootNode.firstChild;if(t){for(var i=this.table.columnsToRender,a=i+n,l=0,s=t;l<s;l++){o=this.rootNode.childNodes[l],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;while(this.renderedNodes<a)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>a)o.removeChild(o.lastChild),this.renderedNodes-=1}var u=this.rootNode.childNodes.length;if(u>t)for(var c=t;c<u;c++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&Object(r["empty"])(o)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[t],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),u=a.childNodes[l+i];u.className="",u.removeAttribute("style"),r[t](s,u,t)}}}]),n}(ve);function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t,n){return t&&Ue(e.prototype,t),n&&Ue(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ge(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ye(e,t)}function Ye(e,t){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ye(e,t)}function Xe(e){var t=qe();return function(){var n,r=Qe(e);if(t){var o=Qe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ke(this,n)}}function Ke(e,t){if(t&&("object"===Fe(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $e(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Qe(e){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qe(e)}var Je,Ze=function(e){Ge(n,e);var t=Xe(n);function n(e){return We(this,n),t.call(this,null,e)}return ze(n,[{key:"adjust",value:function(){var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=t+n;while(this.renderedNodes<r)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>r)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,o=0;o<n;o++){var i=this.table.renderedColumnToSource(o),a=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[o].style.width="".concat(a,"px")}for(var l=0;l<t;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[l+n].style.width="".concat(u,"px")}var c=this.rootNode.firstChild;c&&Object(r["addClass"])(c,"rowHeader")}}]),n}(ve),et=(n("6b2f"),n("0d2c")),tt=n("e015");function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function rt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function at(e,t,n){return t&&it(e.prototype,t),n&&it(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function lt(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&st(e,t)}function st(e,t){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},st(e,t)}function ut(e){var t=ht();return function(){var n,r=dt(e);if(t){var o=dt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct(this,n)}}function ct(e,t){if(t&&("object"===nt(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ft(e)}function ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}var pt=!1,yt=function(e){lt(n,e);var t=ut(n);function n(e){var r;return ot(this,n),r=t.call(this,"TR",e),r.orderView=new q(e,(function(e){return r.nodesPool.obtain(e)}),r.nodeType),r}return at(n,[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!pt&&e>1e3&&(pt=!0,Object(et["b"])(Object(tt["a"])(Je||(Je=rt(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}]),n}(ve);function vt(e){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(e)}function gt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mt(e,t,n){return t&&bt(e.prototype,t),n&&bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function wt(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ot(e,t)}function Ot(e,t){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ot(e,t)}function Ct(e){var t=kt();return function(){var n,r=Et(e);if(t){var o=Et(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return St(this,n)}}function St(e,t){if(t&&("object"===vt(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Rt(e)}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Et(e){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Et(e)}var jt=function(e){wt(n,e);var t=Ct(n);function n(){var e;return gt(this,n),e=t.call(this,"TD"),e.orderViews=new WeakMap,e.sourceRowIndex=0,e}return mt(n,[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new se(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,o=e.rows,i=e.rowHeaders,a=0;a<t;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.prependView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<n;f++){u.render();var h=u.getCurrentNode(),d=this.table.renderedColumnToSource(f);Object(r["hasClass"])(h,"hide")||(h.className=""),h.removeAttribute("style"),h.removeAttribute("dir"),this.table.cellRenderer(l,d,h)}u.end()}}}]),n}(ve);function Tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mt(e,t,n){return t&&Pt(e.prototype,t),n&&Pt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var At=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;Tt(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}return Mt(e,[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,i=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}]),e}();function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e,t,n){return t&&_t(e.prototype,t),n&&_t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ht=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;It(this,e),this.renderer=new At(n,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Te,columnHeaders:new Ve(r),colGroup:new Ze(o),rows:new yt(i),cells:new jt}),this.renderer.setAxisUtils(a,l)}return xt(e,[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function Nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lt(e,t,n){return t&&Dt(e.prototype,t),n&&Dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Bt=function(){function e(t,n){Nt(this,e),this.dataAccessObject=t,this.wtSettings=n,this.headerWidths=new Map}return Lt(e,[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(t){var r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,t=this.dataAccessObject,n=t.wtTable,o=t.wtViewport,i=t.cloneSource,a=i?i.wtTable.holder:n.holder,l=a.offsetHeight<a.scrollHeight?Object(r["getScrollbarWidth"])():0,s=e.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-l),s=e.getSetting("onModifyRowHeaderWidth",s),null!==s&&void 0!==s)for(var u=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth"),f=0;f<u;f++){var h=Array.isArray(s)?s[f]:s;h=null===h||void 0===h?c:h,this.headerWidths.set(f,h)}}}]),e}();function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wt(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ut=function(){function e(t,n){Vt(this,e),this.dataAccessObject=t,this.wtSettings=n}return Wt(e,[{key:"getHeight",value:function(e){var t=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}]),e}(),zt="top",Gt="bottom",Yt="inline_start",Xt="top_inline_start_corner",Kt="bottom_inline_start_corner",$t=[zt,Gt,Yt,Xt,Kt],qt=new Map([[zt,"ht_clone_".concat(zt)],[Gt,"ht_clone_".concat(Gt)],[Yt,"ht_clone_".concat(Yt," ht_clone_left")],[Xt,"ht_clone_".concat(Xt," ht_clone_top_left_corner")],[Kt,"ht_clone_".concat(Kt," ht_clone_bottom_left_corner")]]);function Qt(e){return en(e)||Zt(e)||rn(e)||Jt()}function Jt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zt(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function en(e){if(Array.isArray(e))return on(e)}function tn(e,t){return ln(e)||an(e,t)||rn(e,t)||nn()}function nn(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rn(e,t){if(e){if("string"===typeof e)return on(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?on(e,t):void 0}}function on(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function an(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function ln(e){if(Array.isArray(e))return e}function sn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(e,t,n){return t&&un(e.prototype,t),n&&un(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hn=function(){function e(t,n,o,i,a){var l=this;sn(this,e),fn(this,"wtSettings",null),fn(this,"domBindings",void 0),fn(this,"TBODY",null),fn(this,"THEAD",null),fn(this,"COLGROUP",null),fn(this,"hasTableHeight",!0),fn(this,"hasTableWidth",!0),fn(this,"isTableVisible",!1),fn(this,"tableOffset",0),fn(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===a,this.name=a,this.dataAccessObject=t,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,Object(r["removeTextNodes"])(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return l._modifyRowHeaderWidth(s)})),this.rowUtils=new Ut(this.dataAccessObject,this.wtSettings),this.columnUtils=new Bt(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Ht({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return cn(e,[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r["hasClass"])(n,"wtHolder")||(t=this.domBindings.rootDocument.createElement("div"),t.className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r["hasClass"])(n,"wtHolder")||(t=this.domBindings.rootDocument.createElement("div"),t.className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(r["hasClass"])(n,"wtHolder")||(t=this.domBindings.rootDocument.createElement("div"),t.style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtSettings,n=this.dataAccessObject,o=n.wtOverlays,i=n.wtViewport,a=t.getSetting("totalRows"),l=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),u=s.length,c=t.getSetting("columnHeaders"),f=c.length,h=!1,d=e;if(this.isMaster&&(this.holderOffset=Object(r["offset"])(this.holder),d=i.createRenderCalculators(d),u&&!t.getSetting("fixedColumnsStart"))){var p=o.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=0!==p,y!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=o.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Object(r["offset"])(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var v=a>0?this.getFirstRenderedRow():0,g=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new H(v,a,f),this.columnFilter=new M(g,l,u);var b,m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var w={};this.wtSettings.getSetting("beforeDraw",!0,w),m=!0!==w.skipRender}if(m)if(this.tableRenderer.setHeaderContentRenderers(s,c),(this.is(Gt)||this.is(Kt))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Gt))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var O=Object(r["outerWidth"])(this.hider),C=Object(r["outerWidth"])(this.TABLE);0!==O&&C!==O&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Gt)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}if(this.isMaster){var S=o.topOverlay.resetFixedPosition();o.bottomOverlay.clone&&(S=o.bottomOverlay.resetFixedPosition()||S),S=o.inlineStartOverlay.resetFixedPosition()||S,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition(),S&&(o.refreshAll(),o.adjustElementsSize())}return this.refreshSelections(d),h&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){var t,n,o,i=this.columnFilter.renderedToSource(e),a=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),s=this.wtSettings.getSetting("columnHeaderHeight")||[];while(a)a-=1,t=this.getColumnHeaderHeight(a),n=this.getColumnHeader(i,a),n&&(o=Object(r["innerHeight"])(n),(!t&&l<o||t<o)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=o),Array.isArray(s)?null!==s[a]&&void 0!==s[a]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s[a]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]<(s[a]||s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s[a]||s))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders"),o=0,i=r.length;o<i;o++)if(n[o]){if(!t[o]||0===t[o].childNodes.length)return;t[o].childNodes[0].style.height="".concat(n[o],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(Gt))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),n=0,o=t.length;n<o;n++)Object(r["removeClass"])(t[n],e)}},{key:"refreshSelections",value:function(e){var t=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(e){for(var i=[],a=0;a<o;a++){for(var l=r[a].settings,s=l.highlightHeaderClassName,u=l.highlightRowClassName,c=l.highlightColumnClassName,f=r[a].classNames,h=f.length,d=0;d<h;d++)i.includes(f[d])||i.push(f[d]);s&&!i.includes(s)&&i.push(s),u&&!i.includes(u)&&i.push(u),c&&!i.includes(c)&&i.push(c)}var p=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var y=0;y<p.length;y++)i.push(p[y]);for(var v=i.length,g=0;g<v;g++)this.removeClassFromCells(i[g])}for(var b=0;b<o;b++)r[b].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var t,n=e.row,r=e.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)){var i=tn(o,2);n=i[0],r=i[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;if(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)],!t&&n>=0)throw new Error("TR was expected to be rendered but is not");var a=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!a&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var r=e.childNodes[n];r&&t.push(r)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(t>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null===r||void 0===r?void 0:r.childNodes[t]}}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null===o||void 0===o?void 0:o.childNodes[r];i&&t.push(i)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Object(r["closest"])(t,["TD","TH"])),null===t)return null;var n=t.parentNode,o=n.parentNode,i=Object(r["index"])(n),a=t.cellIndex;if(Object(r["overlayContainsElement"])(Xt,t,this.wtRootElement)||Object(r["overlayContainsElement"])(zt,t,this.wtRootElement))"THEAD"===o.nodeName&&(i-=o.childNodes.length);else if(Object(r["overlayContainsElement"])(Kt,t,this.wtRootElement)||Object(r["overlayContainsElement"])(Gt,t,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");i=l-o.childNodes.length+i}else i=o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return a=Object(r["overlayContainsElement"])(Xt,t,this.wtRootElement)||Object(r["overlayContainsElement"])(Yt,t,this.wtRootElement)||Object(r["overlayContainsElement"])(Kt,t,this.wtRootElement)?this.columnFilter.offsettedTH(a):this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(i,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e,t,n,o,i,a=this.TBODY.childNodes.length,l=a*this.wtSettings.getSetting("defaultRowHeight"),s=Object(r["innerHeight"])(this.TBODY)-1;if(l!==s||this.wtSettings.getSetting("fixedRowsBottom"))while(a)a-=1,n=this.rowFilter.renderedToSource(a),e=this.getRowHeight(n),o=this.getTrForRow(n),i=o.querySelector("th"),t=i?Object(r["innerHeight"])(i):Object(r["innerHeight"])(o)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<t||e<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("rowHeaders"),n=t.length;return Math.abs(e)<=n}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("columnHeaders"),n=t.length;return Math.abs(e)<=n}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Object(r["outerWidth"])(this.TABLE)}},{key:"getHeight",value:function(){return Object(r["outerHeight"])(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=Object(r["outerWidth"])(this.hider);return 0!==e?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=Object(r["outerHeight"])(this.hider);return 0!==e?e:this.getHeight()}},{key:"isVisible",value:function(){return Object(r["isVisible"])(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=Object(o["isFunction"])(e)?e():null;return Array.isArray(t)?(t=Qt(t),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!==typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}]),e}(),dn=hn,pn="stickyRowsTop",yn={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows");return 0===e?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(u["defineGetter"])(yn,"MIXIN_NAME",pn,{writable:!1,enumerable:!1});var vn=yn,gn="calculatedColumns",bn={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Object(u["defineGetter"])(bn,"MIXIN_NAME",gn,{writable:!1,enumerable:!1});var mn=bn;function wn(e){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wn(e)}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cn(e,t,n){return t&&On(e.prototype,t),n&&On(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rn(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kn(e,t)}function kn(e,t){return kn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kn(e,t)}function En(e){var t=Pn();return function(){var n,r=Mn(e);if(t){var o=Mn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jn(this,n)}}function jn(e,t){if(t&&("object"===wn(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Tn(e)}function Tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Mn(e){return Mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mn(e)}var An=function(e){Rn(n,e);var t=En(n);function n(e,r,o,i){return Sn(this,n),t.call(this,e,r,o,i,zt)}return Cn(n)}(dn);Object(u["mixin"])(An,vn),Object(u["mixin"])(An,mn);var In=An;function _n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hn(e,t,n){return t&&xn(e.prototype,t),n&&xn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dn=function(){function e(t){_n(this,e),Nn(this,"dataAccessObject",void 0),Nn(this,"lastScrolledColumnPos",-1),Nn(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Hn(e,[{key:"scrollViewport",value:function(e,t,n,r,o){var i=this.scrollViewportHorizontally(e.col,n,o),a=this.scrollViewportVertically(e.row,t,r);return i||a}},{key:"scrollViewportHorizontally",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalColumns;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;var a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),s=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedColumnsStart,f=u.inlineStartOverlay;if(s&&e<c)return!1;var h=!1;return-1===a?h=f.scrollTo(e,s?e>this.lastScrolledColumnPos:t):(s&&(e<a||e>l)||!s)&&(h=f.scrollTo(e,s?e>l:t)),h&&(this.lastScrolledColumnPos=e),h}},{key:"scrollViewportVertically",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalRows;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;var a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),s=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedRowsBottom,f=u.fixedRowsTop,h=u.topOverlay;if(s&&(e<f||e>i-c-1))return!1;var d=!1;return-1===a?d=h.scrollTo(e,s?e>this.lastScrolledRowPos:n):(s&&(e<a||e>l)||!s)&&(d=h.scrollTo(e,s?e>l:n)),d&&(this.lastScrolledRowPos=e),d}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalRows,a=e.fixedRowsTop,l=e.rootWindow,s=n.getFirstVisibleRow();if(t.mainTableScrollableElement===l){var u=Object(r["offset"])(n.wtRootElement),c=Object(r["innerHeight"])(n.hider),f=Object(r["innerHeight"])(l),h=Object(r["getScrollTop"])(l,l);if(u.top+c-f<=h){var d=o.getColumnHeaderHeight();d+=t.sumCellSizes(0,a);for(var p=i;p>0;p--)if(d+=t.sumCellSizes(p-1,p),u.top+c-d<=h){s=p;break}}}return s}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalRows,a=e.rootWindow,l=n.getLastVisibleRow();if(t.mainTableScrollableElement===a){var s=Object(r["offset"])(n.wtRootElement),u=Object(r["getScrollTop"])(a,a);if(s.top>u)for(var c=Object(r["innerHeight"])(a),f=o.getColumnHeaderHeight(),h=1;h<=i;h++)if(f+=t.sumCellSizes(h-1,h),s.top+f-u>=c){l=h-2;break}}return l}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalColumns,a=e.rootWindow,l=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===a){var s=Object(r["offset"])(n.wtRootElement),u=Object(r["innerWidth"])(n.hider),c=Object(r["innerWidth"])(a),f=Math.abs(Object(r["getScrollLeft"])(a,a));if(s.left+u-c<=f)for(var h=o.getRowHeaderWidth(),d=i;d>0;d--)if(h+=t.sumCellSizes(d-1,d),s.left+u-h<=f){l=d;break}}return l}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalColumns,a=e.rootWindow,l=n.getLastVisibleColumn();if(t.mainTableScrollableElement===a){var s=Object(r["offset"])(n.wtRootElement),u=Math.abs(Object(r["getScrollLeft"])(a,a));if(s.left>u)for(var c=Object(r["innerWidth"])(a),f=o.getRowHeaderWidth(),h=1;h<=i;h++)if(f+=t.sumCellSizes(h-1,h),s.left+f-u>=c){l=h-2;break}}return l}}]),e}(),Ln=Dn,Bn=n("e901"),Vn=n("8b2a");function Fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Un(e,t,n){return t&&Wn(e.prototype,t),n&&Wn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function zn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gn=function(){function e(t,n){Fn(this,e),zn(this,"wtTable",void 0),zn(this,"wtScroll",void 0),zn(this,"wtViewport",void 0),zn(this,"wtOverlays",void 0),zn(this,"selections",void 0),zn(this,"wtEvent",void 0),zn(this,"guid","wt_".concat(Object(y["randomString"])())),zn(this,"drawInterrupted",!1),zn(this,"drawn",!1),zn(this,"domBindings",void 0),zn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Ln(this.createScrollDao())}return Un(e,[{key:"eventManager",get:function(){return new s["a"](this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Object(r["fastInnerText"])(n,e[t])}])}}},{key:"createCellCoords",value:function(e,t){return new Bn["a"](e,t,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,t,n){return new Vn["a"](e,t,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Yn(e){return Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yn(e)}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kn(e,t,n){return t&&Xn(e.prototype,t),n&&Xn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qn(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qn(e,t)}function Qn(e,t){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qn(e,t)}function Jn(e){var t=tr();return function(){var n,r=nr(e);if(t){var o=nr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zn(this,n)}}function Zn(e,t){if(t&&("object"===Yn(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return er(e)}function er(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function nr(e){return nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nr(e)}function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var or=function(e){qn(n,e);var t=Jn(n);function n(e,r,o){var i;$n(this,n),i=t.call(this,e,r),rr(er(i),"cloneSource",void 0),rr(er(i),"cloneOverlay",void 0);var a=i.wtSettings.getSetting("facade",er(i));return i.cloneSource=o.source,i.cloneOverlay=o.overlay,i.wtTable=i.cloneOverlay.createTable(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=o.viewport,i.selections=o.selections,i.wtEvent=new R(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections,o.event),i.findOriginalHeaders(),i}return Kn(n)}(Gn);function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lr(e,t,n){return t&&ar(e.prototype,t),n&&ar(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ur=function(){function e(t,n,o,i,a){ir(this,e),sr(this,"wtSettings",null),Object(u["defineGetter"])(this,"wot",t,{writable:!1}),this.domBindings=a,this.facadeGetter=n,this.wtSettings=i;var l=this.wot.wtTable,s=l.TABLE,c=l.hider,f=l.spreader,h=l.holder,d=l.wtRootElement;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=c,this.spreader=f,this.holder=h,this.wtRootElement=d,this.trimmingContainer=Object(r["getTrimmingContainer"])(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return lr(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(r["getTrimmingContainer"])(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable,t=this.domBindings.rootWindow;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(r["getScrollableElement"])(e.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,n){if(!1!==this.clone.wtTable.holder.contains(e)){var r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),i=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop},c=null;return c=r?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s),c}Object(et["b"])("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,o){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,l=0;if(t){var s=i.left;this.isRtl()&&(s=this.domBindings.rootWindow.innerWidth-(i.left+i.width+Object(r["getScrollbarWidth"])())),a=s<=0?-1*s:0}else a=o.start;if(e){var u=this.clone.wtTable.TABLE.getBoundingClientRect();l=u.top-i.top}else l=o.top;return{start:n.start+a,top:n.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(n||(a=i.horizontal-o.start),t){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),u=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*u.top+s.top}else e||(l=i.vertical-o.top);return{start:r.start-a,top:r.top-l}}},{key:"makeClone",value:function(){if(-1===$t.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,o=t.rootWindow,i=n.createElement("DIV"),a=n.createElement("TABLE"),l=e.wtRootElement.parentNode;i.className="".concat(qt.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,a.className=e.TABLE.className,i.appendChild(a),l.appendChild(i);var s=this.wtSettings.getSetting("preventOverflow");return!0===s||"horizontal"===s&&this.type===zt||"vertical"===s&&this.type===Yt?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Object(r["getScrollableElement"])(e.TABLE),new or(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,o=e.parentNode.style;Object(c["arrayEach"])([n,r,o],(function(e){e.width="",e.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function fr(e,t,n){return fr=wr()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&vr(i,n.prototype),i},fr.apply(null,arguments)}function hr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pr(e,t,n){return t&&dr(e.prototype,t),n&&dr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vr(e,t)}function vr(e,t){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vr(e,t)}function gr(e){var t=wr();return function(){var n,r=Or(e);if(t){var o=Or(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return br(this,n)}}function br(e,t){if(t&&("object"===cr(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return mr(e)}function mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Or(e){return Or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Or(e)}function Cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Sr=function(e){yr(n,e);var t=gr(n);function n(e,r,o,i){var a;return hr(this,n),a=t.call(this,e,r,zt,o,i),Cr(mr(a),"cachedFixedRowsTop",-1),a.cachedFixedRowsTop=a.wtSettings.getSetting("fixedRowsTop"),a}return pr(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return fr(In,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),o=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)o=this.getScrollPosition(),Object(r["resetCssTransform"])(e);else{var a=this.wot.wtTable,l=a.hider.getBoundingClientRect(),s=Math.ceil(l.bottom),u=e.offsetHeight;i=s===u,o=this.getOverlayOffset(),Object(r["setOverlayPosition"])(e,"0px","".concat(o,"px"))}var c=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),c}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Object(r["getWindowScrollLeft"])(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){var n=this.wtSettings.getSetting("defaultRowHeight"),r=e,o=0;while(r<t){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,o=t.rootWindow,i=Object(r["getScrollbarWidth"])(n),a=this.clone.wtTable.holder.parentNode,l=a.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===s){var u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),l.width="".concat(u,"px")}else l.width="";this.clone.wtTable.holder.style.width=l.width;var c=Object(r["outerHeight"])(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),l.height="".concat(c,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,o=this.wtSettings,i=n.cloneSource?n.cloneSource:n,a=i.wtTable.holder,l=this.getTableParentOffset(),s=0;if(t){var u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(s=Object(r["getScrollbarWidth"])(this.domBindings.rootDocument)),t){var f=o.getSetting("fixedRowsBottom"),h=o.getSetting("totalRows");l+=this.sumCellSizes(0,e+1),l-=n.wtViewport.getViewportHeight()-this.sumCellSizes(h-f,h),l+=1}else l+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return l+=s,this.setScrollPosition(l)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r["getScrollTop"])(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("totalColumns");o?Object(r["removeClass"])(n,"emptyColumns"):Object(r["addClass"])(n,"emptyColumns");var i=!1;if(!t){var a=this.wtSettings.getSetting("fixedRowsTop"),l=this.cachedFixedRowsTop!==a,s=this.wtSettings.getSetting("columnHeaders");if((l||0===a)&&s.length>0){var u=Object(r["hasClass"])(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?(Object(r["addClass"])(n,"innerBorderTop"),i=!u):(Object(r["removeClass"])(n,"innerBorderTop"),i=u)}}return i}}]),n}(ur),Rr="stickyRowsBottom",kr={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(u["defineGetter"])(kr,"MIXIN_NAME",Rr,{writable:!1,enumerable:!1});var Er=kr;function jr(e){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jr(e)}function Tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pr(e,t,n){return t&&Tr(e.prototype,t),n&&Tr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ar(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ir(e,t)}function Ir(e,t){return Ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ir(e,t)}function _r(e){var t=Nr();return function(){var n,r=Dr(e);if(t){var o=Dr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xr(this,n)}}function xr(e,t){if(t&&("object"===jr(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Hr(e)}function Hr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Dr(e){return Dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dr(e)}var Lr=function(e){Ar(n,e);var t=_r(n);function n(e,r,o,i){return Mr(this,n),t.call(this,e,r,o,i,Gt)}return Pr(n)}(dn);Object(u["mixin"])(Lr,Er),Object(u["mixin"])(Lr,mn);var Br=Lr;function Vr(e){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vr(e)}function Fr(e,t,n){return Fr=qr()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&Yr(i,n.prototype),i},Fr.apply(null,arguments)}function Wr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zr(e,t,n){return t&&Ur(e.prototype,t),n&&Ur(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yr(e,t)}function Yr(e,t){return Yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yr(e,t)}function Xr(e){var t=qr();return function(){var n,r=Qr(e);if(t){var o=Qr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kr(this,n)}}function Kr(e,t){if(t&&("object"===Vr(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $r(e)}function $r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Qr(e){return Qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qr(e)}function Jr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zr=function(e){Gr(n,e);var t=Xr(n);function n(e,r,o,i){var a;return Wr(this,n),a=t.call(this,e,r,Gt,o,i),Jr($r(a),"cachedFixedRowsBottom",-1),a.cachedFixedRowsBottom=a.wtSettings.getSetting("fixedRowsBottom"),a}return zr(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Fr(Br,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings.rootWindow,t=this.clone.wtTable.holder.parentNode;t.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,a=0;n.hasVerticalScroll()||(a+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(a+=Object(r["getScrollbarWidth"])(o)),i.style.bottom="".concat(a,"px")}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Object(r["getWindowScrollLeft"])(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){var n=this.wot,r=n.wtTable,o=n.wtSettings,i=o.getSetting("defaultRowHeight"),a=e,l=0;while(a<t){var s=r.getRowHeight(a);l+=void 0===s?i:s,a+=1}return l}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=this.domBindings,i=o.rootDocument,a=o.rootWindow,l=Object(r["getScrollbarWidth"])(i),s=this.clone.wtTable.holder.parentNode,u=s.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||"horizontal"===c){var f=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(f-=l),f=Math.min(f,t.wtRootElement.scrollWidth),u.width="".concat(f,"px")}else u.width="";this.clone.wtTable.holder.style.width=u.width;var h=Object(r["outerHeight"])(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),u.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=o.wtTable.holder,a=0;t&&i.offsetHeight!==i.clientHeight&&(a=Object(r["getScrollbarWidth"])(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=a,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(r["getScrollTop"])(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders"),i=!1;if((n||0===t)&&o.length>0){var a=this.wot.wtTable.holder.parentNode,l=Object(r["hasClass"])(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Object(r["addClass"])(a,"innerBorderBottom"),i=!l):(Object(r["removeClass"])(a,"innerBorderBottom"),i=l)}return i}}]),n}(ur),eo="calculatedRows",to={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Object(u["defineGetter"])(to,"MIXIN_NAME",eo,{writable:!1,enumerable:!1});var no=to,ro="stickyColumnsStart",oo={getFirstRenderedColumn:function(){var e=this.wtSettings.getSetting("totalColumns");return 0===e?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Object(u["defineGetter"])(oo,"MIXIN_NAME",ro,{writable:!1,enumerable:!1});var io=oo;function ao(e){return ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ao(e)}function lo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function so(e,t,n){return t&&lo(e.prototype,t),n&&lo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function uo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function co(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fo(e,t)}function fo(e,t){return fo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fo(e,t)}function ho(e){var t=vo();return function(){var n,r=go(e);if(t){var o=go(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return po(this,n)}}function po(e,t){if(t&&("object"===ao(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return yo(e)}function yo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},go(e)}var bo=function(e){co(n,e);var t=ho(n);function n(e,r,o,i){return uo(this,n),t.call(this,e,r,o,i,Yt)}return so(n)}(dn);Object(u["mixin"])(bo,no),Object(u["mixin"])(bo,io);var mo=bo;function wo(e){return wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wo(e)}function Oo(e,t,n){return Oo=Mo()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&Eo(i,n.prototype),i},Oo.apply(null,arguments)}function Co(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function So(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ro(e,t,n){return t&&So(e.prototype,t),n&&So(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ko(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Eo(e,t)}function Eo(e,t){return Eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Eo(e,t)}function jo(e){var t=Mo();return function(){var n,r=Ao(e);if(t){var o=Ao(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return To(this,n)}}function To(e,t){if(t&&("object"===wo(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Po(e)}function Po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ao(e)}var Io=function(e){ko(n,e);var t=jo(n);function n(e,r,o,i){return Co(this,n),t.call(this,e,r,Yt,o,i)}return Ro(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Oo(mo,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(!this.needFullRender||!e.holder.parentNode)return!1;var t=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow"),i=0;this.trimmingContainer!==t||o&&"horizontal"===o?(i=this.getScrollPosition(),Object(r["resetCssTransform"])(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Object(r["setOverlayPosition"])(n,"".concat(i,"px"),"0px"));var a=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),a}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Object(r["getWindowScrollTop"])(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){var n=this.wtSettings.getSetting("defaultColumnWidth"),r=e,o=0;while(r<t)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,o=t.rootWindow,i=Object(r["getScrollbarWidth"])(n),a=this.clone.wtTable.holder.parentNode,l=a.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===s){var u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),l.height="".concat(u,"px")}else l.height="";this.clone.wtTable.holder.style.height=l.height;var c=Object(r["outerWidth"])(this.clone.wtTable.TABLE);l.width="".concat(c,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=o.wtTable.holder,a=0;if(t){var l=this.wot.wtTable.getColumnWidth(e),s=this.wot.wtViewport.getViewportWidth();l>s&&(t=!1)}return t&&i.offsetWidth!==i.clientWidth&&(a=Object(r["getScrollbarWidth"])(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=a,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=this.wtSettings.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Math.abs(Object(r["getScrollLeft"])(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),i=r-o;n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart"),i=this.wtSettings.getSetting("totalRows");i?Object(r["removeClass"])(t,"emptyRows"):Object(r["addClass"])(t,"emptyRows");var a=!1;if(o&&!n.length)Object(r["addClass"])(t,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){var l=Object(r["hasClass"])(t,"innerBorderInlineStart");e?(Object(r["addClass"])(t,"innerBorderLeft innerBorderInlineStart"),a=!l):(Object(r["removeClass"])(t,"innerBorderLeft innerBorderInlineStart"),a=l)}return a}}]),n}(ur);function _o(e){return _o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_o(e)}function xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ho(e,t,n){return t&&xo(e.prototype,t),n&&xo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function No(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Do(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lo(e,t)}function Lo(e,t){return Lo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Lo(e,t)}function Bo(e){var t=Wo();return function(){var n,r=Uo(e);if(t){var o=Uo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vo(this,n)}}function Vo(e,t){if(t&&("object"===_o(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fo(e)}function Fo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Uo(e){return Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Uo(e)}var zo=function(e){Do(n,e);var t=Bo(n);function n(e,r,o,i){return No(this,n),t.call(this,e,r,o,i,Xt)}return Ho(n)}(dn);Object(u["mixin"])(zo,vn),Object(u["mixin"])(zo,io);var Go=zo;function Yo(e){return Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yo(e)}function Xo(e,t,n){return Xo=ni()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&Jo(i,n.prototype),i},Xo.apply(null,arguments)}function Ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qo(e,t,n){return t&&$o(e.prototype,t),n&&$o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qo(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jo(e,t)}function Jo(e,t){return Jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jo(e,t)}function Zo(e){var t=ni();return function(){var n,r=ri(e);if(t){var o=ri(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ei(this,n)}}function ei(e,t){if(t&&("object"===Yo(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ti(e)}function ti(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ni(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ri(e){return ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ri(e)}function oi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ii=function(e){Qo(n,e);var t=Zo(n);function n(e,r,o,i,a,l){var s;return Ko(this,n),s=t.call(this,e,r,Xt,o,i),oi(ti(s),"topOverlay",void 0),oi(ti(s),"inlineStartOverlay",void 0),s.topOverlay=a,s.inlineStartOverlay=l,s}return qo(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Xo(Go,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();Object(r["setOverlayPosition"])(e,"".concat(t,"px"),"".concat(n,"px"))}else Object(r["resetCssTransform"])(e);var o=Object(r["outerHeight"])(this.clone.wtTable.TABLE),i=Object(r["outerWidth"])(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height="".concat(o,"px"),e.style.width="".concat(i,"px"),!1}}]),n}(ur);function ai(e){return ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ai(e)}function li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function si(e,t,n){return t&&li(e.prototype,t),n&&li(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ui(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ci(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fi(e,t)}function fi(e,t){return fi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fi(e,t)}function hi(e){var t=yi();return function(){var n,r=vi(e);if(t){var o=vi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return di(this,n)}}function di(e,t){if(t&&("object"===ai(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pi(e)}function pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vi(e)}var gi=function(e){ci(n,e);var t=hi(n);function n(e,r,o,i){return ui(this,n),t.call(this,e,r,o,i,Kt)}return si(n)}(dn);Object(u["mixin"])(gi,Er),Object(u["mixin"])(gi,io);var bi=gi;function mi(e){return mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mi(e)}function wi(e,t,n){return wi=Pi()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&ki(i,n.prototype),i},wi.apply(null,arguments)}function Oi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ci(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Si(e,t,n){return t&&Ci(e.prototype,t),n&&Ci(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ri(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ki(e,t)}function ki(e,t){return ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ki(e,t)}function Ei(e){var t=Pi();return function(){var n,r=Mi(e);if(t){var o=Mi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ji(this,n)}}function ji(e,t){if(t&&("object"===mi(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ti(e)}function Ti(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Mi(e){return Mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mi(e)}var Ai=function(e){Ri(n,e);var t=Ei(n);function n(e,r,o,i,a,l){var s;return Oi(this,n),s=t.call(this,e,r,Kt,o,i),s.bottomOverlay=a,s.inlineStartOverlay=l,s}return Si(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wi(bi,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(n,"px"),t.style.bottom="".concat(o,"px")}else Object(r["resetCssTransform"])(t),this.repositionOverlay();var i=Object(r["outerHeight"])(this.clone.wtTable.TABLE),a=Object(r["outerWidth"])(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height="".concat(i,"px"),t.style.width="".concat(a,"px"),!1}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,a=0;n.hasVerticalScroll()||(a+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(a+=Object(r["getScrollbarWidth"])(o)),i.style.bottom="".concat(a,"px")}}]),n}(ur);function Ii(e,t,n){return Ii=_i()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&xi(i,n.prototype),i},Ii.apply(null,arguments)}function _i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function xi(e,t){return xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xi(e,t)}function Hi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Di(e,t,n){return t&&Ni(e.prototype,t),n&&Ni(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bi=function(){function e(t,n,o,i,a,l){Hi(this,e),Li(this,"wot",null),Li(this,"topOverlay",null),Li(this,"bottomOverlay",null),Li(this,"inlineStartOverlay",null),Li(this,"topInlineStartCornerOverlay",null),Li(this,"bottomInlineStartCornerOverlay",null),Li(this,"browserLineHeight",void 0),Li(this,"wtSettings",null),this.wot=t,this.wtSettings=i,this.domBindings=o,this.facadeGetter=n,this.wtTable=l;var s=this.domBindings,u=s.rootDocument,c=s.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=Object(r["getScrollbarWidth"])(u);var f="hidden"===c.getComputedStyle(l.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=f?l.holder:Object(r["getScrollableElement"])(l.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return Di(e,[{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,t=e.rootWindow,n=e.rootDocument,r=t.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),i=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||i}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Ii(Sr,e),this.bottomOverlay=Ii(Zr,e),this.inlineStartOverlay=Ii(Io,e),this.topInlineStartCornerOverlay=Ii(ii,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Ii(Ai,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var l=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,u=this.wtSettings.getSetting("preventWheel"),c={passive:s};(u||l||!Object(a["isChrome"])())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,u)}),c);var f,h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,u)}),c)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(f),f=setTimeout((function(){e.wtSettings.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,a=o!==n&&i!==n&&!i.contains(o),l=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&s)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=Object(k["isKey"])(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var r=this.scrollVertically(t),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable,t=this.domBindings.rootWindow;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=Object(r["getScrollableElement"])(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtTable.spreader,n=t.clientWidth,r=t.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(i+this.inlineStartOverlay.sumCellSizes(0,r),"px"),l.height="".concat(a+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var s=n.wtRootElement,u=s.scrollHeight,c=s.scrollWidth,f=n.holder,h=f.scrollHeight,d=f.scrollWidth;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return Object(c["arrayEach"])(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Object(c["arrayEach"])(t,(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}]),e}(),Vi=Bi;function Fi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ui(e,t,n){return t&&Wi(e.prototype,t),n&&Wi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function zi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gi=function(){function e(t){var n=this;Fi(this,e),zi(this,"settings",{}),zi(this,"defaults",Object.freeze(this.getDefaults())),Object(u["objectEach"])(this.defaults,(function(e,r){if(void 0!==t[r])n.settings[r]=t[r];else{if(void 0===e)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=e}}))}return Ui(e,[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,n,o){var i=e.getSetting("data",t,n);Object(r["fastInnerText"])(o,void 0===i||null===i?"":i)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,t){var n=this;return void 0===t?Object(u["objectEach"])(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this}},{key:"getSetting",value:function(e,t,n,r,o){return"function"===typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),e}();function Yi(e){return Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yi(e)}function Xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $i(e,t,n){return t&&Ki(e.prototype,t),n&&Ki(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qi(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qi(e,t)}function Qi(e,t){return Qi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qi(e,t)}function Ji(e){var t=ta();return function(){var n,r=na(e);if(t){var o=na(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zi(this,n)}}function Zi(e,t){if(t&&("object"===Yi(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ea(e)}function ea(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ta(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function na(e){return na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},na(e)}var ra=function(e){qi(n,e);var t=Ji(n);function n(e,r,o,i){return Xi(this,n),t.call(this,e,r,o,i,"master")}return $i(n,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=Object(r["getTrimmingContainer"])(this.wtRootElement),t=this.domBindings.rootWindow;if(e===t){var n=this.wtSettings.getSetting("preventOverflow");n||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var o=e.parentElement,i=Object(r["getStyle"])(e,"height",t),a=Object(r["getStyle"])(e,"overflow",t),l=this.holder.style,s=e.scrollWidth,u=e.scrollHeight,c=e.getBoundingClientRect(),f=c.width,h=c.height,d=["auto","hidden","scroll"];if(o&&d.includes(a)){var p=e.cloneNode(!1);p.style.overflow="auto",e.nextElementSibling?o.insertBefore(p,e.nextElementSibling):o.appendChild(p);var y=parseInt(Object(r["getComputedStyle"])(p,t).height,10);o.removeChild(p),0===y&&(h=0)}h=Math.min(h,u),l.height="auto"===i?"auto":"".concat(h,"px"),f=Math.min(f,s),l.width="".concat(f,"px"),l.overflow="",this.hasTableHeight="auto"===l.height||h>0,this.hasTableWidth=f>0}this.isTableVisible=Object(r["isVisible"])(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport,n="master",r=e.getSetting("columnHeaders"),o=r.length;if(o&&!t.hasOversizedColumnHeadersMarked[n]){for(var i=e.getSetting("rowHeaders"),a=i.length,l=this.getRenderedColumnsCount(),s=0;s<o;s++)for(var u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);t.hasOversizedColumnHeadersMarked[n]=!0}}}]),n}(dn);Object(u["mixin"])(ra,no),Object(u["mixin"])(ra,mn);var oa=ra,ia=n("5711"),aa=n("38f3"),la=n("3e74");function sa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ca(e,t,n){return t&&ua(e.prototype,t),n&&ua(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var fa=function(){function e(t,n,r,o,i){var a=this;sa(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){a.clientHeight=a.getWorkspaceHeight()}))}return ca(e,[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer,n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{var o=Object(r["outerHeight"])(t);n=o>0&&t.clientHeight>0?t.clientHeight:1/0}return n}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wtSettings,o=this.domBindings,i=o.rootDocument,a=o.rootWindow,l=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,u=n.getSetting("totalColumns"),c=n.getSetting("preventOverflow"),f=n.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),d=f?h.right-s:h.left,p=s-d;if(c)return Object(r["outerWidth"])(this.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(p,s):Math.min(this.getContainerFillWidth(),p,s),l===a&&u>0&&this.sumColumnWidths(0,u-1)>e)return i.documentElement.clientWidth;if(l!==a&&(t=Object(r["getStyle"])(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a),"scroll"===t||"hidden"===t||"auto"===t))return Math.max(e,l.clientWidth);var y=n.getSetting("stretchH");return"none"!==y&&y?e:Math.max(e,Object(r["outerWidth"])(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){var n=0,r=e;while(r<t)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return Object(r["offset"])(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var e=this.wtSettings.getSetting("columnHeaders");return e.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(r["outerHeight"])(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,o=t.length;n<o;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){var i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,l=t.length;a<l;a++)i?(this.rowHeaderWidth+=Object(r["outerWidth"])(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ia["b"],i=this.wtSettings,a=this.wtTable;this.rowHeaderWidth=NaN,e=i.getSetting("renderAllRows")&&o===ia["b"]?1/0:this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;l<0&&(l=0);var s=i.getSetting("fixedRowsTop"),u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");return s&&(n=this.dataAccessObject.topOverlay.sumCellSizes(0,s),l+=n,e-=n),u&&this.dataAccessObject.bottomOverlay.clone&&(n=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),e-=n),t=a.holder.clientHeight===a.holder.offsetHeight?0:Object(r["getScrollbarWidth"])(this.domBindings.rootDocument),new aa["a"]({viewportSize:e,scrollOffset:l,totalItems:i.getSetting("totalRows"),itemSizeFn:function(e){return a.getRowHeight(e)},overrideFn:i.getSettingPure("viewportRowCalculatorOverride"),calculationType:o,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ia["b"],t=this.wtSettings,n=this.wtTable,o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,i<0&&(i=0);var a=t.getSetting("fixedColumnsStart");if(a){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);i+=l,o-=l}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=Object(r["getScrollbarWidth"])(this.domBindings.rootDocument)),new la["a"]({viewportSize:o,scrollOffset:Math.abs(i),totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return n.getColumnWidth(e)},overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(ia["a"]),r=this.createColumnsCalculator(ia["a"]);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(ia["b"]),this.columnsRenderCalculator=this.createColumnsCalculator(ia["b"])),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(ia["a"]),this.columnsVisibleCalculator=this.createColumnsCalculator(ia["a"])}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow;if(null===t&&null===n)return!1;var r=this.rowsRenderCalculator,o=r.startRow,i=r.endRow;return!(t<o||t===o&&t>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn;if(null===t&&null===n)return!1;var r=this.columnsRenderCalculator,o=r.startColumn,i=r.endColumn;return!(t<o||t===o&&t>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(u["objectEach"])(this.hasOversizedColumnHeadersMarked,(function(e,t,n){n[t]=void 0}))}}]),e}(),ha=fa;function da(e){return da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},da(e)}function pa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function va(e,t,n){return t&&ya(e.prototype,t),n&&ya(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ga(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ba(e,t)}function ba(e,t){return ba=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ba(e,t)}function ma(e){var t=Ca();return function(){var n,r=Sa(e);if(t){var o=Sa(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wa(this,n)}}function wa(e,t){if(t&&("object"===da(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Oa(e)}function Oa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ca(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Sa(e){return Sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sa(e)}var Ra=function(e){ga(n,e);var t=ma(n);function n(e,r){var o;pa(this,n),o=t.call(this,e,new Gi(r));var i=o.wtSettings.getSetting("facade",Oa(o));return o.wtTable=new oa(o.getTableDao(),i,o.domBindings,o.wtSettings),o.wtViewport=new ha(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new R(i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new Vi(Oa(o),i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return va(n,[{key:"exportSettingsAsClassNames",value:function(){var e=this,t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],o=[];Object(u["objectEach"])(t,(function(t,r){e.wtSettings.getSetting(r).length&&o.push(t),n.push(t)})),Object(r["removeClass"])(this.wtTable.wtRootElement.parentNode,n),Object(r["addClass"])(this.wtTable.wtRootElement.parentNode,o)}},{key:"getViewportDao",value:function(){var e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}]),n}(Gn);function ka(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ja(e,t,n){return t&&Ea(e.prototype,t),n&&Ea(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ta=function(){function e(t){ka(this,e),t instanceof Gn?this._wot=t:this._initFromSettings(t)}return ja(e,[{key:"_initFromSettings",value:function(t){t.facade=function(t){var n=new e(t);return function(){return n}},this._wot=new Ra(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,t){return this._wot.createCellCoords(e,t)}},{key:"createCellRange",value:function(e,t,n){return this._wot.createCellRange(e,t,n)}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wot.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,t){return this._wot.wtSettings.update(e,t),this}},{key:"getSetting",value:function(e,t,n,r,o){return this._wot.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}();function Pa(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=n||r&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Ma(e){var t=e.isLeftClick,n=e.coords,r=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!o.column?r.setRangeEnd(i(u-1,n.col)):a&&!o.row?r.setRangeEnd(i(n.row,s-1)):o.cell||r.setRangeEnd(n)}}var Aa=new Map([["mousedown",Pa],["mouseover",Ma],["touchstart",Pa]]);function Ia(e,t){var n=t.coords,r=t.selection,o=t.controller,i=t.cellCoordsFactory;Aa.get(e.type)({coords:n,selection:r,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Object(g["isLeftClick"])(e)||"touchstart"===e.type,isRightClick:Object(g["isRightClick"])(e)})}var _a=n("fe8a");function xa(e,t){return Da(e)||Na(e,t)||Va(e,t)||Ha()}function Ha(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Na(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Da(e){if(Array.isArray(e))return e}function La(e){return Wa(e)||Fa(e)||Va(e)||Ba()}function Ba(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Va(e,t){if(e){if("string"===typeof e)return Ua(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ua(e,t):void 0}}function Fa(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Wa(e){if(Array.isArray(e))return Ua(e)}function Ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function za(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ya(e,t,n){return t&&Ga(e.prototype,t),n&&Ga(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Xa=new WeakMap,Ka=function(){function e(t){za(this,e),this.instance=t,this.eventManager=new s["a"](t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this._wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,Xa.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Ya(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var n=this._wt.getCell(e,t);return n<0?null:n}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=Xa.get(this),t=this.instance,n=t.rootElement,o=t.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),Object(r["addClass"])(n,"handsontable"),e.table=o.createElement("TABLE"),Object(r["addClass"])(e.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r["addClass"])(e.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=Xa.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=n.selection,l=i.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var o=e.instance.rootWindow;Object(r["clearTextSelection"])(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&Object(r["clearTextSelection"])(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(l,"keyup",(function(e){a.isInProgress()&&!e.shiftKey&&a.finish()})),this.eventManager.addEventListener(l,"mouseup",(function(n){a.isInProgress()&&Object(g["isLeftClick"])(n)&&a.finish(),t.mouseDown=!1,!Object(r["isOutsideInput"])(i.activeElement)&&(a.isSelected()||a.isSelectedByAnyHeader()||o.contains(n.target)||Object(g["isRightClick"])(n))||e.instance.unlisten()})),this.eventManager.addEventListener(l,"contextmenu",(function(e){a.isInProgress()&&Object(g["isRightClick"])(e)&&(a.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(l,"touchend",(function(){a.isInProgress()&&a.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(l,"mousedown",(function(n){var a=n.target,s=n.x||n.clientX,u=n.y||n.clientY,c=n.target;if(!t.mouseDown&&o&&e.instance.view){var f=e.instance.view._wt.wtTable.holder;if(c===f){var h=Object(r["getScrollbarWidth"])(i);if(i.elementFromPoint(s+h,u)!==f||i.elementFromPoint(s,u+h)!==f)return}else while(c!==l){if(null===c){if(n.isTargetWebComponent)break;return}if(c===o)return;c=c.parentNode}var d="function"===typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(a):e.settings.outsideClickDeselects;d?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||Object(r["isInput"])(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t,n=e.row,r=e.col;return(t=this.instance)._createCellCoords.apply(t,La(this.translateFromRenderableToVisualIndex(n,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getNearestNotHiddenIndex(e,t),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return t<0?a=i+1:t>0&&(a=r-i),a}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}},{key:"initializeWalkontable",value:function(){var e=this,t=Xa.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return Object(_a["b"])(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,La(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=e.translateFromRenderableToVisualIndex(t,n),i=xa(o,2),a=i[0],l=i[1],s=e.instance.runHooks("modifyGetCellCoords",a,l),u=a,c=l;if(Array.isArray(s)){var f=xa(s,2);u=f[0],c=f[1]}var h=e.instance.getCellMeta(u,c),d=e.instance.colToProp(c),p=e.instance.getDataAtRowProp(u,d);e.instance.hasHook("beforeValueRender")&&(p=e.instance.runHooks("beforeValueRender",p,h)),e.instance.runHooks("beforeRenderer",r,a,l,d,p,h),e.instance.getCellRenderer(h)(e.instance,r,a,l,d,p,h),e.instance.runHooks("afterRenderer",r,a,l,d,p,h)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=i,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,a,o,l),Object(g["isImmediatePropagationStopped"])(n)||(Ia(n,{coords:a,selection:e.instance.selection,controller:l,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseDown",n,a,o),e.activeWt=e._wt)},onCellContextMenu:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r);e.activeWt=i,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,a,o),Object(g["isImmediatePropagationStopped"])(n)||(e.instance.runHooks("afterOnCellContextMenu",n,a,o),e.activeWt=e._wt)},onCellMouseOut:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,i,r),Object(g["isImmediatePropagationStopped"])(t)||(e.instance.runHooks("afterOnCellMouseOut",t,i,r),e.activeWt=e._wt)},onCellMouseOver:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};e.activeWt=i,e.instance.runHooks("beforeOnCellMouseOver",n,a,o,l),Object(g["isImmediatePropagationStopped"])(n)||(t.mouseDown&&Ia(n,{coords:a,selection:e.instance.selection,controller:l,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseOver",n,a,o),e.activeWt=e._wt)},onCellMouseUp:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,i,r),Object(g["isImmediatePropagationStopped"])(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,i,r),e.activeWt=e._wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var o=e.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingRowHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var o=e.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingColumnHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:function(t,n,r){var o,i=e.translateFromRenderableToVisualIndex(t,n),a=xa(i,2),l=a[0],s=a[1],u=e.instance.selection.getSelectedRange(),c=u.size();if(c>0){var f=(null!==r&&void 0!==r?r:0)+1-c,h=u.peekByIndex(f);o=[h.from.row,h.from.col,h.to.row,h.to.col]}return e.instance.runHooks("afterDrawSelection",l,s,o,r)},onBeforeDrawBorders:function(t,n){var r=xa(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(i),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return e.instance.runHooks("beforeDrawBorders",s,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=e.instance.rowIndexMapper,i=e.instance.columnIndexMapper,a=n>=0?i.getVisualFromRenderableIndex(n):n,l=t>=0?o.getVisualFromRenderableIndex(t):t,s=e.instance.runHooks("modifyGetCellCoords",l,a,r);if(Array.isArray(s)){var u=xa(s,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"===typeof n)t.startRow=Math.max(o-n,0),t.endRow=Math.min(i+n,r-1);else if("auto"===n){var a=Math.ceil(i/r*12);t.startRow=Math.max(o-a,0),t.endRow=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"===typeof n&&(t.startColumn=Math.max(o-n,0),t.endColumn=Math.min(i+n,r-1)),"auto"===n){var a=Math.ceil(i/r*6);t.startColumn=Math.max(o-a,0),t.endColumn=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new Ta(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,a=o.height;this.setLastSize(i,a),this.eventManager.addEventListener(r,"mousedown",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(Object(r["isInput"])(e))return!0;var t=Object(r["isChildOf"])(e,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return Xa.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!Object(r["hasClass"])(n,"relative"))return Object(r["empty"])(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=this.instance,i=o.rootDocument,a=o.getRowHeader,l=i.createElement("div"),s=i.createElement("span");l.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,a),l.appendChild(s),t.appendChild(l)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;Object(r["hasClass"])(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):(Object(r["empty"])(t),this.appendColHeader(e,t))}else{var o=this.instance.rootDocument,i=o.createElement("div"),a=o.createElement("span");i.className="relative",a.className="colHeader",this.updateCellHeader(a,e,this.instance.getColHeader),i.appendChild(a),t.appendChild(i)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(e,t,n){var o=t,i=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Object(r["hasClass"])(e,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(t):Object(r["hasClass"])(e,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(t))),o>-1?Object(r["fastInnerHTML"])(e,n(t)):(Object(r["fastInnerText"])(e,String.fromCharCode(160)),Object(r["addClass"])(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this._wt.wtViewport.getWorkspaceWidth(),n=t-e;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this._wt.wtViewport.getWorkspaceHeight(),n=t-e;return n>0?n:0}},{key:"setLastSize",value:function(e,t){var n=Xa.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=Xa.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}(),$a=Ka,qa=n("85c9");function Qa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Za(e,t,n){return t&&Ja(e.prototype,t),n&&Ja(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var el=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Qa(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Za(e,[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return Object(c["arrayEach"])(this.data,(function(r,o){var i=t.getAtCell(o,e);n.push(i)})),n}},{key:"getAtRow",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=void 0===t&&void 0===n,l=null,s=null;if(l=this.modifyRowData(e),Array.isArray(l))s=[],a?l.forEach((function(t,n){s[n]=r.getAtPhysicalCell(e,n,l)})):Object(v["rangeEach"])(t,n,(function(n){s[n-t]=r.getAtPhysicalCell(e,n,l)}));else if(Object(u["isObject"])(l)||Object(o["isFunction"])(l))if(s=i?[]:{},!a||i){var c=0,f=this.countFirstRowKeys()-1;Object(v["rangeEach"])(c,f,(function(o){var a=r.colToProp(o);if(o>=(t||c)&&o<=(n||f)&&!Number.isInteger(a)){var h=r.getAtPhysicalCell(e,a,l);i?s.push(h):Object(u["setProperty"])(s,a,h)}}))}else Object(u["objectEach"])(l,(function(t,n){Object(u["setProperty"])(s,n,r.getAtPhysicalCell(e,n,l))}));return s}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=Object(u["createObjectPropListener"])(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:Object(u["setProperty"])(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var r=null;if(n&&(r="string"===typeof t?Object(u["getProperty"])(n,t):"function"===typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var o=Object(u["createObjectPropListener"])(r);this.hot.runHooks("modifySourceData",e,this.colToProp(t),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,a=null,l=null,s=null;null===t||null===n?(o=!0,i=0,l=this.countRows()-1):(i=Math.min(t.row,n.row),a=Math.min(t.col,n.col),l=Math.max(t.row,n.row),s=Math.max(t.col,n.col));var u=[];return Object(v["rangeEach"])(i,l,(function(t){u.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,a,s,r))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Object(qa["countFirstRowKeys"])(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}(),tl=el,nl=(n("bdb6"),n("6315"),n("129d"),n("986e"),n("32f9")),rl=n("e923"),ol=n("b976"),il=n("e86f"),al=n("cffe"),ll=n("54fd"),sl=new Map([["hiding",rl["a"]],["index",ol["a"]],["linkedPhysicalIndexToValue",il["a"]],["physicalIndexToValue",al["a"]],["trimming",ll["a"]]]);function ul(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!sl.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(sl.get(e))(t)}var cl=n("349e"),fl=n("097b");function hl(e){return hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hl(e)}function dl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yl(e,t,n){return t&&pl(e.prototype,t),n&&pl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vl(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gl(e,t)}function gl(e,t){return gl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gl(e,t)}function bl(e){var t=Ol();return function(){var n,r=Cl(e);if(t){var o=Cl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ml(this,n)}}function ml(e,t){if(t&&("object"===hl(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wl(e)}function wl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ol(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Cl(e){return Cl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cl(e)}var Sl=function(e){vl(n,e);var t=bl(n);function n(e,r){var o;return dl(this,n),o=t.call(this),o.mergedValuesCache=[],o.aggregationFunction=e,o.fallbackValue=r,o}return yl(n,[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=Object(c["arrayMap"])(this.get(),(function(e){return e.getValues()})),n=[],r=Object(i["isDefined"])(t[0])&&t[0].length||0,o=0;o<r;o+=1){for(var a=[],l=0;l<this.getLength();l+=1)a.push(t[l][o]);n.push(a)}return Object(c["arrayMap"])(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return Object(i["isDefined"])(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),n}(fl["a"]),Rl=n("362c");function kl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function El(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jl(e,t,n){return t&&El(e.prototype,t),n&&El(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tl(e,t,n){Pl(e,t),t.set(e,n)}function Pl(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(e,t,n){var r=_l(e,t,"set");return Al(e,r,n),n}function Al(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function Il(e,t){var n=_l(e,t,"get");return xl(e,n)}function _l(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function xl(e,t){return t.get?t.get.call(e):t.value}var Hl=new WeakMap,Nl=function(){function e(){kl(this,e),Tl(this,Hl,{writable:!0,value:[]})}return jl(e,[{key:"subscribe",value:function(e){return this.addLocalHook("change",e),this._write(Il(this,Hl)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){Ml(this,Hl,e)}}]),e}();function Dl(e,t){for(var n=[],r=0,o=0;r<e.length&&o<t.length;r++,o++)e[r]!==t[o]&&n.push({op:"replace",index:o,oldValue:e[r],newValue:t[o]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;o<e.length;o++)n.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return n}function Ll(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vl(e,t,n){return t&&Bl(e.prototype,t),n&&Bl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fl(e,t,n){Wl(e,t),t.set(e,n)}function Wl(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ul(e,t){var n=Yl(e,t,"get");return zl(e,n)}function zl(e,t){return t.get?t.get.call(e):t.value}function Gl(e,t,n){var r=Yl(e,t,"set");return Xl(e,r,n),n}function Yl(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Xl(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}Object(u["mixin"])(Nl,Rl["a"]);var Kl,$l=new WeakMap,ql=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,es=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialIndexValue;Ll(this,e),Fl(this,$l,{writable:!0,value:new Set}),Fl(this,ql,{writable:!0,value:[]}),Fl(this,Ql,{writable:!0,value:[]}),Fl(this,Jl,{writable:!0,value:!1}),Fl(this,Zl,{writable:!0,value:!1}),Gl(this,Zl,null!==n&&void 0!==n&&n)}return Vl(e,[{key:"createObserver",value:function(){var e=this,t=new Nl;return Ul(this,$l).add(t),t.addLocalHook("unsubscribe",(function(){Ul(e,$l).delete(t)})),t._writeInitialChanges(Dl(Ul(this,ql),Ul(this,Ql))),t}},{key:"emit",value:function(e){var t=Ul(this,Ql);Ul(this,Jl)&&Ul(this,ql).length===e.length||(0===e.length?e=new Array(t.length).fill(Ul(this,Zl)):Gl(this,ql,new Array(e.length).fill(Ul(this,Zl))),Ul(this,Jl)||(Gl(this,Jl,!0),t=Ul(this,ql)));var n=Dl(t,e);Ul(this,$l).forEach((function(e){return e._write(n)})),Gl(this,Ql,e)}}]),e}();function ts(e){return is(e)||os(e)||rs(e)||ns()}function ns(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rs(e,t){if(e){if("string"===typeof e)return as(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?as(e,t):void 0}}function os(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function is(e){if(Array.isArray(e))return as(e)}function as(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ls(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ss(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function us(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cs(e,t,n){return t&&us(e.prototype,t),n&&us(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var fs=new Set(["getFirstNotHiddenIndex"]),hs=function(){function e(){var t=this;ss(this,e),this.indexesSequence=new nl["a"],this.trimmingMapsCollection=new Sl((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new Sl((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new fl["a"],this.hidingChangesObservable=new es({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}return cs(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,ul(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof ll["a"]?this.trimmingMapsCollection.register(e,t):t instanceof rl["a"]?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return Object(i["isDefined"])(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return Object(i["isDefined"])(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return Object(i["isDefined"])(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return Object(i["isDefined"])(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t;fs.has("getFirstNotHiddenIndex")&&(fs.delete("getFirstNotHiddenIndex"),Object(et["b"])(Object(tt["a"])(Kl||(Kl=ls(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])))));var o=this.getPhysicalFromVisualIndex(e);return null===o?!0===n&&r!==e-t?this.getFirstNotHiddenIndex(r,-t,!1,r):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,n,r)}},{key:"getNearestNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(e);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),i=-1;return i=t>0?o.findIndex((function(t){return t>e})):o.reverse().findIndex((function(t){return t<e})),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:o[i]}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=ts(new Array(e).keys()),this.notHiddenIndexesCache=ts(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var t=this.getNumberOfIndexes();if(e<t){var n=ts(Array(this.getNumberOfIndexes()-e).keys()).map((function(t){return t+e}));this.removeIndexes(n)}else this.insertIndexes(t,e-t)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"===typeof e&&(e=[e]);var r=Object(c["arrayMap"])(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),o=this.getNotTrimmedIndexesLength(),i=e.length,a=Object(cl["b"])(this.getIndexesSequence(),r),l=o-i;if(t+i<o){var s=a.filter((function(e){return!1===n.isTrimmed(e)}))[t];l=a.indexOf(s)}this.setIndexesSequence(Object(cl["a"])(a,l,r))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=Object(i["isDefined"])(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=Object(c["arrayMap"])(new Array(t).fill(r),(function(e,t){return e+t}));this.suspendOperations(),this.indexesSequence.insert(o,a),this.trimmingMapsCollection.insertToEvery(o,a),this.hidingMapsCollection.insertToEvery(o,a),this.variousMapsCollection.insertToEvery(o,a),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}]),e}();Object(u["mixin"])(hs,Rl["a"]);var ds=n("0393"),ps=n("f253"),ys=n("1f1d"),vs=(n("0ee2"),n("7cd7"),n("7dc0"),n("179d")),gs=n("b0e6");n("7003"),n("93ae"),n("9dec");function bs(e,t){return Ss(e)||Cs(e,t)||ws(e,t)||ms()}function ms(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ws(e,t){if(e){if("string"===typeof e)return Os(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Os(e,t):void 0}}function Os(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cs(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ss(e){if(Array.isArray(e))return e}function Rs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ks(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Es(e,t,n){return t&&ks(e.prototype,t),n&&ks(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var js=function(){function e(t,n){Rs(this,e),n&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return Es(e,[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){var r=e.main.childNodes[t];e.eventManager.addEventListener(r,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r,o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),Object(g["stopImmediatePropagation"])(e);var n=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",a)}function i(e){return e.clientY<Math.floor(o.top)||(e.clientY>Math.ceil(o.top+o.height)||(e.clientX<Math.floor(o.left)||(e.clientX>Math.ceil(o.left+o.width)||void 0)))}function a(e){i(e)&&(n.eventManager.removeEventListener(r,"mousemove",a),t.style.display="block")}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],l=t.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(l.className+=" hidden"),r=l.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(a["isMobileBrowser"])()&&this.createMultipleSelectorHandles(),this.disappear();var s=this.wot.wtTable,u=s.bordersHolder;u||(u=t.createElement("div"),u.className="htBorders",s.bordersHolder=u,s.spreader.appendChild(u)),u.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};var n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(r,"px"),width:"".concat(r,"px"),"border-radius":"".concat(parseInt(r/1.5,10),"px")};Object(u["objectEach"])(o,(function(t,n){e.selectionHandles.styles.bottomHitArea[n]=t,e.selectionHandles.styles.topHitArea[n]=t}));var i={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Object(u["objectEach"])(i,(function(t,n){e.selectionHandles.styles.bottom[n]=t,e.selectionHandles.styles.top[n]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,t){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,o,i){var a=this.wot.wtSettings.getSetting("rtlMode"),l=a?"right":"left",s=parseInt(this.selectionHandles.styles.top.width,10),u=parseInt(this.selectionHandles.styles.topHitArea.width,10);this.selectionHandles.styles.top.top="".concat(parseInt(n-s-1,10),"px"),this.selectionHandles.styles.top[l]="".concat(parseInt(r-s-1,10),"px"),this.selectionHandles.styles.topHitArea.top="".concat(parseInt(n-u/4*3,10),"px"),this.selectionHandles.styles.topHitArea[l]="".concat(parseInt(r-u/4*3,10),"px"),this.selectionHandles.styles.bottom.top="".concat(parseInt(n+i,10),"px"),this.selectionHandles.styles.bottom[l]="".concat(parseInt(r+o,10),"px"),this.selectionHandles.styles.bottomHitArea.top="".concat(parseInt(n+i-u/4,10),"px"),this.selectionHandles.styles.bottomHitArea[l]="".concat(parseInt(r+o-u/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.top.display="block",this.selectionHandles.styles.topHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none"):(this.selectionHandles.styles.bottom.display="block",this.selectionHandles.styles.bottomHitArea.display="block")):(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottomHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(this.selectionHandles.styles.top.zIndex="9999",this.selectionHandles.styles.topHitArea.zIndex="9999"):(this.selectionHandles.styles.top.zIndex="",this.selectionHandles.styles.topHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,o,i,l,s,u=this.wot,c=u.wtTable,f=u.rootDocument,h=u.rootWindow,d=c.getRenderedRowsCount(),p=0;p<d;p+=1){var y=c.rowFilter.renderedToSource(p);if(y>=e[0]&&y<=e[2]){t=y,l=e[0];break}}for(var v=d-1;v>=0;v-=1){var g=c.rowFilter.renderedToSource(v);if(g>=e[0]&&g<=e[2]){n=g;break}}for(var b=c.getRenderedColumnsCount(),m=0;m<b;m+=1){var w=c.columnFilter.renderedToSource(m);if(w>=e[1]&&w<=e[3]){o=w,s=e[1];break}}for(var O=b-1;O>=0;O-=1){var C=c.columnFilter.renderedToSource(O);if(C>=e[1]&&C<=e[3]){i=C;break}}if(void 0!==t&&void 0!==o){var S=c.getCell(this.wot.createCellCoords(t,o)),R=t!==n||o!==i,k=R?c.getCell(this.wot.createCellCoords(n,i)):S,E=Object(r["offset"])(S),j=R?Object(r["offset"])(k):E,T=Object(r["offset"])(c.TABLE),P=Object(r["outerWidth"])(c.TABLE),M=E.top,A=E.left,I=this.wot.wtSettings.getSetting("rtlMode"),_=0,x=0;if(I){var H=Object(r["outerWidth"])(S),N=h.innerWidth-T.left-P;x=A+H-j.left,_=h.innerWidth-A-H-N-1}else x=j.left+Object(r["outerWidth"])(k)-A,_=A-T.left-1;if(this.isEntireColumnSelected(t,n)){var D=this.getDimensionsFromHeader("columns",o,i,l,T),L=null;if(D){var B=bs(D,3);L=B[0],_=B[1],x=B[2]}L&&(S=L)}var V=M-T.top-1,F=j.top+Object(r["outerHeight"])(k)-M;if(this.isEntireRowSelected(o,i)){var W=this.getDimensionsFromHeader("rows",t,n,s,T),U=null;if(W){var z=bs(W,3);U=z[0],V=z[1],F=z[2]}U&&(S=U)}var G=Object(r["getComputedStyle"])(S,h);parseInt(G.borderTopWidth,10)>0&&(V+=1,F=F>0?F-1:0),parseInt(G[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(_+=1,x=x>0?x-1:0);var Y=I?"right":"left";this.topStyle.top="".concat(V,"px"),this.topStyle[Y]="".concat(_,"px"),this.topStyle.width="".concat(x,"px"),this.topStyle.display="block",this.startStyle.top="".concat(V,"px"),this.startStyle[Y]="".concat(_,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var X=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(V+F-X,"px"),this.bottomStyle[Y]="".concat(_,"px"),this.bottomStyle.width="".concat(x,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(V,"px"),this.endStyle[Y]="".concat(_+x-X,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var K=this.settings.border.cornerVisible;K="function"===typeof K?K(this.settings.layerLevel):K;var $=this.wot.getSetting("onModifyGetCellCoords",n,i),q=n,Q=i;if($&&Array.isArray($)){var J=bs($,4);q=J[2],Q=J[3]}if(Object(a["isMobileBrowser"])()||!K||this.isPartRange(q,Q))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(V+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[Y]="".concat(_+x+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Z=Object(r["getTrimmingContainer"])(c.TABLE),ee=Z===h;if(ee&&(Z=f.documentElement),i===this.wot.getSetting("totalColumns")-1){var te=ee?k.getBoundingClientRect().left:k.offsetLeft,ne=!1,re=0;I?(re=te-parseInt(this.cornerDefaultStyle.width,10)/2,ne=re<0):(re=te+Object(r["outerWidth"])(k)+parseInt(this.cornerDefaultStyle.width,10)/2,ne=re>=Object(r["innerWidth"])(Z)),ne&&(this.cornerStyle[Y]="".concat(Math.floor(_+x+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0)}if(n===this.wot.getSetting("totalRows")-1){var oe=ee?k.getBoundingClientRect().top:k.offsetTop,ie=oe+Object(r["outerHeight"])(k)+parseInt(this.cornerDefaultStyle.height,10)/2,ae=ie>=Object(r["innerHeight"])(Z);ae&&(this.cornerStyle.top="".concat(Math.floor(V+F+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Object(a["isMobileBrowser"])()&&this.updateMultipleSelectionHandlesPosition(n,i,V,_,x,F)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,o,i){var a=this.wot.wtTable,l=a.wtRootElement.parentNode,s=null,u=null,c=null,f=null,h=null,d=null,p=null,y=null;switch(e){case"rows":s=function(){return a.getRowHeader.apply(a,arguments)},u=function(){return r["outerHeight"].apply(void 0,arguments)},c="ht__selection--rows",d="top";break;case"columns":s=function(){return a.getColumnHeader.apply(a,arguments)},u=function(){return r["outerWidth"].apply(void 0,arguments)},c="ht__selection--columns",d="left";break;default:}if(l.classList.contains(c)){var v=this.wot.getSetting("columnHeaders").length;if(p=s(t,v-o),y=s(n,v-o),!p||!y)return!1;var g=Object(r["offset"])(p),b=Object(r["offset"])(y);return p&&y&&(f=g[d]-i[d]-1,h=b[d]+u(y)-g[d]),[p,f,h]}return!1}},{key:"changeBorderStyle",value:function(e,t){var n=this[e].style,o=t[e];!o||o.hide?Object(r["addClass"])(this[e],"hidden"):(Object(r["hasClass"])(this[e],"hidden")&&Object(r["removeClass"])(this[e],"hidden"),n.backgroundColor=o.color,"top"!==e&&"bottom"!==e||(n.height="".concat(o.width,"px")),"start"!==e&&"end"!==e||(n.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width="".concat(t.width,"px"),n.height="".concat(t.width,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?Object(r["addClass"])(this[e],"hidden"):Object(r["removeClass"])(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Object(a["isMobileBrowser"])()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.bottom.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}(),Ts=js;function Ps(e,t){return xs(e)||_s(e,t)||As(e,t)||Ms()}function Ms(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function As(e,t){if(e){if("string"===typeof e)return Is(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Is(e,t):void 0}}function Is(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _s(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function xs(e){if(Array.isArray(e))return e}function Hs(e){return Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hs(e)}function Ns(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ls(e,t,n){return t&&Ds(e.prototype,t),n&&Ds(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Bs=function(){function e(t,n){Ns(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Ls(e,[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Ts(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"===Hs(a)){var l=o;i&&(l=this.classNameGenerator(a),this.classNames.includes(l)||this.classNames.push(l)),Object(r["addClass"])(a,l)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(o){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===i)return e;var a=i>=0?i:t,l=e;a-=1;var s=0===a?e:"".concat(e,"-").concat(a);if(Object(r["hasClass"])(o,s)){var u=a+1;l="".concat(e,"-").concat(u)}else l=n(o,a);return l}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),i=Ps(o,4),a=i[0],l=i[1],s=i[2],u=i[3],c=this.settings,f=c.highlightHeaderClassName,h=c.highlightColumnClassName,d=c.highlightRowClassName,p=c.highlightOnlyClosestHeader,y=c.selectionType,v=void 0===y||["active-header","header"].includes(y);if(v&&null!==l&&null!==u)for(var g=0,b=0;b<n;b+=1){var m=e.wtTable.columnFilter.renderedToSource(b);if(m>=l&&m<=u){var w=e.wtTable.getColumnHeaders(m),O=w.length-1;p&&w.length>1&&(w=[w[O]]);for(var C=0;C<w.length;C+=1){var S=[],R=w[C];f&&S.push(f),h&&S.push(h),C=p?O:C;var k=e.getSetting("onBeforeHighlightingColumnHeader",m,C,{selectionType:y,columnCursor:g,selectionWidth:u-l+1,classNames:S});k!==m&&(R=e.wtTable.getColumnHeader(k,C)),Object(r["addClass"])(R,S)}g+=1}}if(null!==a&&null!==s)for(var E=0,j=0;j<t;j+=1){var T=e.wtTable.rowFilter.renderedToSource(j);if(v&&T>=a&&T<=s){var P=e.wtTable.getRowHeaders(T),M=P.length-1;p&&P.length>1&&(P=[P[M]]);for(var A=0;A<P.length;A+=1){var I=[],_=P[A];f&&I.push(f),d&&I.push(d),A=p?M:A;var x=e.getSetting("onBeforeHighlightingRowHeader",T,A,{selectionType:y,rowCursor:E,selectionHeight:s-a+1,classNames:I});x!==T&&(_=e.wtTable.getRowHeader(x,A)),Object(r["addClass"])(_,I)}E+=1}if(null!==l&&null!==u)for(var H=0;H<n;H+=1){var N=e.wtTable.columnFilter.renderedToSource(H);T>=a&&T<=s&&N>=l&&N<=u?this.settings.className&&this.addClassAtCoords(e,T,N,this.settings.className,this.settings.markIntersections):T>=a&&T<=s?d&&this.addClassAtCoords(e,T,N,d):N>=l&&N<=u&&h&&this.addClassAtCoords(e,T,N,h);var D=e.getSetting("onAfterDrawSelection",T,N,this.settings.layerLevel);"string"===typeof D&&this.addClassAtCoords(e,T,N,D)}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}]),e}(),Vs=Bs;function Fs(e){return Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fs(e)}function Ws(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Us(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zs(e,t,n){return t&&Us(e.prototype,t),n&&Us(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gs(){return Gs="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ys(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Gs.apply(this,arguments)}function Ys(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Zs(e),null===e)break;return e}function Xs(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ks(e,t)}function Ks(e,t){return Ks=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ks(e,t)}function $s(e){var t=Js();return function(){var n,r=Zs(e);if(t){var o=Zs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qs(this,n)}}function qs(e,t){if(t&&("object"===Fs(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qs(e)}function Qs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Js(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Zs(e){return Zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zs(e)}function eu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tu=function(e){Xs(n,e);var t=$s(n);function n(e,r){var o;return Ws(this,n),o=t.call(this,e,null),eu(Qs(o),"visualCellRange",null),o.visualCellRange=r||null,o.commit(),o}return zs(n,[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,Gs(Zs(n.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(e){var t=e.from,n=e.to,r=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){var i="header"===this.settings.type||"active-header"===this.settings.type;if(!i)return null;r=t,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(e,t,n){if(t<0)return t;var r=e.getNearestNotHiddenIndex(t,n),o="header"===this.settings.type||"active-header"===this.settings.type;return o&&null===r?-1:r}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}},{key:"syncWith",value:function(e){var t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(null!==r&&e.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return e.setHighlight(r),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,o=null===t.col||null===n.col,i=this.settings.createCellCoords(r?null:Math.min(t.row,n.row),o?null:Math.min(t.col,n.col)),a=this.settings.createCellCoords(r?null:Math.max(t.row,n.row),o?null:Math.max(t.col,n.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,r)}}]),n}(Vs),nu=tu,ru=["activeHeaderClassName"];function ou(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ou(Object(n),!0).forEach((function(t){au(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ou(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function au(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lu(e,t){if(null==e)return{};var n,r,o=su(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function su(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function uu(e){var t=e.activeHeaderClassName,n=lu(e,ru),r=new nu(iu(iu({highlightHeaderClassName:t},n),{},{selectionType:gs["a"]}));return r}var cu=uu,fu=["layerLevel","areaCornerVisible"];function hu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function du(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hu(Object(n),!0).forEach((function(t){pu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yu(e,t){if(null==e)return{};var n,r,o=vu(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function vu(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function gu(e){var t=e.layerLevel,n=e.areaCornerVisible,r=yu(e,fu),o=new nu(du(du({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:gs["b"]}));return o}var bu=gu,mu=["cellCornerVisible"];function wu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wu(Object(n),!0).forEach((function(t){Cu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Su(e,t){if(null==e)return{};var n,r,o=Ru(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ru(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function ku(e){var t=e.cellCornerVisible,n=Su(e,mu),r=new nu(Ou(Ou({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:gs["c"]}));return r}var Eu=ku,ju=["border","visualCellRange"];function Tu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tu(Object(n),!0).forEach((function(t){Mu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Au(e,t){if(null==e)return{};var n,r,o=Iu(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Iu(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function _u(e){var t=e.border,n=e.visualCellRange,r=Au(e,ju),o=new nu(Pu(Pu(Pu({},t),r),{},{selectionType:gs["d"]}),n);return o}var xu=_u;n("f74c");function Hu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hu(Object(n),!0).forEach((function(t){Du(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Du(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lu(e){var t=Object.assign({},e),n=new nu(Nu(Nu({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:gs["e"]}));return n}var Bu=Lu,Vu=["headerClassName","rowClassName","columnClassName"];function Fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fu(Object(n),!0).forEach((function(t){Uu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Uu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zu(e,t){if(null==e)return{};var n,r,o=Gu(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Gu(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function Yu(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,o=zu(e,Vu),i=new nu(Wu(Wu({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:gs["f"]}));return i}var Xu=Yu;function Ku(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ku(Object(n),!0).forEach((function(t){qu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ku(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qu=Object(vs["a"])("highlight/types"),Ju=Qu.register,Zu=Qu.getItem;function ec(e,t){return Zu(e)($u({type:e},t))}function tc(e){return ic(e)||oc(e)||rc(e)||nc()}function nc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rc(e,t){if(e){if("string"===typeof e)return ac(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ac(e,t):void 0}}function oc(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ic(e){if(Array.isArray(e))return ac(e)}function ac(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lc(Object(n),!0).forEach((function(t){uc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hc(e,t,n){return t&&fc(e.prototype,t),n&&fc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Ju(gs["a"],cu),Ju(gs["b"],bu),Ju(gs["c"],Eu),Ju(gs["d"],xu),Ju(gs["e"],Bu),Ju(gs["f"],Xu);var dc=function(e){function t(e){cc(this,t),this.options=e,this.layerLevel=0,this.cell=ec(gs["c"],e),this.fill=ec(gs["e"],e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return hc(t,[{key:"isEnabledFor",value:function(e,t){var n=e;e===gs["c"]&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=ec(gs["b"],sc({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return tc(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=ec(gs["f"],sc({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return tc(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=ec(gs["a"],sc({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return tc(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return tc(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(ec(gs["d"],sc(sc({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(c["arrayEach"])(this.areas.values(),(function(e){e.clear()})),Object(c["arrayEach"])(this.headers.values(),(function(e){e.clear()})),Object(c["arrayEach"])(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:e,value:function(){return[this.cell,this.fill].concat(tc(this.areas.values()),tc(this.headers.values()),tc(this.activeHeaders.values()),tc(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator),pc=dc;function yc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gc(e,t,n){return t&&vc(e.prototype,t),n&&vc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var bc=function(e){function t(e){yc(this,t),this.ranges=[],this.createCellRange=e}return gc(t,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(this.createCellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator),mc=bc;function wc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cc(e,t,n){return t&&Oc(e.prototype,t),n&&Oc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Sc=function(){function e(t,n){wc(this,e),this.range=t,this.options=n}return Cc(e,[{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(e,t),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,l=i.col,s=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==a&&null!==l){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),y=this.options.minSpareCols(),v=this.options.autoWrapRow(),g=this.options.autoWrapCol();a+e>f-1?n&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):g&&(r.row=1-f,r.col=l+r.col===h-1?1-h:1):g&&a+r.row<0&&l+r.col>=0&&(r.row=f-1,r.col=l+r.col===0?h-1:-1),l+r.col>h-1?n&&y>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):v&&(r.row=a+r.row===f-1?1-f:1,r.col=1-h):v&&l+r.col<0&&a+r.row>=0&&(r.row=a+r.row===0?f-1:-1,r.col=h-1);var b=this.options.createCellCoords(a+r.row,l+r.col);u=0,c=0,b.row<0?(u=-1,b.row=0):b.row>0&&b.row>=f&&(u=1,b.row=f-1),b.col<0?(c=-1,b.col=0):b.col>0&&b.col>=h&&(c=1,b.col=h-1),s=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformStart",s,u,c),s}},{key:"transformEnd",value:function(e,t){var n=this.options.createCellCoords(e,t),r=this.range.current(),o=r.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(r.highlight),s=l.row,u=l.col;if(null!==s&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(r.to),d=h.row,p=h.col,y=this.options.createCellCoords(d+n.row,p+n.col);i=0,a=0,y.row<0?(i=-1,y.row=0):y.row>0&&y.row>=c&&(i=1,y.row=c-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=f&&(a=1,y.col=f-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}]),e}();Object(u["mixin"])(Sc,Rl["a"]);var Rc,kc=Sc,Ec=n("103a");function jc(e,t){return Ic(e)||Ac(e,t)||Pc(e,t)||Tc()}function Tc(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pc(e,t){if(e){if("string"===typeof e)return Mc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mc(e,t):void 0}}function Mc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ac(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ic(e){if(Array.isArray(e))return e}function _c(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function xc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nc(e,t,n){return t&&Hc(e.prototype,t),n&&Hc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Dc=function(){function e(t,n){var r=this;xc(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new mc((function(e,t,n){return r.tableProps.createCellRange(e,t,n)})),this.highlight=new pc({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},createCellRange:function(e,t,n){return r.tableProps.createCellRange(e,t,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new kc(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))}))}return Nc(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(i["isUndefined"])(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.row<0,l=e.col<0,s=a&&l,u=e.clone();this.selectedByCorner=s,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),u),(!r||r&&!o&&Object(i["isUndefined"])(t))&&this.selectedRange.clear(),this.selectedRange.add(u),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!s&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!s&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(gs["c"],n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(Object(c["arrayEach"])(this.highlight.getAreas(),(function(e){e.clear()})),Object(c["arrayEach"])(this.highlight.getHeaders(),(function(e){e.clear()})),Object(c["arrayEach"])(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(o.clear(),i.clear(),a.clear(),this.highlight.isEnabledFor(gs["b"],n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var l=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(gs["f"],n.highlight)){var s=0===this.tableProps.countRowsTranslated(),u=0===this.tableProps.countColsTranslated(),f=n;if((s||u)&&(f=n.clone()),s&&(f.from.row=-1),u&&(f.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&f.from.normalize(),i.add(f.from).commit()):i.add(f.from).add(f.to).commit(),this.isEntireRowSelected()){var h=this.tableProps.countCols()===n.getWidth();h&&a.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var d=this.tableProps.countRows()===n.getHeight();d&&a.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=Object(u["createObjectPropListener"])(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var o=this.tableProps.createCellCoords(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(this.tableProps.createCellCoords(n-1,r-1)),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=Object(Ec["c"])(e);if(n===Ec["a"])return!1;if(n===Ec["b"])throw new Error(Object(tt["a"])(Rc||(Rc=_c(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=Object(Ec["e"])(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=!e.some((function(e){var t=r(e),n=jc(t,4),a=n[0],l=n[1],s=n[2],u=n[3],c=Object(Ec["d"])(a,o)&&Object(Ec["d"])(l,i)&&Object(Ec["d"])(s,o)&&Object(Ec["d"])(u,i);return!c}));return a&&(this.clear(),Object(c["arrayEach"])(e,(function(e){var n=r(e),o=jc(n,4),i=o[0],a=o[1],l=o[2],s=o[3];t.setRangeStartOnly(t.tableProps.createCellCoords(i,a),!1),t.setRangeEnd(t.tableProps.createCellCoords(l,s)),t.finish()}))),a}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"===typeof e?this.tableProps.propToCol(e):e,o="string"===typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=Object(Ec["d"])(r,i)&&Object(Ec["d"])(o,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,o)),this.finish()),l}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=Object(Ec["d"])(e,r)&&Object(Ec["d"])(t,r);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,o-1)),this.finish()),i}},{key:"refresh",value:function(){var e=this.highlight.getCustomSelections();if(e.forEach((function(e){e.commit()})),this.isSelected()){var t=this.highlight.getCell(),n=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(var r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();o.commit(),i.commit(),a.commit()}this.highlight.useLayerLevel(n)}}}]),e}();Object(u["mixin"])(Dc,Rl["a"]);var Lc=Dc,Bc=n("844f");function Vc(e,t){var n="string"===typeof e?Object(Bc["a"])(e):e;if(Object(u["isObject"])(n)){var r=Object(u["isObject"])(t),o={};return Object(u["objectEach"])(n,(function(e,n){"CELL_TYPE"===n||r&&(!r||Object(u["hasOwnProperty"])(t,n))||(o[n]=e)})),o}}function Fc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}Object(u["inherit"])(n,e);for(var r=0;r<t.length;r++)n.prototype[t[r]]=void 0;return n}function Wc(e){return Number.isInteger(e)&&e>=0}function Uc(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function zc(e){return null===e||void 0===e}var Gc=n("cb3f");function Yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xc(e,t,n){return t&&Yc(e.prototype,t),n&&Yc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $c(){return Xc((function e(){Kc(this,e)}))}var qc=function(){function e(t){Kc(this,e),this.metaCtor=$c(),this.meta=this.metaCtor.prototype,Object(u["extend"])(this.meta,Object(Gc["a"])()),this.meta.instance=t}return Xc(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Object(u["extend"])(this.meta,e),Object(u["extend"])(this.meta,Vc(e.type,e))}}]),e}();function Qc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(e,t,n){return t&&Jc(e.prototype,t),n&&Jc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ef=function(){function e(t){Qc(this,e);var n=t.getMetaConstructor();this.meta=new n}return Zc(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Object(u["extend"])(this.meta,e),Object(u["extend"])(this.meta,Vc(e.type,e))}}]),e}();function tf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rf(e,t,n){return t&&nf(e.prototype,t),n&&nf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var of=function(e){function t(e){tf(this,t),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}return rf(t,[{key:"obtain",value:function(e){Uc((function(){return Wc(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)t=this.data[n],void 0===t&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Uc((function(){return Wc(e)||zc(e)}),"Expecting an unsigned number or null/undefined argument.");for(var r=[],o=this.data.length,i=0;i<n;i++)r.push(o+i),this.data.push(void 0);(t=this.index).splice.apply(t,[zc(e)?this.index.length:e,0].concat(r))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Uc((function(){return Wc(e)||zc(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(zc(e)?this.index.length-t:e,t),r=0;r<n.length;r++){var o=n[r];"number"===typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return Object(c["arrayFilter"])(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}var r=0;return{next:function(){if(r<e.length){var t=e[r];return r+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function af(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sf(e,t,n){return t&&lf(e.prototype,t),n&&lf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var uf=["data","width"],cf=function(){function e(t){var n=this;af(this,e),this.globalMeta=t,this.metas=new of((function(){return n._createMeta()}))}return sf(e,[{key:"updateMeta",value:function(e,t){var n=this.getMeta(e);Object(u["extend"])(n,t),Object(u["extend"])(n,Vc(t.type,n))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return Fc(this.globalMeta.getMetaConstructor(),uf).prototype}}]),e}();function ff(e){return yf(e)||pf(e)||df(e)||hf()}function hf(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function df(e,t){if(e){if("string"===typeof e)return vf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vf(e,t):void 0}}function pf(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function yf(e){if(Array.isArray(e))return vf(e)}function vf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mf(e,t,n){return t&&bf(e.prototype,t),n&&bf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var wf=function(){function e(t){var n=this;gf(this,e),this.columnMeta=t,this.metas=new of((function(){return n._createRow()}))}return mf(e,[{key:"updateMeta",value:function(e,t,n){var r=this.getMeta(e,t);Object(u["extend"])(r,n),Object(u["extend"])(r,Vc(n.type,r))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){var o=this.metas.obtain(e).obtain(t);o[n]=r}},{key:"removeMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);delete r[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,ff(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){Uc((function(){return Wc(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new of((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){var t=this.columnMeta.getMetaConstructor(e);return new t}}]),e}();function Of(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sf(e,t,n){return t&&Cf(e.prototype,t),n&&Cf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Rf=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Of(this,e),this.hot=t,this.globalMeta=new qc(t),this.tableMeta=new ef(this.globalMeta),this.columnMeta=new cf(this.globalMeta),this.cellMeta=new wf(this.columnMeta),o.forEach((function(e){return new e(n)})),this.globalMeta.updateMeta(r)}return Sf(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,o=n.visualColumn,i=this.cellMeta.getMeta(e,t);return i.visualRow=r,i.visualCol=o,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();function kf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ef(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jf(e,t,n){return t&&Ef(e.prototype,t),n&&Ef(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object(u["mixin"])(Rf,Rl["a"]);var Tf=function(){function e(t){var n=this;kf(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(function(e){return n.extendCellMeta(e)})),ds["a"].getSingleton().add("beforeRender",(function(e){e&&n.metaSyncMemo.clear()}),this.metaManager.hot)}return jf(e,[{key:"extendCellMeta",value:function(e){var t,n=e.row,r=e.col;if(null===(t=this.metaSyncMemo.get(n))||void 0===t||!t.has(r)){var i=e.visualRow,a=e.visualCol,l=this.metaManager.hot,s=l.colToProp(a);e.prop=s,l.runHooks("beforeGetCellMeta",i,a,e);var c,f=Object(u["hasOwnProperty"])(e,"type")?e.type:null,h=Object(o["isFunction"])(e.cells)?e.cells(n,r,s):null;if(f)if(h)h.type=null!==(c=h.type)&&void 0!==c?c:f;else h={type:f};h&&this.metaManager.updateCellMeta(n,r,h),l.runHooks("afterGetCellMeta",i,a,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}]),e}();function Pf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Af(e,t,n){return t&&Mf(e.prototype,t),n&&Mf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var If=function(){function e(t){Pf(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(e){var t=this.metaManager.hot.isRtl();if(t&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(e,t,n){if(!n)throw new Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Af(e,[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach((function(t,n){var r=t.target,o=t.onChange,i=void 0===o?function(){}:o,a="string"===typeof r,l=a?r:n,s="_".concat(l);e.metaManager.globalMeta.meta[s]=e.metaManager.globalMeta.meta[l],e.installPropWatcher(n,s,i),a&&e.installPropWatcher(r,s,i)}))}},{key:"installPropWatcher",value:function(e,t,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[t]},set:function(o){var i=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,o,i),this[t]=o},enumerable:!0,configurable:!0})}}]),e}(),_f=(n("b503"),n("8d66"));function xf(e){return xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xf(e)}function Hf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Df(e,t,n){return t&&Nf(e.prototype,t),n&&Nf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Lf=Object(qa["cellMethodLookupFactory"])("copyable",!1),Bf=function(){function e(t,n,r){Hf(this,e),this.instance=t,this.tableMeta=r,this.dataSource=n,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(u["duckSchema"])(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return Df(e,[{key:"createMap",value:function(){var e=this.getSchema();if("undefined"===typeof e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var t,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"===typeof n){var a=Object(u["deepObjectSize"])(e);r=a>0?a:this.countFirstRowKeys(),i=!0}else{var l=this.tableMeta.maxCols;r=Math.min(l,n.length)}for(t=0;t<r;t++){var s=i?n(t):n[t];if(Object(u["isObject"])(s)){if("undefined"!==typeof s.data){var c=i?o:t;this.colToPropCache[c]=s.data,this.propToColCache.set(s.data,c)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Object(qa["countFirstRowKeys"])(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,i=t,a=n;return"undefined"===typeof i&&(i=0,a=""),"object"!==xf(e)||Array.isArray(e)||Object(u["objectEach"])(e,(function(e,t){null===e?(r=a+t,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(e,i,"".concat(t,"."))})),i}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Object(i["isDefined"])(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(Object(i["isDefined"])(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"===typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=this.instance.countSourceRows(),i=o,a=0,l=e;("number"!==typeof l||l>=o)&&(l=o),l<this.instance.countRows()&&(i=this.instance.toPhysicalRow(l));var s=this.instance.runHooks("beforeCreateRow",l,n,r);if(!1===s||null===i)return 0;var c=this.tableMeta.maxRows,f=this.instance.countCols(),h=[],d=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=Object(u["deepClone"])(t.getSchema()):(e=[],Object(v["rangeEach"])(f-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(l+a):(e={},Object(u["deepExtend"])(e,t.getSchema())),h.push(e),a+=1};while(a<n&&o+a<c)d();return this.instance.rowIndexMapper.insertIndexes(l,a),this.spliceData.apply(this,[i,0].concat(h)),this.instance.runHooks("afterCreateRow",l,a,r),this.instance.forceFullRender=!0,a}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r=this.dataSource,o=this.tableMeta.maxCols,i=e;("number"!==typeof i||i>=this.instance.countSourceCols())&&(i=this.instance.countSourceCols());var a=this.instance.runHooks("beforeCreateCol",i,t,n);if(!1===a)return 0;var l=this.instance.countSourceCols();i<this.instance.countCols()&&(l=this.instance.toPhysicalColumn(i));var s=this.instance.countSourceRows(),u=this.instance.countCols(),c=0,f=l;while(c<t&&u<o){if("number"!==typeof i||i>=u)if(s>0)for(var h=0;h<s;h+=1)"undefined"===typeof r[h]&&(r[h]=[]),r[h].push(null);else r.push([null]);else for(var d=0;d<s;d++)r[d].splice(f,0,null);c+=1,f+=1,u+=1}return this.instance.columnIndexMapper.insertIndexes(i,c),this.instance.runHooks("afterCreateCol",i,c,n),this.instance.forceFullRender=!0,c}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t,o=this.visualRowsToPhysical(r,t),a=this.instance.countSourceRows();r=(a+r)%a;var l=this.instance.runHooks("beforeRemoveRow",r,o.length,o,n);if(!1===l)return!1;var s=o.length;if(this.filterData(r,s,o),r<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var u=Object(i["isDefined"])(this.tableMeta.columns)||Object(i["isDefined"])(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===u&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",r,s,o,n),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!==typeof e?-t:e;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,t),i=o.slice(0).sort((function(e,t){return t-e})),a=this.instance.runHooks("beforeRemoveCol",r,t,o,n);if(!1===a)return!1;for(var l=!0,s=i.length,u=this.dataSource,c=0;c<s;c++)l&&o[0]!==o[c]-c&&(l=!1);if(l)for(var f=0,h=this.instance.countSourceRows();f<h;f++)u[f].splice(o[0],t);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var y=0;y<s;y++)u[d].splice(i[y],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,t,o,n),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(e,t,n){for(var r=this.instance.getDataAtCol(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];Object(c["extendArray"])(l,i);var u=0;while(u<n)l.push(null),u+=1;return Object(c["to2dArray"])(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];Object(c["extendArray"])(l,i);var u=0;while(u<n)l.push(null),u+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i,a=this.instance.runHooks("beforeDataSplice",e,t,r);!1!==a&&(i=this.dataSource).splice.apply(i,[e,t].concat(r))}},{key:"filterData",value:function(e,t,n){var r=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n);r=isNaN(o)?o:r;var i=null;if(r&&r.hasOwnProperty&&Object(u["hasOwnProperty"])(r,t))i=r[t];else if("string"===typeof t&&t.indexOf(".")>-1){var a=t.split("."),l=r;if(!l)return null;for(var s=0,c=a.length;s<c;s++)if(l=l[a[s]],"undefined"===typeof l)return null;i=l}else"function"===typeof t&&(i=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=Object(u["createObjectPropListener"])(i);this.instance.runHooks("modifyData",n,this.propToCol(t),f,"get"),f.isTouched()&&(i=f.value)}return i}},{key:"getCopyable",value:function(e,t){return Lf.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,i=this.dataSource[r],a=this.instance.runHooks("modifyRowData",r);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var l=Object(u["createObjectPropListener"])(o);this.instance.runHooks("modifyData",r,this.propToCol(t),l,"set"),l.isTouched()&&(o=l.value)}if(i&&i.hasOwnProperty&&Object(u["hasOwnProperty"])(i,t))i[t]=o;else if("string"===typeof t&&t.indexOf(".")>-1){var s,c=t.split("."),f=i,h=0;for(h=0,s=c.length-1;h<s;h++)"undefined"===typeof f[c[h]]&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=o}else"function"===typeof t?t(this.dataSource.slice(r,r+1)[0],o):i[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){var n,r=this.instance.countSourceRows(),o=[],i=(r+e)%r,a=t;while(i<r&&a)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){var n=this.instance.countCols(),r=[],o=(n+e)%n,i=t;while(o<n&&i){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!==0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var o,i,a,l=[],s=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===s||0===u)return[];var c=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(t.row,n.row)),h=Math.min(Math.max(u-1,0),Math.max(t.col,n.col));for(o=Math.min(t.row,n.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(t.col,n.col);i<=h;i++){if(null===d)break;a.push(c.call(this,o,this.colToProp(i)))}null!==d&&l.push(a)}return l}},{key:"getText",value:function(t,n){return Object(_f["b"])(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return Object(_f["b"])(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}(),Vf=Bf;function Ff(e){return Ff="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ff(e)}function Wf(e,t,n,r){var i=r.hotInstance,a=r.dataMap,l=r.dataSource,s=r.internalSource,c=r.source,f=r.firstRun,h=Object(y["toUpperCaseFirst"])(s),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Object(o["isFunction"])(d.dataSchema)?i.dataType="function":i.dataType="object",a&&a.destroy(),e=i.runHooks("before".concat(h),e,f,c);var p=new Vf(i,e,d);if(t(p),"object"===Ff(e)&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(Ff(e)," given)"));var v,g=p.getSchema();e=[];var b=0,m=0;for(b=0,m=d.startRows;b<m;b++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)v=Object(u["deepClone"])(g[0]),e.push(v);else{v=[];for(var w=0,O=d.startCols;w<O;w++)v.push(null);e.push(v)}else v=Object(u["deepClone"])(g),e.push(v)}Array.isArray(e[0])&&(i.dataType="array"),d.data=e,p.dataSource=e,l.data=e,l.dataType=i.dataType,l.colToProp=p.colToProp.bind(p),l.propToCol=p.propToCol.bind(p),l.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks("after".concat(h),e,f,c),f||(i.runHooks("afterChange",null,s),i.render())}var Uf,zf=n("1e0a"),Gf=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Yf=function(e){return e.map((function(e){var t=e.toLowerCase();return Gf.has(t)?Gf.get(t):t})).sort().join("+")},Xf=function(e){return e.split("+")},Kf=function(e){return e.toLowerCase()};function $f(e){return Jf(e)||Qf(e)||th(e)||qf()}function qf(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Qf(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Jf(e){if(Array.isArray(e))return nh(e)}function Zf(e,t){return oh(e)||rh(e,t)||th(e,t)||eh()}function eh(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function th(e,t){if(e){if("string"===typeof e)return nh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nh(e,t):void 0}}function nh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rh(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function oh(e){if(Array.isArray(e))return e}function ih(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ah=function(e){var t=Object(zf["a"])({errorIdExists:function(t){return'The "'.concat(t,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.keys,r=e.callback,a=e.group,l=e.runOnlyIf,s=void 0===l?function(){return!0}:l,u=e.captureCtrl,c=void 0!==u&&u,f=e.preventDefault,h=void 0===f||f,d=e.stopPropagation,p=void 0!==d&&d,y=e.relativeToGroup,v=e.position;if(Object(i["isUndefined"])(a))throw new Error("You need to define the shortcut's group.");if(!1===Object(o["isFunction"])(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw new Error(Object(tt["a"])(Uf||(Uf=ih(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var g={callback:r,group:a,runOnlyIf:s,captureCtrl:c,preventDefault:h,stopPropagation:p};if(Object(i["isDefined"])(y)){var b=[y,v];g.relativeToGroup=b[0],g.position=b[1]}n.forEach((function(e){var n=Yf(e),r=t.hasItem(n);if(r){var o=t.getItem(n),i=o.findIndex((function(e){return e.group===y}));-1!==i?"before"===v?i-=1:i+=1:i=o.length,o.splice(i,0,g)}else t.addItem(n,[g])}))},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){Object(u["objectEach"])(t,(function(n,r){!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),n(e)}))},a=function(e){var n=Yf(e);t.removeItem(n)},l=function(e){var n=t.getItems();n.forEach((function(t){var n=Zf(t,2),r=n[0],o=n[1],i=o.filter((function(t){return t.group!==e}));0===i.length?a(Xf(r)):(o.length=0,o.push.apply(o,$f(i)))}))},s=function(e){var n=Yf(e),r=t.getItem(n);return Object(i["isDefined"])(r)?r.slice():[]},c=function(e){var n=Yf(e);return t.hasItem(n)};return{addShortcut:n,addShortcuts:r,getShortcuts:s,hasShortcut:c,removeShortcutsByKeys:a,removeShortcutsByGroup:l}};function lh(){var e=new Set;return{press:function(t){e.add(t)},release:function(t){e.delete(t)},releaseAll:function(){e.clear()},isPressed:function(t){return e.has(t)}}}var sh=["meta","alt","shift","control"],uh=lh();function ch(e,t,n,r,o){var i=function(e){return sh.includes(e)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},s=function(e){if(!1!==t(e)){var s=n(e);if(!1!==s&&!Object(g["isImmediatePropagationStopped"])(e)){var u=Kf(e.key),c=[];i(u)?uh.press(u):c=l(e);var f=[u].concat(c),h=o(e,f);!h&&(Object(a["isMacOS"])()&&c.includes("meta")||!Object(a["isMacOS"])()&&c.includes("control"))&&o(e,[u].concat(l(e,!0))),r(e)}}},u=function(e){if(!1!==t(e)){var n=Kf(e.key);!1!==i(n)&&uh.release(n)}},c=function(){uh.releaseAll()},f=function(){var t=e;while(t)t.addEventListener("keydown",s),t.addEventListener("keyup",u),t.addEventListener("blur",c),t=t.frameElement},h=function(){var t=e;while(t)t.removeEventListener("keydown",s),t.removeEventListener("keyup",u),t.removeEventListener("blur",c),t=t.frameElement};return{mount:f,unmount:h,isPressed:function(e){return uh.isPressed(e)}}}var fh=function(e){var t=e.ownerWindow,n=e.handleEvent,r=e.beforeKeyDown,o=e.afterKeyDown,i=Object(zf["a"])({errorIdExists:function(e){return'The "'.concat(e,'" context name is already registered.')}}),a="grid",l=function(e){var t=ah(e);return i.addItem(e,t),t},s=function(){return a},u=function(e){return i.getItem(e)},c=function(e){a=e},f=!1,h=ch(t,n,r,o,(function(e,t){var n=u(s()),r=!1;if(!n.hasShortcut(t))return r;for(var o=n.getShortcuts(t),i=0;i<o.length;i++){var a=o[i],l=a.callback,c=a.runOnlyIf,h=a.preventDefault,d=a.stopPropagation,p=a.captureCtrl;if(!1!==c(e)&&(f=p,r=!1===l(e,t),f=!1,h&&e.preventDefault(),d&&e.stopPropagation(),r))break}return r}));return h.mount(),{addContext:l,getActiveContextName:s,getContext:u,setActiveContextName:c,isCtrlPressed:function(){return!f&&(h.isPressed("control")||h.isPressed("meta"))},destroy:function(){return h.unmount()}}};function hh(e){return hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hh(e)}function dh(e,t){return vh(e)||yh(e,t)||mh(e,t)||ph()}function ph(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yh(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function vh(e){if(Array.isArray(e))return e}function gh(e){return Oh(e)||wh(e)||mh(e)||bh()}function bh(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mh(e,t){if(e){if("string"===typeof e)return Ch(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ch(e,t):void 0}}function wh(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Oh(e){if(Array.isArray(e))return Ch(e)}function Ch(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Sh="gridDefault",Rh=null;function kh(e,t){var n,g,b,m,w,O=this,C=arguments.length>2&&void 0!==arguments[2]&&arguments[2],S=!1,R=this,k=new s["a"](R),E=!0;Object(_a["a"])(C)&&Object(_a["c"])(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var j=null!==(n=null===t||void 0===t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",T=["rtl","ltr"].includes(j)?j:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),this.isRtl=function(){return"rtl"===T},this.isLtr=function(){return!R.isRtl()},this.getDirectionFactor=function(){return R.isLtr()?1:-1},t.language=Object(ps["e"])(t.language);var P=new Rf(R,t,[Tf,If]),M=P.getTableMeta(),A=P.getGlobalMeta(),I=Object(zf["a"])();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Object(_a["b"])(this)&&Object(i["_injectProductInfo"])(t.licenseKey,e),this.guid="ht_".concat(Object(y["randomString"])()),this.columnIndexMapper=new hs,this.rowIndexMapper=new hs,b=new tl(R),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var _=function(e){var t=e.row,n=e.col;return R._createCellCoords(t>=0?R.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?R.columnIndexMapper.getRenderableFromVisualIndex(n):n)},x=function(e){var t=e.row,n=e.col;return R._createCellCoords(t>=0?R.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?R.columnIndexMapper.getVisualFromRenderableIndex(n):n)},H=new Lc(M,{rowIndexMapper:function(){return R.rowIndexMapper},columnIndexMapper:function(){return R.columnIndexMapper},countCols:function(){return R.countCols()},countRows:function(){return R.countRows()},propToCol:function(e){return g.propToCol(e)},isEditorOpened:function(){return!!R.getActiveEditor()&&R.getActiveEditor().isOpened()},countColsTranslated:function(){return O.view.countRenderableColumns()},countRowsTranslated:function(){return O.view.countRenderableRows()},getShortcutManager:function(){return R.getShortcutManager()},createCellCoords:function(e,t){return R._createCellCoords(e,t)},createCellRange:function(e,t,n){return R._createCellRange(e,t,n)},visualToRenderableCoords:_,renderableToVisualCoords:x,isDisabledCellSelection:function(e,t){return R.getCellMeta(e,t).disableVisualSelection}});this.selection=H;var N=function(e){var t=e.hiddenIndexesChanged;t&&O.selection.refresh()};function D(e){var t=Object(ys["b"])(e);Object(ps["f"])(t)?(R.runHooks("beforeLanguageChange",t),A.language=t,R.runHooks("afterLanguageChange",t)):Object(ys["c"])(e)}function L(e,t){var n="className"===e?R.rootElement:R.table;if(E)Object(r["addClass"])(n,t);else{var o=[],i=[];A[e]&&(o=Array.isArray(A[e])?A[e]:Object(c["stringToArray"])(A[e])),t&&(i=Array.isArray(t)?t:Object(c["stringToArray"])(t));var a=Object(c["getDifferenceOfArrays"])(o,i),l=Object(c["getDifferenceOfArrays"])(i,o);a.length&&Object(r["removeClass"])(n,a),l.length&&Object(r["addClass"])(n,l)}A[e]=t}function B(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function V(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function F(e,t,n){if(e.length){var o=R.getActiveEditor(),i=R.runHooks("beforeChange",e,t||"edit"),a=!0;if(!1!==i){var l=new B;l.onQueueEmpty=function(e){o&&a&&o.cancelChanges(),n(e)};for(var s=e.length-1;s>=0;s--)if(null===e[s])e.splice(s,1);else{var u=dh(e[s],4),c=u[0],f=u[1],h=u[3],d=g.propToCol(f),p=R.getCellMeta(c,d);"numeric"===p.type&&"string"===typeof h&&Object(v["isNumericLike"])(h)&&(e[s][3]=V(h)),R.getCellValidator(p)&&(l.addValidatorToQueue(),R.validateCell(e[s][3],p,function(t,n){return function(o){if("boolean"!==typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){a=!1,e.splice(t,1),n.valid=!0;var i=R.getCell(n.visualRow,n.visualCol);null!==i&&Object(r["removeClass"])(i,M.invalidCellClassName)}l.removeValidatorFormQueue()}}(s,p),t))}l.checkIfQueueIsEmpty()}else o&&o.cancelChanges()}}function W(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var r=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(M.allowInsertRow)while(e[n][0]>R.countRows()-1){var o=g.createRow(void 0,void 0,t);if(!(o>=1)){r=!0;break}P.createRow(null,o)}if("array"===R.dataType&&(!M.columns||0===M.columns.length)&&M.allowInsertColumn)while(g.propToCol(e[n][1])>R.countCols()-1){var a=g.createCol(void 0,void 0,t);if(!(a>=1)){r=!0;break}P.createColumn(null,a)}r||g.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}R.forceFullRender=!0,m.adjustRowsAndCols(),R.runHooks("beforeChangeRender",e,t),w.lockEditor(),R._refreshBorders(null),w.unlockEditor(),R.view.adjustElementsSize(),R.runHooks("afterChange",e,t||"edit");var l=R.getActiveEditor();l&&Object(i["isDefined"])(l.refreshValue)&&l.refreshValue()}}function U(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",N),this.rowIndexMapper.addLocalHook("cacheUpdated",N),this.selection.addLocalHook("beforeSetRangeStart",(function(e){O.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){O.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){O.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=O.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=O.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=Object(u["createObjectPropListener"])(!1),n=O.selection.getSelectedRange(),o=n.current(),i=o.from,a=o.to,l=n.size()-1;O.runHooks("afterSelection",i.row,i.col,a.row,a.col,t,l),O.runHooks("afterSelectionByProp",i.row,R.colToProp(i.col),a.row,R.colToProp(a.col),t,l);var s=O.selection.isSelectedByAnyHeader(),c=O.selection.selectedRange.current(),f=!0;S&&(f=!1),t.isTouched()&&(f=!t.value);var h=O.selection.isSelectedByRowHeader(),d=O.selection.isSelectedByColumnHeader();!1!==f&&(s?h?O.view.scrollViewportVertically(R.rowIndexMapper.getRenderableFromVisualIndex(e.row)):d&&O.view.scrollViewportHorizontally(R.columnIndexMapper.getRenderableFromVisualIndex(e.col)):c&&!O.selection.isMultiple()?O.view.scrollViewport(_(c.from)):O.view.scrollViewport(_(e))),h&&d?Object(r["addClass"])(O.rootElement,["ht__selection--rows","ht__selection--columns"]):h?(Object(r["removeClass"])(O.rootElement,"ht__selection--columns"),Object(r["addClass"])(O.rootElement,"ht__selection--rows")):d?(Object(r["removeClass"])(O.rootElement,"ht__selection--rows"),Object(r["addClass"])(O.rootElement,"ht__selection--columns")):Object(r["removeClass"])(O.rootElement,["ht__selection--rows","ht__selection--columns"]),O._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,o=n.to;O.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),O.runHooks("afterSelectionEndByProp",r.row,R.colToProp(r.col),o.row,R.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=O.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){O.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){O.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){O.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){O.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){w.destroyEditor(),O._refreshBorders(),Object(r["removeClass"])(O.rootElement,["ht__selection--rows","ht__selection--columns"]),O.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){O.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){O.alter("insert_col",e,1,"auto")})),m={alter:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,l=function(e){if(0===e.length)return[];var t=gh(e);t.sort((function(e,t){var n=dh(e,1),r=n[0],o=dh(t,1),i=o[0];return r===i?0:r>i?1:-1}));var n=Object(c["arrayReduce"])(t,(function(e,t){var n=dh(t,2),r=n[0],o=n[1],i=e[e.length-1],a=dh(i,2),l=a[0],s=a[1],u=l+s;if(r<=u){var c=Math.max(o-(u-r),0);i[1]+=c}else e.push([r,o]);return e}),[t[0]]);return n};switch(e){case"insert_row":var s=R.countSourceRows();if(M.maxRows===s)return;if(t=Object(i["isDefined"])(t)?t:s,n=g.createRow(t,r,o),n){P.createRow(R.toPhysicalRow(t),r);var u=H.selectedRange.current(),f=null===u||void 0===u?void 0:u.from,h=null===f||void 0===f?void 0:f.row;if(Object(i["isDefined"])(h)&&h>=t){var d=u.to,p=d.row,y=d.col,v=f.col;H.isSelectedByRowHeader()&&(v=-1),H.getSelectedRange().pop(),H.setRangeStartOnly(R._createCellCoords(h+n,v),!0),H.setRangeEnd(R._createCellCoords(p+n,y))}else R._refreshBorders()}break;case"insert_col":if(n=g.createCol(t,r,o),n){if(P.createColumn(R.toPhysicalColumn(t),r),Array.isArray(M.colHeaders)){var b=[t,0];b.length+=n,Array.prototype.splice.apply(M.colHeaders,b)}var w=H.selectedRange.current(),O=null===w||void 0===w?void 0:w.from,C=null===O||void 0===O?void 0:O.col;if(Object(i["isDefined"])(C)&&C>=t){var S=w.to,k=S.row,E=S.col,j=O.row;H.isSelectedByColumnHeader()&&(j=-1),H.getSelectedRange().pop(),H.setRangeStartOnly(R._createCellCoords(j,C+n),!0),H.setRangeEnd(R._createCellCoords(k,E+n))}else R._refreshBorders()}break;case"remove_row":var T=function(e){var t=0;Object(c["arrayEach"])(e,(function(e){var n=dh(e,2),r=n[0],a=n[1],l=Object(i["isEmpty"])(r)?R.countRows()-1:Math.max(r-t,0);Number.isInteger(r)&&(r=Math.max(r-t,0));var s=g.removeRow(r,a,o);if(s){P.removeRow(R.toPhysicalRow(l),a);var u=R.countRows(),c=M.fixedRowsTop;c>=l+1&&(M.fixedRowsTop-=Math.min(a,c-l));var f=M.fixedRowsBottom;f&&l>=u-f&&(M.fixedRowsBottom-=Math.min(a,f)),t+=a}}))};Array.isArray(t)?T(l(t)):T([[t,r]]),m.adjustRowsAndCols(),R._refreshBorders();break;case"remove_col":var A=function(e){var t=0;Object(c["arrayEach"])(e,(function(e){var n=dh(e,2),r=n[0],a=n[1],l=Object(i["isEmpty"])(r)?R.countCols()-1:Math.max(r-t,0),s=R.toPhysicalColumn(l);Number.isInteger(r)&&(r=Math.max(r-t,0));var u=g.removeCol(r,a,o);if(u){P.removeColumn(s,a);var c=M.fixedColumnsStart;c>=l+1&&(M.fixedColumnsStart-=Math.min(a,c-l)),Array.isArray(M.colHeaders)&&("undefined"===typeof s&&(s=-1),M.colHeaders.splice(s,a)),t+=a}}))};Array.isArray(t)?A(l(t)):A([[t,r]]),m.adjustRowsAndCols(),R._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}a||m.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=M.minRows,n=M.minSpareRows,r=M.minCols,o=M.minSpareCols;if(t){var i=R.countRows();i<t&&g.createRow(i,t-i,"auto")}if(n){var a=R.countEmptyRows(!0);if(a<n){var l=n-a,s=Math.min(l,M.maxRows-R.countSourceRows());g.createRow(R.countRows(),s,"auto")}}(r||o)&&(e=R.countEmptyCols(!0));var u=R.countCols();if(r&&!M.columns&&u<r){var f=r-u;e+=f,g.createCol(u,f,"auto")}if(o&&!M.columns&&"array"===R.dataType&&e<o){u=R.countCols();var h=o-e,d=Math.min(h,M.maxCols-u);g.createCol(u,d,"auto")}var p=R.countRows(),y=R.countCols();0!==p&&0!==y||H.deselect(),H.isSelected()&&Object(c["arrayEach"])(H.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,o=e.to.row,i=e.to.col;n>p-1?(n=p-1,t=!0,o>n&&(o=n)):o>p-1&&(o=p-1,t=!0,n>o&&(n=o)),r>y-1?(r=y-1,t=!0,i>r&&(i=r)):i>y-1&&(i=y-1,t=!0,r>i&&(r=i)),t&&R.selectCell(n,r,o,i)})),R.view&&R.view.adjustElementsSize()},populateFromArray:function(e,t,n,r,o,a,l){var s,f,h,d,p=[],y={},v=[],g=e.row,b=e.col;if(f=t.length,0===f)return!1;var m=0,w=0;switch(Object(u["isObject"])(n)&&(m=n.col-b+1,w=n.row-g+1),o){case"shift_down":var O=Object(c["pivot"])(t),C=O.length,S=Math.max(C,m),k=R.getData().slice(g),E=Object(c["pivot"])(k).slice(b,b+S);for(h=0;h<S;h+=1)if(h<C){for(s=0,f=O[h].length;s<w-f;s+=1)O[h].push(O[h][s%f]);h<E.length?v.push(O[h].concat(E[h])):v.push(O[h].concat(new Array(k.length).fill(null)))}else v.push(O[h%C].concat(E[h]));R.populateFromArray(g,b,Object(c["pivot"])(v));break;case"shift_right":var j=t.length,T=Math.max(j,w),P=R.getData().slice(g).map((function(e){return e.slice(b)}));for(s=0;s<T;s+=1)if(s<j){for(h=0,d=t[s].length;h<m-d;h+=1)t[s].push(t[s][h%d]);var A;if(s<P.length)for(var I=0;I<P[s].length;I+=1)t[s].push(P[s][I]);else(A=t[s]).push.apply(A,gh(new Array(P[0].length).fill(null)))}else t.push(t[s%f].slice(0,T).concat(P[s]));R.populateFromArray(g,b,t);break;case"overwrite":default:y.row=e.row,y.col=e.col;var _,x={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},H=0,N=0,D=!0,L=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},B=t.length,V=n?n.row-e.row+1:0;for(f=n?V:Math.max(B,V),s=0;s<f;s++){if(n&&y.row>n.row&&V>B||!M.allowInsertRow&&y.row>R.countRows()-1||y.row>=M.maxRows)break;var F=s-H,W=L(F).length,U=n?n.col-e.col+1:0;if(d=n?U:Math.max(W,U),y.col=e.col,_=R.getCellMeta(y.row,y.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!_.skipRowOnPaste){for(N=0,h=0;h<d;h++){if(n&&y.col>n.col&&U>W||!M.allowInsertColumn&&y.col>R.countCols()-1||y.col>=M.maxCols)break;if(_=R.getCellMeta(y.row,y.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!_.skipColumnOnPaste)if(_.readOnly&&"UndoRedo.undo"!==r)y.col+=1;else{var z=h-N,G=L(F,z),Y=R.getDataAtCell(y.row,y.col),X={row:F,col:z};if("Autofill.fill"===r){var K=R.runHooks("beforeAutofillInsidePopulate",X,a,t,l,{},x);K&&(G=Object(i["isUndefined"])(K.value)?G:K.value)}if(null!==G&&"object"===hh(G))if(Array.isArray(G)&&null===Y&&(Y=[]),null===Y||"object"!==hh(Y))D=!1;else{var $=Object(u["duckSchema"])(Array.isArray(Y)?Y:Y[0]||Y),q=Object(u["duckSchema"])(Array.isArray(G)?G:G[0]||G);Object(u["isObjectEqual"])($,q)?G=Object(u["deepClone"])(G):D=!1}else null!==Y&&"object"===hh(Y)&&(D=!1);D&&p.push([y.row,y.col,G]),D=!0,y.col+=1}else N+=1,y.col+=1,d+=1}y.row+=1}else H+=1,y.row+=1,f+=1}R.setDataAtCell(p,null,null,r||"populateFromArray");break}}},this.init=function(){b.setData(M.data),R.runHooks("beforeInit"),(Object(a["isMobileBrowser"])()||Object(a["isIpadOS"])())&&Object(r["addClass"])(R.rootElement,"mobile"),this.updateSettings(M,!0),this.view=new $a(this),w=l["c"].getInstance(R,M,H),R.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===hh(E)&&(R.runHooks("afterChange",E[0],E[1]),E=!1),R.runHooks("afterInit")},this._createCellCoords=function(e,t){return R.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return R.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){var a=R.getCellValidator(t);function l(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==t.hidden){var o=t.visualCol,i=t.visualRow,a=R.getCell(i,o,!0);if(a&&"TH"!==a.nodeName){var l=R.rowIndexMapper.getRenderableFromVisualIndex(i),s=R.columnIndexMapper.getRenderableFromVisualIndex(o);R.view._wt.getSetting("cellRenderer",l,s,a)}n(e)}else n(e)}Object(i["isRegExp"])(a)&&(a=function(e){return function(t,n){n(e.test(t))}}(a)),Object(o["isFunction"])(a)?(e=R.runHooks("beforeValidate",e,t.visualRow,t.prop,r),R._registerImmediate((function(){a.call(t,e,(function(n){R&&(n=R.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,l(n),R.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):R._registerImmediate((function(){t.valid=!0,l(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,r){var o,i,a,l=U(e,t,n),s=[],u=r;for(o=0,i=l.length;o<i;o++){if("object"!==hh(l[o]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof l[o][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");a=l[o][1]>=this.countCols()?l[o][1]:g.colToProp(l[o][1]),s.push([l[o][0],a,b.getAtCell(this.toPhysicalRow(l[o][0]),l[o][1]),l[o][2]])}u||"object"!==hh(e)||(u=t),R.runHooks("afterSetDataAtCell",s,u),F(s,u,(function(){W(s,u)}))},this.setDataAtRowProp=function(e,t,n,r){var o,i,a=U(e,t,n),l=[],s=r;for(o=0,i=a.length;o<i;o++)l.push([a[o][0],a[o][1],b.getAtCell(this.toPhysicalRow(a[o][0]),a[o][1]),a[o][2]]);s||"object"!==hh(e)||(s=t),R.runHooks("afterSetDataAtRowProp",l,s),F(l,s,(function(){W(l,s)}))},this.listen=function(){R&&!R.isListening()&&(Rh=R.guid,R.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Rh=null,R.runHooks("afterUnlisten"))},this.isListening=function(){return Rh===R.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];R._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,r,o,i,a,l,s){if("object"!==hh(n)||"object"!==hh(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var u="number"===typeof r?R._createCellCoords(r,o):null;return m.populateFromArray(R._createCellCoords(e,t),n,u,i,a,l,s)},this.spliceCol=function(e,t,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=g).spliceCol.apply(r,[e,t,n].concat(i))},this.spliceRow=function(e,t,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=g).spliceRow.apply(r,[e,t,n].concat(i))},this.getSelected=function(){if(H.isSelected())return Object(c["arrayMap"])(H.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(H.isSelected())return Array.from(H.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(H.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var n=[];Object(c["arrayEach"])(H.getSelectedRange(),(function(e){var r=e.getTopStartCorner(),o=e.getBottomEndCorner();Object(v["rangeEach"])(r.row,o.row,(function(e){Object(v["rangeEach"])(r.col,o.col,(function(r){t.getCellMeta(e,r).readOnly||n.push([e,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,e)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(w.lockEditor(),this._refreshBorders(null),w.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(R.view){var e=R.view.getLastSize(),t=e.width,n=e.height,r=R.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==t||i!==n,l=!1===R.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:o,height:i},a);l||((a||R.view._wt.wtOverlays.scrollableElement===R.rootWindow)&&(R.view.setLastSize(o,i),R.render()),R.runHooks("afterRefreshDimensions",{width:t,height:n},{width:o,height:i},a))}},this.updateData=function(e,t){var n=this;Wf(e,(function(e){g=e}),(function(e){g=e,R.columnIndexMapper.fitToLength(n.getInitialColumnCount()),R.rowIndexMapper.fitToLength(n.countSourceRows()),m.adjustRowsAndCols()}),{hotInstance:R,dataMap:g,dataSource:b,internalSource:"updateData",source:t,firstRun:E})},this.loadData=function(e,t){Wf(e,(function(e){g=e}),(function(){P.clearCellsCache(),R.initIndexMappers(),m.adjustRowsAndCols(),E&&(E=[null,"loadData"])}),{hotInstance:R,dataMap:g,dataSource:b,internalSource:"loadData",source:t,firstRun:E})},this.getInitialColumnCount=function(){var e=M.columns,t=0;if(Array.isArray(e))t=e.length;else if(Object(o["isFunction"])(e))if("array"===R.dataType)for(var n=this.countSourceCols(),r=0;r<n;r+=1)e(r)&&(t+=1);else"object"!==R.dataType&&"function"!==R.dataType||(t=g.colToPropCache.length);else if(Object(i["isDefined"])(M.dataSchema)){var a=g.getSchema();t=Array.isArray(a)?a.length:Object(u["deepObjectSize"])(a)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return Object(i["isUndefined"])(e)?g.getAll():g.getRange(R._createCellCoords(e,t),R._createCellCoords(n,r),g.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return g.getCopyableText(R._createCellCoords(e,t),R._createCellCoords(n,r))},this.getCopyableData=function(e,t){return g.getCopyable(e,g.colToProp(t))},this.getSchema=function(){return g.getSchema()},this.updateSettings=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(E?R.loadData:R.updateData).bind(this),l=!1;if(Object(i["isDefined"])(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Object(i["isDefined"])(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Object(i["isDefined"])(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?D(e.language):"className"===t?L("className",e.className):"tableClassName"===t&&R.table?(L("tableClassName",e.tableClassName),R.view._wt.wtOverlays.syncOverlayTableClassNames()):ds["a"].getSingleton().isRegistered(t)||ds["a"].getSingleton().isDeprecated(t)?(Object(o["isFunction"])(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,R.addHook(t,e[t])):!r&&Object(u["hasOwnProperty"])(e,t)&&(A[t]=e[t]));void 0===e.data&&void 0===M.data?a(null,"updateSettings"):void 0!==e.data?a(e.data,"updateSettings"):void 0!==e.columns&&(g.createMap(),R.initIndexMappers());var s=R.countCols(),c=M.columns;if(c&&Object(o["isFunction"])(c)&&(l=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||P.clearCache(),s>0)for(t=0,n=0;t<s;t++){if(c){var f=l?c(t):c[n];f&&P.updateColumnMeta(n,f)}n+=1}Object(i["isDefined"])(e.cell)&&Object(u["objectEach"])(e.cell,(function(e){R.setCellMetaObject(e.row,e.col,e)})),R.runHooks("afterCellMetaReset");var h=R.rootElement.style.height;""!==h&&(h=parseInt(R.rootElement.style.height,10));var d=e.height;if(Object(o["isFunction"])(d)&&(d=d()),r){var p=R.rootElement.getAttribute("style");p&&R.rootElement.setAttribute("data-initialstyle",R.rootElement.getAttribute("style"))}if(null===d){var y=R.rootElement.getAttribute("data-initialstyle");y&&(y.indexOf("height")>-1||y.indexOf("overflow")>-1)?R.rootElement.setAttribute("style",y):(R.rootElement.style.height="",R.rootElement.style.overflow="")}else void 0!==d&&(R.rootElement.style.height=isNaN(d)?"".concat(d):"".concat(d,"px"),R.rootElement.style.overflow="hidden");if("undefined"!==typeof e.width){var v=e.width;Object(o["isFunction"])(v)&&(v=v()),R.rootElement.style.width=isNaN(v)?"".concat(v):"".concat(v,"px")}r||(R.view&&(R.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),R.view._wt.exportSettingsAsClassNames()),R.runHooks("afterUpdateSettings",e)),m.adjustRowsAndCols(),R.view&&!E&&(R.forceFullRender=!0,w.lockEditor(),R._refreshBorders(null),R.view._wt.wtOverlays.adjustElementsSize(),w.unlockEditor()),r||!R.view||""!==h&&""!==d&&void 0!==d||h===d||R.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=R.getSelectedLast();if(M.getValue){if(Object(o["isFunction"])(M.getValue))return M.getValue.call(R);if(e)return R.getData()[e[0][0]][M.getValue]}else if(e)return R.getDataAtCell(e[0],e[1])},this.getSettings=function(){return M},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,o){m.alter(e,t,n,r,o)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===r?null:R.view.getCellAtCoords(R._createCellCoords(o,r),n)},this.getCoords=function(e){var t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;var n=t.row,r=t.col,o=n,i=r;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),R._createCellCoords(o,i)},this.colToProp=function(e){return g.colToProp(e)},this.propToCol=function(e){return g.propToCol(e)},this.toVisualRow=function(e){return O.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return O.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return O.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return O.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return g.get(e,g.colToProp(t))},this.getDataAtRowProp=function(e,t){return g.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,gh(g.getRange(R._createCellCoords(0,e),R._createCellCoords(M.data.length-1,e),g.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=g.getRange(R._createCellCoords(0,g.propToCol(e)),R._createCellCoords(M.data.length-1,g.propToCol(e)),g.DESTINATION_RENDERER);return(t=[]).concat.apply(t,gh(n))},this.getSourceData=function(e,t,n,r){var o;return o=void 0===e?b.getData():b.getByRange(R._createCellCoords(e,t),R._createCellCoords(n,r)),o},this.getSourceDataArray=function(e,t,n,r){var o;return o=void 0===e?b.getData(!0):b.getByRange(R._createCellCoords(e,t),R._createCellCoords(n,r),!0),o},this.getSourceDataAtCol=function(e){return b.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){var o=U(e,t,n),a=this.hasHook("afterSetSourceDataAtCell"),l=[];a&&Object(c["arrayEach"])(o,(function(e){var t=dh(e,3),n=t[0],r=t[1],o=t[2];l.push([n,r,b.getAtCell(n,r),o])})),Object(c["arrayEach"])(o,(function(e){var t=dh(e,3),n=t[0],r=t[1],o=t[2];b.setAtCell(n,r,o)})),a&&this.runHooks("afterSetSourceDataAtCell",l,r),this.render();var s=R.getActiveEditor();s&&Object(i["isDefined"])(s.refreshValue)&&s.refreshValue()},this.getSourceDataAtRow=function(e){return b.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return b.getAtCell(e,t)},this.getDataAtRow=function(e){var t=g.getRange(R._createCellCoords(e,0),R._createCellCoords(e,this.countCols()-1),g.DESTINATION_RENDERER);return t[0]||[]},this.getDataType=function(e,t,n,r){var o=this,i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],a=i[0],l=i[1],s=i[2],u=i[3],c=null,f=null;void 0===s&&(s=a),void 0===u&&(u=l);var h="mixed";return Object(v["rangeEach"])(Math.max(Math.min(a,s),0),Math.max(a,s),(function(e){var t=!0;return Object(v["rangeEach"])(Math.max(Math.min(l,u),0),Math.max(l,u),(function(n){var r=o.getCellMeta(e,n);return f=r.type,c?t=c===f:c=f,t})),h=t?f:"mixed",t})),h},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=r[0],i=r[1],a=P.getCellMetaKeyValue(o,i,n),l=R.runHooks("beforeRemoveCellMeta",e,t,n,a);!1!==l&&(P.removeCellMeta(o,i,n),R.runHooks("afterRemoveCellMeta",e,t,n,a)),a=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&P.removeRow(this.toPhysicalRow(e),n),o.length>0&&Object(c["arrayEach"])(o.reverse(),(function(n){P.createRow(t.toPhysicalRow(e)),Object(c["arrayEach"])(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))})),R.render()},this.setCellMetaObject=function(e,t,n){var r=this;"object"===hh(n)&&Object(u["objectEach"])(n,(function(n,o){r.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,r){var o=R.runHooks("beforeSetCellMeta",e,t,n,r);if(!1!==o){var i=e,a=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(a=this.toPhysicalColumn(t)),P.setCellMeta(i,a,n,r),R.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return P.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),P.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return P.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===R.dataType||M.columns)};var z=Object(qa["cellMethodLookupFactory"])("renderer");this.getCellRenderer=function(e,t){return Object(d["b"])(z.call(this,e,t))},this.getCellEditor=Object(qa["cellMethodLookupFactory"])("editor");var G=Object(qa["cellMethodLookupFactory"])("validator");this.getCellValidator=function(e,t){var n=G.call(this,e,t);return"string"===typeof n&&(n=Object(p["b"])(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new B;e&&(r.onQueueEmpty=e);var o=R.countRows()-1;while(o>=0)if(void 0===t||-1!==t.indexOf(o)){var i=R.countCols()-1;while(i>=0)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),R.validateCell(R.getDataAtCell(o,i),R.getCellMeta(o,i),(function(e){if("boolean"!==typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=M.rowHeaders,n=e;return void 0!==n&&(n=R.runHooks("modifyRowHeader",n)),void 0===n?(t=[],Object(v["rangeEach"])(R.countRows()-1,(function(e){t.push(R.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:Object(o["isFunction"])(t)?t=t(n):t&&"string"!==typeof t&&"number"!==typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!M.rowHeaders},this.hasColHeaders=function(){if(void 0!==M.colHeaders&&null!==M.colHeaders)return!!M.colHeaders;for(var e=0,t=R.countCols();e<t;e++)if(R.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=R.runHooks("modifyColHeader",e),n=M.colHeaders;if(void 0===t){for(var r=[],i=R.countCols(),a=0;a<i;a++)r.push(R.getColHeader(a));n=r}else{var l=function(e){for(var t=[],n=R.countCols(),r=0;r<n;r++)Object(o["isFunction"])(M.columns)&&M.columns(r)&&t.push(r);return t[e]},s=R.toPhysicalColumn(t),u=l(s);!1===M.colHeaders?n=null:M.columns&&Object(o["isFunction"])(M.columns)&&M.columns(u)&&M.columns(u).title?n=M.columns(u).title:M.columns&&M.columns[s]&&M.columns[s].title?n=M.columns[s].title:Array.isArray(M.colHeaders)&&void 0!==M.colHeaders[s]?n=M.colHeaders[s]:Object(o["isFunction"])(M.colHeaders)?n=M.colHeaders(s):M.colHeaders&&"string"!==typeof M.colHeaders&&"number"!==typeof M.colHeaders&&(n=Object(qa["spreadsheetColumnLabel"])(t))}return n},this._getColWidthFromSettings=function(e){var t;if(e>=0){var n=R.getCellMeta(0,e);t=n.width}if(void 0!==t&&t!==M.width||(t=M.colWidths),void 0!==t&&null!==t){switch(hh(t)){case"object":t=t[e];break;case"function":t=t(e);break;default:break}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=R._getColWidthFromSettings(e);return t=R.runHooks("modifyColWidth",t,e),void 0===t&&(t=la["a"].DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=M.rowHeights;if(void 0!==t&&null!==t){switch(hh(t)){case"object":t=t[e];break;case"function":t=t(e);break;default:break}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=R._getRowHeightFromSettings(e);return t=R.runHooks("modifyRowHeight",t,e),t},this.countSourceRows=function(){return b.countRows()},this.countSourceCols=function(){return b.countFirstRowKeys()},this.countRows=function(){return g.getLength()},this.countCols=function(){var e=M.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return R.view._wt.drawn?R.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return R.view._wt.drawn?R.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return R.view._wt.drawn?R.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return R.view._wt.drawn?R.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Object(v["rangeEachReverse"])(R.countRows()-1,(function(n){if(R.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(R.countRows()<1)return 0;var t=0;return Object(v["rangeEachReverse"])(R.countCols()-1,(function(n){if(R.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return M.isEmptyRow.call(R,e)},this.isEmptyCol=function(e){return M.isEmptyCol.call(R,e)},this.selectCell=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(i["isUndefined"])(e)&&!Object(i["isUndefined"])(t)&&this.selectCells([[e,t,n,r]],o,a)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(S=!0);var r=H.selectCells(e);return r&&n&&R.listen(),S=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return H.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return H.selectRows(e,t)},this.deselectCell=function(){H.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();S=!0,H.selectAll(t,n),S=!1};var Y=function(e,t){return e.getNearestNotHiddenIndex(t,1,!0)};function X(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!n,a=!r,l=e,s=t;if(o){var u=Number.isInteger(e),c=Number.isInteger(t),f=u?Y(this.rowIndexMapper,e):void 0,h=c?Y(this.columnIndexMapper,t):void 0;if(null===f||null===h)return!1;l=u?R.rowIndexMapper.getRenderableFromVisualIndex(f):void 0,s=c?R.columnIndexMapper.getRenderableFromVisualIndex(h):void 0}var d=Number.isInteger(l),p=Number.isInteger(s);return d&&p?R.view.scrollViewport(R._createCellCoords(l,s),i,r,n,a):d&&!1===p?R.view.scrollViewportVertically(l,i,n):!(!p||!1!==d)&&R.view.scrollViewportHorizontally(s,r,a)},this.destroy=function(){if(R._clearTimeouts(),R._clearImmediates(),R.view&&R.view.destroy(),b&&b.destroy(),b=null,this.getShortcutManager().destroy(),P.clearCache(),Object(_a["b"])(R)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}Object(r["empty"])(R.rootElement),k.destroy(),w&&w.destroy(),R.batchExecution((function(){R.rowIndexMapper.unregisterAll(),R.columnIndexMapper.unregisterAll(),I.getItems().forEach((function(e){var t=dh(e,2),n=t[1];n.destroy()})),I.clear(),R.runHooks("afterDestroy")}),!0),ds["a"].getSingleton().destroy(R),Object(u["objectEach"])(R,(function(e,t,n){Object(o["isFunction"])(e)?n[t]=X(t):"guid"!==t&&(n[t]=null)})),R.isDestroyed=!0,g&&g.destroy(),R.rowIndexMapper=null,R.columnIndexMapper=null,g=null,m=null,H=null,w=null,R=null},this.getActiveEditor=function(){return w.getActiveEditor()},this.getPlugin=function(e){var t=Object(y["toUpperCaseFirst"])(e);return"UndoRedo"===t?this.undoRedo:I.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(e)},this.getInstance=function(){return R},this.addHook=function(e,t){ds["a"].getSingleton().add(e,t,R)},this.hasHook=function(e){return ds["a"].getSingleton().has(e,R)||ds["a"].getSingleton().has(e)},this.addHookOnce=function(e,t){ds["a"].getSingleton().once(e,t,R)},this.removeHook=function(e,t){ds["a"].getSingleton().remove(e,t,R)},this.runHooks=function(e,t,n,r,o,i,a){return ds["a"].getSingleton().run(R,e,t,n,r,o,i,a)},this.getTranslatedPhrase=function(e,t){return Object(ps["d"])(M.language,e,t)},this.toHTML=function(){return Object(f["instanceToHTML"])(O)},this.toTableElement=function(){var e=O.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Object(f["instanceToHTML"])(O)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"===typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){Object(c["arrayEach"])(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Object(c["arrayEach"])(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];w.destroyEditor(e),R.view.render(),t&&H.isSelected()&&w.prepareEditor()},this.isRtl=function(){return"rtl"===R.rootWindow.getComputedStyle(R.rootElement).direction},this.isLtr=function(){return!R.isRtl()},this.getDirectionFactor=function(){return R.isLtr()?1:-1};var K=fh({handleEvent:function(e){var t=R.isListening(),n=void 0!==(null===e||void 0===e?void 0:e.key);return t&&n},beforeKeyDown:function(e){return O.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){O.isDestroyed||R.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return K};var $=K.addContext("grid"),q={runOnlyIf:function(){return Object(i["isDefined"])(R.getSelected())&&R.countRenderedRows()>0&&R.countRenderedCols()>0},group:Sh};K.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){R.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=R.getSelectedRange(),t=e[e.length-1].highlight,n=t.row,r=t.col,o=R.getDataAtCell(n,r),i=new Map,a=0;a<e.length;a++)e[a].forAll((function(e,t){if(e>=0&&t>=0&&(e!==n||t!==r)){var a=R.getCellMeta(e,t),l=a.readOnly;l||i.set("".concat(e,"x").concat(t),[e,t,o])}}));R.setDataAtCell(Array.from(i.values()))},runOnlyIf:function(){return R.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){H.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){H.setRangeStart(R._createCellCoords(R.rowIndexMapper.getNearestNotHiddenIndex(0,1),R.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){H.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=R.getSelectedRangeLast(),t=e.from,n=e.to,r=R.rowIndexMapper.getNearestNotHiddenIndex(0,1);H.setRangeStart(t.clone()),H.setRangeEnd(R._createCellCoords(r,n.col))},runOnlyIf:function(){return!(R.selection.isSelectedByCorner()||R.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){H.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){H.setRangeStart(R._createCellCoords(R.rowIndexMapper.getNearestNotHiddenIndex(R.countRows()-1,-1),R.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){H.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=R.getSelectedRangeLast(),t=e.from,n=e.to,r=R.rowIndexMapper.getNearestNotHiddenIndex(R.countRows()-1,-1);H.setRangeStart(t.clone()),H.setRangeEnd(R._createCellCoords(r,n.col))},runOnlyIf:function(){return!(R.selection.isSelectedByCorner()||R.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){H.transformStart(0,-1*R.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=R.getSelectedRangeLast().highlight.row,n=(e=R.columnIndexMapper).getNearestNotHiddenIndex.apply(e,gh(R.isRtl()?[R.countCols()-1,-1]:[0,1]));H.setRangeStart(R._createCellCoords(t,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){H.transformEnd(0,-1*R.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=R.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=R.columnIndexMapper).getNearestNotHiddenIndex.apply(e,gh(R.isRtl()?[R.countCols()-1,-1]:[0,1]));H.setRangeStart(n.clone()),H.setRangeEnd(R._createCellCoords(r.row,o))},runOnlyIf:function(){return!(R.selection.isSelectedByCorner()||R.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){H.transformStart(0,R.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=R.getSelectedRangeLast().highlight.row,n=(e=R.columnIndexMapper).getNearestNotHiddenIndex.apply(e,gh(R.isRtl()?[0,1]:[R.countCols()-1,-1]));H.setRangeStart(R._createCellCoords(t,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){H.transformEnd(0,R.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=R.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=R.columnIndexMapper).getNearestNotHiddenIndex.apply(e,gh(R.isRtl()?[0,1]:[R.countCols()-1,-1]));H.setRangeStart(n.clone()),H.setRangeEnd(R._createCellCoords(r.row,o))},runOnlyIf:function(){return!(R.selection.isSelectedByCorner()||R.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(R.getSettings().fixedColumnsStart,10),t=R.getSelectedRangeLast().highlight.row,n=R.columnIndexMapper.getNearestNotHiddenIndex(e,1);H.setRangeStart(R._createCellCoords(t,n))},runOnlyIf:function(){return R.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){H.setRangeEnd(R._createCellCoords(H.selectedRange.current().from.row,R.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(R.getSettings().fixedRowsTop,10),t=parseInt(R.getSettings().fixedColumnsStart,10),n=R.rowIndexMapper.getNearestNotHiddenIndex(e,1),r=R.columnIndexMapper.getNearestNotHiddenIndex(t,1);H.setRangeStart(R._createCellCoords(n,r))},runOnlyIf:function(){return R.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){H.setRangeStart(R._createCellCoords(R.getSelectedRangeLast().highlight.row,R.columnIndexMapper.getNearestNotHiddenIndex(R.countCols()-1,-1)))},runOnlyIf:function(){return R.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){H.setRangeEnd(R._createCellCoords(H.selectedRange.current().from.row,R.columnIndexMapper.getNearestNotHiddenIndex(R.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(R.getSettings().fixedRowsBottom,10),t=R.rowIndexMapper.getNearestNotHiddenIndex(R.countRows()-e-1,-1),n=R.columnIndexMapper.getNearestNotHiddenIndex(R.countCols()-1,-1);H.setRangeStart(R._createCellCoords(t,n))},runOnlyIf:function(){return R.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){H.transformStart(-R.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=R.getSelectedRangeLast(),t=e.to,n=Math.max(t.row-R.countVisibleRows(),0),r=R.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==r){var o=R._createCellCoords(r,t.col),i=t.row-R.view.getFirstFullyVisibleRow(),a=Math.max(o.row-i,0);H.setRangeEnd(o),R.scrollViewportTo(a)}}},{keys:[["PageDown"]],callback:function(){H.transformStart(R.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=R.getSelectedRangeLast(),t=e.to,n=Math.min(t.row+R.countVisibleRows(),R.countRows()-1),r=R.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==r){var o=R._createCellCoords(r,t.col),i=t.row-R.view.getFirstFullyVisibleRow(),a=Math.min(o.row-i,R.countRows()-1);H.setRangeEnd(o),R.scrollViewportTo(a)}}},{keys:[["Tab"]],callback:function(e){var t="function"===typeof M.tabMoves?M.tabMoves(e):M.tabMoves;H.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"===typeof M.tabMoves?M.tabMoves(e):M.tabMoves;H.transformStart(-t.row,-t.col)}}],q),Object(h["b"])().forEach((function(e){var t=Object(h["a"])(e);I.addItem(e,new t(O))})),ds["a"].getSingleton().run(R,"construct")}},c89a:function(e,t,n){"use strict";n.r(t),n.d(t,"KEY_CODES",(function(){return i})),n.d(t,"isPrintableChar",(function(){return l})),n.d(t,"isFunctionKey",(function(){return s})),n.d(t,"isCtrlKey",(function(){return u})),n.d(t,"isCtrlMetaKey",(function(){return c})),n.d(t,"isKey",(function(){return f}));n("267c"),n("986e"),n("2931"),n("b503");var r=n("d1f5"),o=n("304f"),i={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Object(o["isFirefox"])()?182:174,AUDIO_MUTE:Object(o["isFirefox"])()?181:173,AUDIO_UP:Object(o["isFirefox"])()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},a=[i.ALT,i.ARROW_DOWN,i.ARROW_LEFT,i.ARROW_RIGHT,i.ARROW_UP,i.AUDIO_DOWN,i.AUDIO_MUTE,i.AUDIO_UP,i.BACKSPACE,i.CAPS_LOCK,i.DELETE,i.END,i.ENTER,i.ESCAPE,i.F1,i.F2,i.F3,i.F4,i.F5,i.F6,i.F7,i.F8,i.F9,i.F10,i.F11,i.F12,i.F13,i.F14,i.F15,i.F16,i.F17,i.F18,i.F19,i.HOME,i.INSERT,i.MEDIA_NEXT,i.MEDIA_PLAY_PAUSE,i.MEDIA_PREV,i.MEDIA_STOP,i.NULL,i.NUM_LOCK,i.PAGE_DOWN,i.PAGE_UP,i.PAUSE,i.SCROLL_LOCK,i.SHIFT,i.TAB];function l(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function s(e){return a.includes(e)}function u(e){var t=[];return Object(o["isMacOS"])()?t.push(i.COMMAND_LEFT,i.COMMAND_RIGHT,i.COMMAND_FIREFOX):t.push(i.CONTROL),t.includes(e)}function c(e){return[i.CONTROL,i.COMMAND_LEFT,i.COMMAND_RIGHT,i.COMMAND_FIREFOX].includes(e)}function f(e,t){var n=t.split("|"),o=!1;return Object(r["arrayEach"])(n,(function(t){if(e===i[t])return o=!0,!1})),o}},c9ef7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("8f61"),o="base";function i(e,t,n,o,i,a,l){var s=[],u=[];l.className&&Object(r["addClass"])(t,l.className),l.readOnly&&s.push(l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName?s.push(l.invalidCellClassName):u.push(l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&s.push(l.noWordWrapClassName),!a&&l.placeholder&&s.push(l.placeholderCellClassName),Object(r["removeClass"])(t,u),Object(r["addClass"])(t,s)}i.RENDERER_TYPE=o},cb3f:function(e,t,n){"use strict";n("2b96"),n("3d35"),n("bebe"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("c61e"),o=n("bb9b");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}t["a"]=function(){return{activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var t,n,o;for(t=0,n=this.countRows();t<n;t++)if(o=this.getDataAtCell(t,e),!1===Object(r["isEmpty"])(o))return!1;return!0},isEmptyRow:function(e){var t,n,a,l;for(t=0,n=this.countCols();t<n;t++)if(a=this.getDataAtCell(e,t),!1===Object(r["isEmpty"])(a))return"object"===i(a)&&(l=this.getCellMeta(e,t),Object(o["isObjectEqual"])(this.getSchema()[l.prop],a));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}}},cbfe:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getNormalizedDate",(function(){return Vn}));var o=n("e832"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("DataGrid")],1)},a=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"example"}},[n("hot-table",{ref:"hotTableComponent",attrs:{data:e.data,settings:e.hotSettings}})],1)},s=[],u=n("b44c"),c=(n("cbfe"),[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]]),f="selected",h="odd";function d(){return c}n("add1");var p=n("f65c"),y=(n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562"),n("212c"),n("0b09"),n("e44e"),n("2931"),n("7ae5"),n("129d"),n("3128"),n("83a9"),n("c9cc"),n("7003"),n("7cd7"),n("2b96"),n("3d35"),n("213d"),n("88eb")),v=n("8f61"),g=n("b74a"),b=n("bb9b"),m=n("27c2");function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function R(){return R="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=k(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},R.apply(this,arguments)}function k(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=I(e),null===e)break;return e}function E(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function T(e){var t=A();return function(){var n,r=I(e);if(t){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return P(this,n)}}function P(e,t){if(t&&("object"===w(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}var _="handsontableEditor",x="handsontable",H=function(e){E(n,e);var t=T(n);function n(){return O(this,n),t.apply(this,arguments)}return S(n,[{key:"open",value:function(){R(I(n.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(v["setCaretPosition"])(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),R(I(n.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,t,r,o,i,a){R(I(n.prototype),"prepare",this).call(this,e,t,r,o,i,a);var l=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&l.setValue(n),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Object(b["extend"])(s,a.handsontable),this.htOptions=s}},{key:"beginEditing",value:function(e,t){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||R(I(n.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){R(I(n.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}R(I(n.prototype),"finishEditing",this).call(this,e,t,r)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),r=t.getContext("editor");R(I(n.prototype),"registerShortcuts",this).call(this);var o={group:_,relativeToGroup:m["b"],position:"before"},i=function(t,n){var r=e.htEditor.getInstance();if(void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length))return n.preventDefault(),Object(g["stopImmediatePropagation"])(n),e.hot.listen(),e.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:function(t){var n,r,o=e.htEditor.getInstance();return!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):(r=o.getSelectedLast()[0],n=r-1)),i(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(t){var n,r,o=e.htEditor.getInstance();if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var a=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(a,r+1)}}else n=0;return i(n,t)},preventDefault:!1}],o)}},{key:"unregisterShortcuts",value:function(){R(I(n.prototype),"unregisterShortcuts",this).call(this);var e=this.hot.getShortcutManager(),t=e.getContext("editor");t.removeShortcutsByGroup(_)}}],[{key:"EDITOR_TYPE",get:function(){return x}}]),n}(y["a"]),N=n("d1f5"),D=n("c61e"),L=n("e0a9"),B=n("c89a"),V=n("2d75");function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t,n){return t&&U(e.prototype,t),n&&U(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function G(){return G="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},G.apply(this,arguments)}function Y(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Z(e),null===e)break;return e}function X(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}function $(e){var t=J();return function(){var n,r=Z(e);if(t){var o=Z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q(this,n)}}function q(e,t){if(t&&("object"===F(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Q(e)}function Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=new WeakMap,ne="autocomplete",re=function(e){X(n,e);var t=$(n);function n(e){var r;return W(this,n),r=t.call(this,e),ee(Q(r),"sortByRelevance",(function(e,t,n){var r,o,i,a,l=[],s=[],u=e.length,c=t.length;if(0===u){for(i=0;i<c;i++)s.push(i);return s}for(i=0;i<c;i++){if(o=Object(L["stripTags"])(Object(D["stringify"])(t[i])),n)a=o.indexOf(e);else{var f=this.cellProperties.locale;a=o.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}-1!==a&&(r=o.length-a-u,l.push({baseIndex:i,index:a,charsLeft:r,value:o}))}for(l.sort((function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),i=0,c=l.length;i<c;i++)s.push(l[i].baseIndex);return s})),r.query=null,r.strippedChoices=[],r.rawChoices=[],te.set(Q(r),{skipOne:!1,isMacOS:r.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),r}return z(n,[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){var n=e.stripValueIfNeeded(t);return n===e.TEXTAREA.value}));return Object(D["isDefined"])(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){G(Z(n.prototype),"createElements",this).call(this),Object(v["addClass"])(this.htContainer,"autocompleteEditor"),Object(v["addClass"])(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=te.get(this);G(Z(n.prototype),"open",this).call(this);var r=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=Object(v["getScrollbarWidth"])();0===i&&t.isMacOS&&(i+=15),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)})),r.updateSettings({colWidths:o?[Object(v["outerWidth"])(this.TEXTAREA)-2]:void 0,width:o?Object(v["outerWidth"])(this.TEXTAREA)+i:void 0,renderer:function(t,n,r,o,i,a,l){Object(V["a"])(t,n,r,o,i,a,l);var s,u,c=e.cellProperties,f=c.filteringCaseSensitive,h=c.allowHtml,d=c.locale,p=e.query,y=Object(D["stringify"])(a);y&&!h&&(s=!0===f?y.indexOf(p):y.toLocaleLowerCase(d).indexOf(p.toLocaleLowerCase(d)),-1!==s&&(u=y.substr(s,p.length),y=y.replace(u,"<strong>".concat(u,"</strong>")))),n.innerHTML=y},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),G(Z(n.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){G(Z(n.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,n=this.cellProperties.source;this.query=e,"function"===typeof n?n.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=Object(v["getCaretPosition"])(this.TEXTAREA),n=Object(v["getSelectionEndPosition"])(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,a=null,l=e;r&&(i=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var s=Array.isArray(i)?i.length:0;if(!1===o)s&&(a=i[0]);else{for(var u=[],c=0,f=l.length;c<f;c++){if(r&&s<=c)break;s?u.push(l[i[c]]):u.push(l[c])}a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(Object(N["pivot"])([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.hot.listen(),Object(v["setCaretPosition"])(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=Object(v["getTrimmingContainer"])(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||"horizontal"===n))return!1;var r=Object(v["offset"])(this.TEXTAREA),o=Object(v["outerHeight"])(this.TEXTAREA),i=this.getDropdownHeight(),a=e.scrollTop,l=Object(v["outerHeight"])(this.hot.view._wt.wtTable.THEAD),s=Object(v["offset"])(e),u=r.top-s.top-l+a,c=e.scrollHeight-u-l-o,f=i>c&&u>c;return f?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(f?u:c,i),f}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n=0,r=0,o=0,i=null;do{o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=o,r+=1}while(n<e);i=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-i,"px")),this.setDropdownHeight(n-o)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+Object(v["getScrollbarWidth"])(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"===typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=Object(N["arrayMap"])(e,(function(e){return Object(D["stringify"])(e)})),r=Object(N["arrayMap"])(n,(function(e){return t?e:Object(L["stripTags"])(e)}));return r}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n={row:t?t.from.row:-1},r=!1;return e===B["KEY_CODES"].ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(r=!0),e===B["KEY_CODES"].ARROW_UP&&n.row>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=te.get(this);if(n.skipOne=!1,Object(B["isPrintableChar"])(e.keyCode)||e.keyCode===B["KEY_CODES"].BACKSPACE||e.keyCode===B["KEY_CODES"].DELETE||e.keyCode===B["KEY_CODES"].INSERT){var r=10;if(e.keyCode===B["KEY_CODES"].C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),r)}}}],[{key:"EDITOR_TYPE",get:function(){return ne}}]),n}(H),oe=n("55a6");function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t,n){return t&&le(e.prototype,t),n&&le(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ue(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ce(e,t)}function ce(e,t){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ce(e,t)}function fe(e){var t=pe();return function(){var n,r=ye(e);if(t){var o=ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return he(this,n)}}function he(e,t){if(t&&("object"===ie(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return de(e)}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ye(e)}var ve="checkbox",ge=function(e){ue(n,e);var t=fe(n);function n(){return ae(this,n),t.apply(this,arguments)}return se(n,[{key:"beginEditing",value:function(e,t){if(t&&"mouseup"===t.type){var n=this.TD.querySelector('input[type="checkbox"]');Object(v["hasClass"])(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return ve}}]),n}(oe["a"]),be=n("1f22"),me=n("e83b"),we=n("3225");function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t,n){return t&&Se(e.prototype,t),n&&Se(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ke(){return ke="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ee(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ke.apply(this,arguments)}function Ee(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=_e(e),null===e)break;return e}function je(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Te(e,t)}function Te(e,t){return Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Te(e,t)}function Pe(e){var t=Ie();return function(){var n,r=_e(e);if(t){var o=_e(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(e,t){if(t&&("object"===Oe(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ae(e)}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ie(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}var xe="date",He=function(e){je(n,e);var t=Pe(n);function n(e){var r;return Ce(this,n),r=t.call(this,e),r.defaultDateFormat="DD/MM/YYYY",r.isCellEdited=!1,r.parentDestroyed=!1,r.$datePicker=null,r}return Re(n,[{key:"init",value:function(){var e=this;if("function"!==typeof be)throw new Error("You need to include moment.js to your project.");if("function"!==typeof me)throw new Error("You need to include Pikaday to your project.");ke(_e(n.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){ke(_e(n.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Object(v["addClass"])(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var e=new we["a"](this);e.addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()}))}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,t,r,o,i,a){ke(_e(n.prototype),"prepare",this).call(this,e,t,r,o,i,a)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ke(_e(n.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e,t=this;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){t.instance._refreshBorders()})),ke(_e(n.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var r=this.originalValue;void 0!==r&&this.setValue(r)}ke(_e(n.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){var t,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=!!e&&Object(B["isFunctionKey"])(e.keyCode);this.datePicker.style.display="block",this.$datePicker=new me(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+Object(v["outerHeight"])(this.TD),"px");var a=this.hot.rootWindow.pageXOffset;a=this.hot.isRtl()?n.right-Object(v["outerWidth"])(this.datePicker):n.left,this.datePickerStyle.left="".concat(a,"px"),this.originalValue?(t=this.originalValue,be(t,r,!0).isValid()&&this.$datePicker.setMoment(be(t,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||o||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,be(t,r,!0).isValid()&&this.$datePicker.setMoment(be(t,r),!0),i||o||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(b["deepExtend"])(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(t){var n=t;isNaN(n.getTime())||(n=be(n).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(n),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},n}}],[{key:"EDITOR_TYPE",get:function(){return xe}}]),n}(y["a"]),Ne=n("0393");function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e,t,n){return t&&Be(e.prototype,t),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fe(){return Fe="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=We(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Fe.apply(this,arguments)}function We(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=$e(e),null===e)break;return e}function Ue(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}function ze(e,t){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ze(e,t)}function Ge(e){var t=Ke();return function(){var n,r=$e(e);if(t){var o=$e(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ye(this,n)}}function Ye(e,t){if(t&&("object"===De(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Xe(e)}function Xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}var qe="dropdown",Qe=function(e){Ue(n,e);var t=Ge(n);function n(){return Le(this,n),t.apply(this,arguments)}return Ve(n,[{key:"prepare",value:function(e,t,r,o,i,a){Fe($e(n.prototype),"prepare",this).call(this,e,t,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return qe}}]),n}(re);function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t,n){return t&&et(e.prototype,t),n&&et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nt(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rt(e,t)}function ot(e){var t=lt();return function(){var n,r=st(e);if(t){var o=st(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return it(this,n)}}function it(e,t){if(t&&("object"===Je(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return at(e)}function at(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function st(e){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},st(e)}Ne["a"].getSingleton().add("beforeValidate",(function(e,t,n){var r=this.getCellMeta(t,this.propToCol(n));r.editor===Qe&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var ut="numeric",ct=function(e){nt(n,e);var t=ot(n);function n(){return Ze(this,n),t.apply(this,arguments)}return tt(n,null,[{key:"EDITOR_TYPE",get:function(){return ut}}]),n}(y["a"]);function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t,n){return t&&dt(e.prototype,t),n&&dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yt(){return yt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=vt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},yt.apply(this,arguments)}function vt(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=St(e),null===e)break;return e}function gt(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}function mt(e){var t=Ct();return function(){var n,r=St(e);if(t){var o=St(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wt(this,n)}}function wt(e,t){if(t&&("object"===ft(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ot(e)}function Ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function St(e){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},St(e)}var Rt="password",kt=function(e){gt(n,e);var t=mt(n);function n(){return ht(this,n),t.apply(this,arguments)}return pt(n,[{key:"createElements",value:function(){yt(St(n.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(v["empty"])(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return Rt}}]),n}(y["a"]);function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function jt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pt(e,t,n){return t&&Tt(e.prototype,t),n&&Tt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mt(){return Mt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=At(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Mt.apply(this,arguments)}function At(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Lt(e),null===e)break;return e}function It(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_t(e,t)}function _t(e,t){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_t(e,t)}function xt(e){var t=Dt();return function(){var n,r=Lt(e);if(t){var o=Lt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ht(this,n)}}function Ht(e,t){if(t&&("object"===Et(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Nt(e)}function Nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}var Bt="ht_editor_visible",Vt="selectEditor",Ft="select",Wt=function(e){It(n,e);var t=xt(n);function n(){return jt(this,n),t.apply(this,arguments)}return Pt(n,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Object(v["addClass"])(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(e){this.select.value=e}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var e=this.hot.getShortcutManager();e.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Object(v["hasClass"])(this.select,Bt)&&Object(v["removeClass"])(this.select,Bt),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var e=this;this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return e.refreshDimensions()})),this.addHook("afterRowResize",(function(){return e.refreshDimensions()}))}},{key:"prepare",value:function(e,t,r,o,i,a){var l=this;Mt(Lt(n.prototype),"prepare",this).call(this,e,t,r,o,i,a);var s,u=this.cellProperties.selectOptions;s="function"===typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Object(v["empty"])(this.select),Object(b["objectEach"])(s,(function(e,t){var n=l.hot.rootDocument.createElement("OPTION");n.value=t,Object(v["fastInnerHTML"])(n,e),l.select.appendChild(n)}))}},{key:"prepareOptions",value:function(e){var t={};if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"===Et(e)&&(t=e);return t}},{key:"refreshValue",value:function(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===oe["b"].EDITING)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),t=e.top,n=e.start,r=e.width,o=e.height,i=this.select.style;i.height="".concat(o,"px"),i.width="".concat(r,"px"),i.top="".concat(t,"px"),i[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),i.margin="0px",Object(v["addClass"])(this.select,Bt)}else this.close()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),n=t.getContext("editor"),r={group:Vt};!1!==this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var t=e.select.selectedIndex-1;t>=0&&(e.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var t=e.select.selectedIndex+1;t<=e.select.length-1&&(e.select[t].selected=!0)}}],r)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager(),t=e.getContext("editor");t.removeShortcutsByGroup(Vt)}}],[{key:"EDITOR_TYPE",get:function(){return Ft}}]),n}(oe["a"]);function Ut(e){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ut(e)}function zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yt(e,t,n){return t&&Gt(e.prototype,t),n&&Gt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xt(){return Xt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Kt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Xt.apply(this,arguments)}function Kt(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=tn(e),null===e)break;return e}function $t(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t)}function qt(e,t){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qt(e,t)}function Qt(e){var t=en();return function(){var n,r=tn(e);if(t){var o=tn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jt(this,n)}}function Jt(e,t){if(t&&("object"===Ut(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zt(e)}function Zt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function tn(e){return tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tn(e)}var nn="time",rn=function(e){$t(n,e);var t=Qt(n);function n(){return zt(this,n),t.apply(this,arguments)}return Yt(n,[{key:"prepare",value:function(e,t,r,o,i,a){Xt(tn(n.prototype),"prepare",this).call(this,e,t,r,o,i,a),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return nn}}]),n}(y["a"]),on=n("914e");function an(){Object(on["e"])(oe["a"]),Object(on["e"])(re),Object(on["e"])(ge),Object(on["e"])(He),Object(on["e"])(Qe),Object(on["e"])(H),Object(on["e"])(ct),Object(on["e"])(kt),Object(on["e"])(Wt),Object(on["e"])(y["a"]),Object(on["e"])(rn)}var ln=n("c9ef7"),sn="html";function un(e,t,n,r,o,i,a){ln["a"].apply(this,[e,t,n,r,o,i,a]),Object(v["fastInnerHTML"])(t,null===i||void 0===i?"":i,!1)}un.RENDERER_TYPE=sn;var cn="autocomplete";function fn(e,t,n,r,o,i,a){var l=e.rootDocument,s=a.allowHtml?un:V["a"],u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,n,r,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),Object(v["addClass"])(t,"htAutocomplete"),!e.acArrowListener){var c=new we["a"](e);e.acArrowListener=function(o){Object(v["hasClass"])(o.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){c.destroy()}))}}fn.RENDERER_TYPE=cn;n("267c"),n("986e"),n("bfe9"),n("74b4");var hn=new WeakMap,dn=new WeakMap,pn="htBadValue",yn="data-row",vn="data-col",gn="checkboxRenderer",bn="checkbox";function mn(e,t,n,r,o,i,a){var l=e.rootDocument;ln["a"].apply(this,[e,t,n,r,o,i,a]),wn(e);var s=On(l),u=a.label,c=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Object(v["empty"])(t),i===a.checkedTemplate||Object(D["stringify"])(i).toLocaleLowerCase(a.locale)===Object(D["stringify"])(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Object(D["stringify"])(i).toLocaleLowerCase(a.locale)===Object(D["stringify"])(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Object(D["isEmpty"])(i)?Object(v["addClass"])(s,"noValue"):(s.style.display="none",Object(v["addClass"])(s,pn),c=!0),s.setAttribute(yn,n),s.setAttribute(vn,r),!c&&u){var f="";if(u.value)f="function"===typeof u.value?u.value.call(this,n,r,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(n,u.property);f=null!==h?h:""}var d=Cn(l,f,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):u.position&&"after"!==u.position||(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}function p(){var t=e.getShortcutManager(),n=t.getContext("grid"),r={group:gn};n.addShortcuts([{keys:[["space"]],callback:function(){return y(),!g()}},{keys:[["enter"]],callback:function(){return y(),!g()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!g()},relativeToGroup:m["a"],position:"before"}],r)}function y(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopStartCorner(),i=o.row,a=o.col,l=n[r].getBottomEndCorner(),s=l.row,u=l.col,c=[],f=i;f<=s;f+=1)for(var h=a;h<=u;h+=1){var d=e.getCellMeta(f,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){"undefined"===typeof d.checkedTemplate&&(d.checkedTemplate=!0),"undefined"===typeof d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var p=e.getDataAtCell(f,h);!1===t?[d.checkedTemplate,d.checkedTemplate.toString()].includes(p)?c.push([f,h,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(p)&&c.push([f,h,d.checkedTemplate]):c.push([f,h,d.uncheckedTemplate])}}c.length>0&&e.setDataAtCell(c)}}function g(){var t=e.getSelectedRange();if(t){for(var n=0;n<t.length;n++)for(var r=t[n].getTopStartCorner(),o=t[n].getBottomEndCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var l=e.getCellMeta(i,a);if("checkbox"!==l.type)return!1;var s=e.getCell(i,a);if(null===s||void 0===s)return!0;var u=s.querySelectorAll("input[type=checkbox]");if(u.length>0&&!l.readOnly)return!0}return!1}}(!u||u&&!u.separated)&&t.appendChild(s),c&&t.appendChild(l.createTextNode("#bad-value#")),hn.has(e)||(hn.set(e,!0),p())}function wn(e){var t=dn.get(e);if(!t){var n=e.rootElement;t=new we["a"](e),t.addEventListener(n,"click",(function(t){return Rn(t,e)})),t.addEventListener(n,"mouseup",(function(t){return Sn(t,e)})),t.addEventListener(n,"change",(function(t){return kn(t,e)})),dn.set(e,t)}return t}function On(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Cn(e,t,n){var r=e.createElement("label");return r.className="htCheckboxRendererLabel ".concat(n?"fullWidth":""),r.appendChild(e.createTextNode(t)),r.cloneNode(!0)}function Sn(e,t){var n=e.target;En(n)&&n.hasAttribute(yn)&&n.hasAttribute(vn)&&setTimeout(t.listen,10)}function Rn(e,t){var n=e.target;if(En(n)&&n.hasAttribute(yn)&&n.hasAttribute(vn)){var r=parseInt(n.getAttribute(yn),10),o=parseInt(n.getAttribute(vn),10),i=t.getCellMeta(r,o);i.readOnly&&e.preventDefault()}}function kn(e,t){var n=e.target;if(En(n)&&n.hasAttribute(yn)&&n.hasAttribute(vn)){var r=parseInt(n.getAttribute(yn),10),o=parseInt(n.getAttribute(vn),10),i=t.getCellMeta(r,o);if(!i.readOnly){var a=null;a=e.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,t.setDataAtCell(r,o,a)}}}function En(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}Ne["a"].getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){var r=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===bn){if(r){var s=r.value,u=r.property,c=n;if(s)c="function"===typeof s?s(i,a,l,n):s;else if(u){var f=this.getDataAtRowProp(i,u);c=null!==f?f:n}e=c}return e}})),mn.RENDERER_TYPE=bn;n("b503"),n("9dec");var jn=n("e0c5"),Tn=n("0da0"),Pn="numeric";function Mn(e,t,n,r,o,i,a){var l=i;if(Object(Tn["isNumeric"])(l)){var s=a.numericFormat,u=s&&s.culture||"-",c=s&&s.pattern,f=a.className||"",h=f.length?f.split(" "):[];if("undefined"!==typeof u&&!jn.languages()[u]){var d=u.replace("-",""),p=jn.allLanguages?jn.allLanguages[u]:jn[d];p&&jn.registerLanguage(p)}jn.setLanguage(u),l=jn(l).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Object(V["a"])(e,t,n,r,o,l,a)}Mn.RENDERER_TYPE=Pn;var An="password";function In(e,t,n,r,o,i,a){V["a"].apply(this,[e,t,n,r,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Object(Tn["rangeEach"])(l-1,(function(){u+=s})),Object(v["fastInnerHTML"])(t,u)}In.RENDERER_TYPE=An;var _n="time";function xn(e,t,n,r,o,i,a){V["a"].apply(this,[e,t,n,r,o,i,a]),t.dir="ltr"}xn.RENDERER_TYPE=_n;var Hn=n("509f");function Nn(){Object(Hn["d"])(fn),Object(Hn["d"])(ln["a"]),Object(Hn["d"])(mn),Object(Hn["d"])(un),Object(Hn["d"])(Mn),Object(Hn["d"])(In),Object(Hn["d"])(V["a"]),Object(Hn["d"])(xn)}var Dn="autocomplete";function Ln(e,t){var n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,Bn(n,t)):Bn(n,t)(this.source):t(!0)}function Bn(e,t){var n=e;return function(e){for(var r=!1,o=0,i=e.length;o<i;o++)if(n===e[o]){r=!0;break}t(r)}}Ln.VALIDATOR_TYPE=Dn;n("7f16");function Vn(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}var Fn="date";function Wn(e,t){var n=Object(on["b"])(xe,this.instance),r=e,o=!0;null!==r&&void 0!==r||(r="");var i=be(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=be(new Date(r)).isValid()||i;if(this.allowEmpty&&""===r&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(!0===this.correctFormat){var l=Un(r,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}function Un(e,t){var n,r=be(Vn(e)),o=be(e,t),i=e.search(/[A-z]/g)>-1;return n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||i?r:o,n.format(t)}Wn.VALIDATOR_TYPE=Fn;var zn="numeric";function Gn(e,t){var n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&Object(Tn["isNumeric"])(e))}Gn.VALIDATOR_TYPE=zn;var Yn=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Xn="time";function Kn(e,t){var n=this.timeFormat||"h:mm:ss a",r=!0,o=e;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=be(o,Yn,!0).isValid()?be(o):be(o,n),l=a.isValid(),s=be(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(l=!0,s=!0),l||(r=!1),!l&&s&&(r=!0),l&&!s)if(!0===this.correctFormat){var u=a.format(n),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),r=!0}else r=!1;t(r)}Kn.VALIDATOR_TYPE=Xn;var $n=n("5b54");function qn(){Object($n["d"])(Ln),Object($n["d"])(Wn),Object($n["d"])(Gn),Object($n["d"])(Kn)}var Qn="autocomplete",Jn={CELL_TYPE:Qn,editor:re,renderer:fn,validator:Ln},Zn="checkbox",er={CELL_TYPE:Zn,editor:ge,renderer:mn},tr="date",nr={CELL_TYPE:tr,editor:He,renderer:fn,validator:Wn},rr="dropdown",or={CELL_TYPE:rr,editor:Qe,renderer:fn,validator:Ln},ir="handsontable",ar={CELL_TYPE:ir,editor:H,renderer:fn},lr="numeric",sr={CELL_TYPE:lr,editor:ct,renderer:Mn,validator:Gn,dataType:"number"},ur="password",cr={CELL_TYPE:ur,editor:kt,renderer:In,copyable:!1},fr=n("f6e6"),hr="time",dr={CELL_TYPE:hr,editor:rn,renderer:xn,validator:Kn},pr=n("844f");function yr(){Object(pr["d"])(Jn),Object(pr["d"])(er),Object(pr["d"])(nr),Object(pr["d"])(or),Object(pr["d"])(ar),Object(pr["d"])(sr),Object(pr["d"])(cr),Object(pr["d"])(fr["a"]),Object(pr["d"])(dr)}n("b43b"),n("841e"),n("bdb6"),n("0a66"),n("a0c5"),n("d3af"),n("2a17"),n("9827"),n("ce05");var vr=n("1af1");function gr(e,t){return Cr(e)||Or(e,t)||mr(e,t)||br()}function br(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mr(e,t){if(e){if("string"===typeof e)return wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wr(e,t):void 0}}function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Or(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Cr(e){if(Array.isArray(e))return e}function Sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t,n){return t&&Rr(e.prototype,t),n&&Rr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Er(e,t){jr(e,t),t.add(e)}function jr(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tr(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Pr=new Map([["plugin",vr["c"]],["cell-type",pr["c"]],["editor",on["d"]],["renderer",Hn["c"]],["validator",$n["c"]]]),Mr="base",Ar=new WeakMap,Ir=[],_r=null,xr=new WeakSet,Hr=function(){function e(t){var n=this;Sr(this,e),Er(this,xr),Object(b["defineGetter"])(this,"hot",t,{writable:!1}),Ar.set(this,{hooks:{}}),_r=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}return kr(e,[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var r=[];if(n.forEach((function(e){var t=e.split(":"),n=gr(t,2),o=n[0],i=n[1];if(!Pr.has(o))throw new Error('Unknown plugin dependency type "'.concat(o,'" was found.'));Pr.get(o)(i)||r.push(" - ".concat(i," (").concat(o,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");Ir.push(o)}}_r||(_r=Object(vr["b"])()),_r.indexOf("UndoRedo")>=0&&_r.splice(_r.indexOf("UndoRedo"),1),_r.indexOf(this.pluginName)>=0&&_r.splice(_r.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()}));var i=0===_r.length;if(i){if(Ir.length>0){var a=["".concat(Ir.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(a)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){Ar.get(this).hooks[e]=Ar.get(this).hooks[e]||[];var n=Ar.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),Ar.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;Object(N["arrayEach"])(Ar.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=Ar.get(this).hooks;Object(b["objectEach"])(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){Object(N["arrayEach"])(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){var t=Tr(this,xr,Nr).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(b["objectEach"])(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Mr}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function Nr(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if("boolean"===typeof t)return t;for(var n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}var Dr=n("3022");n("ba9f");function Lr(e,t){return Ur(e)||Wr(e,t)||Vr(e,t)||Br()}function Br(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vr(e,t){if(e){if("string"===typeof e)return Fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fr(e,t):void 0}}function Fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wr(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ur(e){if(Array.isArray(e))return e}function zr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yr(e,t,n){return t&&Gr(e.prototype,t),n&&Gr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Xr=function(){function e(t){zr(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Yr(e,[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var t=this.hot.getColHeader(0);if(null!==t&&void 0!==t){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),Object(N["arrayEach"])(this.rows,(function(t){e(t.row,Object(v["outerHeight"])(t.table)-1)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),Object(N["arrayEach"])(this.columns,(function(t){var n=t.table.getBoundingClientRect(),r=n.width;e(t.col,Math.ceil(r))}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){Object(N["arrayEach"])(n.strings,(function(n){t.appendChild(e.createColElement(n.col))}))})),t}},{key:"createRow",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),r.appendChild(o)),this.samples.forEach((function(o){Object(N["arrayEach"])(o.strings,(function(o){var i=o.col,a=t.hot.getCellMeta(e,i);a.col=i,a.row=e;var l=t.hot.getCellRenderer(a),s=n.createElement("td");s.setAttribute("ghost-table",1),l(t.hot,s,e,i,t.hot.colToProp(i),o.value,a),r.appendChild(s)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,n=t.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var o=t.createElement("th");r.push([-1,o]),n.appendChild(o)}this.samples.forEach((function(e){Object(N["arrayEach"])(e.strings,(function(e){var o=e.col,i=t.createElement("th");r.push([o,i]),n.appendChild(i)}))})),this.table.tHead.appendChild(n),Object(N["arrayEach"])(r,(function(t){var n=Lr(t,2),r=n[0],o=n[1];e.hot.view.appendColHeader(r,o)}))}},{key:"createCol",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){Object(N["arrayEach"])(o.strings,(function(o){var i=o.row,a=t.hot.getCellMeta(i,e);a.col=e,a.row=i;var l=t.hot.getCellRenderer(a),s=n.createElement("td"),u=n.createElement("tr");s.setAttribute("ghost-table",1),l(t.hot,s,i,e,t.hot.colToProp(e),o.value,a),u.appendChild(s),r.appendChild(u)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=this.hot.rootDocument.createElement("col");return t.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(e),"px"),t}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("table"),o=t.createElement("thead"),i=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),s=t.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(s),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(l),r.appendChild(i),Object(v["addClass"])(r,e),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:l,th:s}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("div"),o="htGhostTable htAutoSize ".concat(e.trim());return Object(v["addClass"])(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),e}(),Kr=Xr;n("0ee2");function $r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jr(e,t,n){return t&&Qr(e.prototype,t),n&&Qr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Zr=function(){function e(t){qr(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return Jr(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var r=this,o=new Map,i="number"===typeof n?{from:n,to:n}:n,a=i.from,l=i.to;return Object(Tn["rangeEach"])(a,l,(function(n){var i=r.generateSample(e,t,n);o.set(n,i)})),o}},{key:"generateSample",value:function(e,t,n){var r=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var o=new Map,i="row"===e?"col":"row",a=[];return Object(Tn["rangeEach"])(t.from,t.to,(function(t){var l,s="row"===e?r.dataFactory(n,t):r.dataFactory(t,n),u=s.value,c=s.bundleSeed,f="string"===typeof c&&c.length>0;l=f?c:Object(b["isObject"])(u)?"".concat(Object.keys(u).length):Array.isArray(u)?"".concat(u.length):"".concat(Object(D["stringify"])(u).length),o.has(l)||o.set(l,{needed:r.getSampleCount(),strings:[]});var h=o.get(l);if(h.needed){var d=a.indexOf(u)>-1;(!d||r.allowDuplicates||f)&&(h.strings.push($r({value:u},i,t)),a.push(u),h.needed-=1)}})),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}(),eo=Zr,to=n("3e74"),no=n("cffe");function ro(e){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ro(e)}function oo(e,t){return uo(e)||so(e,t)||ao(e,t)||io()}function io(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ao(e,t){if(e){if("string"===typeof e)return lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lo(e,t):void 0}}function lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function so(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function uo(e){if(Array.isArray(e))return e}function co(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ho(e,t,n){return t&&fo(e.prototype,t),n&&fo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function po(){return po="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=yo(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},po.apply(this,arguments)}function yo(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Co(e),null===e)break;return e}function vo(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&go(e,t)}function go(e,t){return go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},go(e,t)}function bo(e){var t=Oo();return function(){var n,r=Co(e);if(t){var o=Co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mo(this,n)}}function mo(e,t){if(t&&("object"===ro(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wo(e)}function wo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Co(e)}Ne["a"].getSingleton().register("modifyAutoColumnSizeSeed");var So="autoColumnSize",Ro=10,ko=new WeakMap,Eo="autoColumnSize",jo=function(e){vo(n,e);var t=bo(n);function n(e){var r;return co(this,n),r=t.call(this,e),ko.set(wo(r),{cachedColumnHeaders:[]}),r.ghostTable=new Kr(r.hot),r.samplesGenerator=new eo((function(e,t){var n=r.hot.getCellMeta(e,t),o="";n.spanned||(o=r.hot.getDataAtCell(e,t));var i="";return r.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=r.hot.runHooks("modifyAutoColumnSizeSeed",i,n,o)),{value:o,bundleSeed:i}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredColumns=0,r.columnWidthsMap=new no["a"],r.hot.columnIndexMapper.registerMap(Eo,r.columnWidthsMap),r.addHook("beforeColumnResize",(function(e,t,n){return r.onBeforeColumnResize(e,t,n)})),r}return ho(n,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings()[So]&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[So];t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeChangeRender",(function(t){return e.onBeforeChange(t)})),this.addHook("afterFormulasValuesUpdate",(function(t){return e.onAfterFormulasValuesUpdate(t)})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyColWidth",(function(t,n){return e.getColumnWidth(n,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),po(Co(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),po(Co(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this;po(Co(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){var e=this.hot.countRows();if(e){var t=this.hot.renderCall,n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==n&&-1!==r&&this.calculateColumnsWidth({from:n,to:r},void 0,t)}}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof t?{from:t,to:t}:t,i="number"===typeof n?{from:n,to:n}:n;Object(Tn["rangeEach"])(o.from,o.to,(function(t){var n=e.hot.toPhysicalColumn(t);if(null===n&&(n=t),r||null===e.columnWidthsMap.getValueAtIndex(n)&&!e.hot._getColWidthFromSettings(n)){var o=e.samplesGenerator.generateColumnSamples(t,i);Object(N["arrayEach"])(o,(function(t){var n=oo(t,2),r=n[0],o=n[1];return e.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){e.ghostTable.getWidths((function(t,n){var r=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return Object(Dr["cancelAnimationFrame"])(i),void(e.inProgress=!1);e.calculateColumnsWidth({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},t),r=r+n.CALCULATION_STEP+1,r<o?i=Object(Dr["requestAnimationFrame"])(a):(Object(Dr["cancelAnimationFrame"])(i),e.inProgress=!1,e.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateColumnsWidth({from:0,to:l},t),this.firstCalculation=!1,r=l+1),r<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings()[So],t=e&&Object(b["hasOwnProperty"])(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Object(b["hasOwnProperty"])(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings()[So],t=n.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return Object(b["isObject"])(e)&&(t=e.syncLimit,Object(L["isPercentValue"])(t)?t=Object(Tn["valueAccordingPercent"])(r,t):t>>=0),Math.min(t,r)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"===typeof r&&(r=Math.max(r,to["a"].DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=ko.get(this),n=t.cachedColumnHeaders,r=Object(N["arrayReduce"])(e,(function(e,t,r){var o=n.length;return(o-1<r||n[r]!==t)&&e.push(r),o-1<r?n.push(t):n[r]=t,e}),[]);return r}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((function(){Object(N["arrayEach"])(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Object(N["arrayFilter"])(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,n=Object(N["arrayMap"])(e,(function(e){var n=oo(e,2),r=n[1];return t.hot.toPhysicalColumn(t.hot.propToCol(r))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(e,t,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){ko.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(e){var t=Object(N["arrayFilter"])(e,(function(e){var t;return Object(D["isDefined"])(null===(t=e.address)||void 0===t?void 0:t.col)})),n=Object(N["arrayMap"])(t,(function(e){return e.address.col}));this.clearCache(Array.from(new Set(n)))}},{key:"destroy",value:function(){this.ghostTable.clean(),po(Co(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return So}},{key:"PLUGIN_PRIORITY",get:function(){return Ro}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),n}(Hr),To={horizontal:"horizontal",vertical:"vertical"};function Po(e,t,n,r){var o=n.length,i=n?n[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],c=0;c<s;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10),d=("down"===r?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<l;p++){var y=parseInt(n[p][0],10),v=parseInt(n[p][i-1],10),g=("right"===r?v-y:y-v)/(i-1)||0;a.push([g])}return a}function Mo(e,t,n){var r,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",r=n(t[0],t[1]),o=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",r=n(t[0],e[3]+1),o=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",r=n(t[0],t[1]),o=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",r=n(e[2]+1,t[1]),o=n(t[2],t[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:r,endOfDragCoords:o}}function Ao(e){var t={};return!0===e?(t.directions=Object.keys(To),t.autoInsertRow=!0):Object(b["isObject"])(e)?(Object(D["isDefined"])(e.autoInsertRow)?e.direction===To.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Object(D["isDefined"])(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(To)):"string"===typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function Io(e){return Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Io(e)}function _o(e){return No(e)||Ho(e)||Bo(e)||xo()}function xo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ho(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function No(e){if(Array.isArray(e))return Vo(e)}function Do(e,t){return Wo(e)||Fo(e,t)||Bo(e,t)||Lo()}function Lo(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Bo(e,t){if(e){if("string"===typeof e)return Vo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vo(e,t):void 0}}function Vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fo(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Wo(e){if(Array.isArray(e))return e}function Uo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Go(e,t,n){return t&&zo(e.prototype,t),n&&zo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yo(){return Yo="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Xo(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Yo.apply(this,arguments)}function Xo(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ei(e),null===e)break;return e}function Ko(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$o(e,t)}function $o(e,t){return $o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$o(e,t)}function qo(e){var t=Zo();return function(){var n,r=ei(e);if(t){var o=ei(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qo(this,n)}}function Qo(e,t){if(t&&("object"===Io(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Jo(e)}function Jo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ei(e){return ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ei(e)}Ne["a"].getSingleton().register("modifyAutofillRange"),Ne["a"].getSingleton().register("beforeAutofill"),Ne["a"].getSingleton().register("afterAutofill");var ti="autofill",ni=20,ri=["fillHandle"],oi="insert_row",ii=200,ai=function(e){Ko(n,e);var t=qo(n);function n(e){var r;return Uo(this,n),r=t.call(this,e),r.eventManager=new we["a"](Jo(r)),r.addingStarted=!1,r.mouseDownOnCellCorner=!1,r.mouseDragOutside=!1,r.handleDraggedCells=0,r.directions=[],r.autoInsertRow=!1,r}return Go(n,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.onAfterCellCornerMouseDown(t)})),this.addHook("afterOnCellCornerDblClick",(function(t){return e.onCellCornerDblClick(t)})),this.addHook("beforeOnCellMouseOver",(function(t,n){return e.onBeforeCellMouseOver(n)})),Yo(ei(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Yo(ei(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Yo(ei(n.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e=this,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),r=n.row,o=n.col,i=t.getBottomEndCorner(),a=i.row,l=i.col,s=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:a,endCol:l}]),u=[],c=[],f=[];return Object(N["arrayEach"])(s,(function(e){for(var t=e.startRow;t<=e.endRow;t+=1)-1===u.indexOf(t)&&u.push(t);for(var n=e.startCol;n<=e.endCol;n+=1)-1===c.indexOf(n)&&c.push(n)})),Object(N["arrayEach"])(u,(function(t){var n=[];Object(N["arrayEach"])(c,(function(r){n.push(e.hot.getCopyableData(t,r))})),f.push(n)})),f}},{key:"fillIn",value:function(){var e=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=this.hot.selection.highlight.getFill().getVisualCorners(),n=Do(t,4),r=n[0],o=n[1],i=n[2],a=n[3],l=this.hot.getSelectedRangeLast(),s=l.getTopStartCorner(),u=l.getBottomEndCorner();this.resetSelectionOfDraggedArea();var c=[s.row,s.col,u.row,u.col],f=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,r),Math.min(s.col,o),Math.max(u.row,i),Math.max(u.col,a)],c),h=Mo(c,f,(function(t,n){return e.hot._createCellCoords(t,n)})),d=h.directionOfDrag,p=h.startOfDragCoords,y=h.endOfDragCoords;if(p&&p.row>-1&&p.col>-1){var v=this.getSelectionData(),g=l.clone(),b=this.hot._createCellRange(p,p,y),m=this.hot.runHooks("beforeAutofill",v,g,b,d);if(!1===m)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var w=Po(p,y,v,d),O=m,C=m;if(["up","left"].indexOf(d)>-1&&(1!==C.length||0!==C[0].length))if(O=[],"up"===d)for(var S=y.row-p.row+1,R=S%C.length,k=0;k<S;k++)O.push(C[(k+(C.length-R))%C.length]);else for(var E=y.col-p.col+1,j=E%C[0].length,T=0;T<C.length;T++){O.push([]);for(var P=0;P<E;P++)O[T].push(C[T][(P+(C[T].length-j))%C[T].length])}this.hot.populateFromArray(p.row,p.col,O,y.row,y.col,"".concat(this.pluginName,".fill"),null,d,w),this.setSelection(f),this.hot.runHooks("afterAutofill",O,g,b,d),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner(),r=e;if(this.directions.includes(To.vertical)&&this.directions.includes(To.horizontal)){var o=t.getTopStartCorner();(n.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(To.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(To.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout((function(){e.hot.alter(oi,void 0,1,"".concat(e.pluginName,".fill")),e.addingStarted=!1}),ii)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t,n=this.hot.getData(),r=this.hot.countRows(),o=e[2]+1;o<r;o++){for(var i=e[1];i<=e[3];i++){var a=n[o][i];if(a)return-1}var l=n[o][e[1]-1],s=n[o][e[3]+1];(l||s)&&(t=o)}return t}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}},{key:"setSelection",value:function(e){var t;(t=this.hot).selectCell.apply(t,_o(Object(N["arrayMap"])(e,(function(e){return Math.max(e,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=this.hot.rootDocument.documentElement,n=Object(v["offset"])(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Object(v["outerHeight"])(this.hot.table),r=Object(v["offset"])(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Object(v["outerWidth"])(this.hot.table);return e.clientY>n&&e.clientX<=r}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)}))}},{key:"onCellCornerDblClick",value:function(){var e=this.selectAdjacent();e&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=Ao(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){Yo(ei(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ti}},{key:"PLUGIN_PRIORITY",get:function(){return ni}},{key:"SETTING_KEYS",get:function(){return[ti].concat(ri)}}]),n}(Hr);function li(e){return li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},li(e)}function si(e,t){return di(e)||hi(e,t)||ci(e,t)||ui()}function ui(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ci(e,t){if(e){if("string"===typeof e)return fi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fi(e,t):void 0}}function fi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hi(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function di(e){if(Array.isArray(e))return e}function pi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vi(e,t,n){return t&&yi(e.prototype,t),n&&yi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function gi(){return gi="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=bi(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},gi.apply(this,arguments)}function bi(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ki(e),null===e)break;return e}function mi(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wi(e,t)}function wi(e,t){return wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wi(e,t)}function Oi(e){var t=Ri();return function(){var n,r=ki(e);if(t){var o=ki(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ci(this,n)}}function Ci(e,t){if(t&&("object"===li(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Si(e)}function Si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ri(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ki(e){return ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ki(e)}var Ei="autoRowSize",ji=40,Ti="autoRowSize",Pi=function(e){mi(n,e);var t=Oi(n);function n(e){var r;return pi(this,n),r=t.call(this,e),r.rowHeightsMap=void 0,r.headerHeight=null,r.ghostTable=new Kr(r.hot),r.samplesGenerator=new eo((function(e,t){var n;return e>=0?n=r.hot.getDataAtCell(e,t):-1===e&&(n=r.hot.getColHeader(t)),{value:n}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredRows=0,r.rowHeightsMap=new no["a"],r.hot.rowIndexMapper.registerMap(Ti,r.rowHeightsMap),r.addHook("beforeRowResize",(function(e,t,n){return r.onBeforeRowResize(e,t,n)})),r}return vi(n,[{key:"isEnabled",value:function(){var e=this.hot.getSettings()[Ei];return!0===e||Object(b["isObject"])(e)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeChangeRender",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyRowHeight",(function(t,n){return e.getRowHeight(n,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),gi(ki(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this;this.headerHeight=null,gi(ki(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(t,n,r){return e.onBeforeRowResize(t,n,r)}))}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof t?{from:t,to:t}:t,i="number"===typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}Object(Tn["rangeEach"])(o.from,o.to,(function(t){if(r||null===e.rowHeightsMap.getValueAtIndex(t)){var n=e.samplesGenerator.generateRowSamples(t,i);Object(N["arrayEach"])(n,(function(t){var n=si(t,2),r=n[0],o=n[1];return e.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){e.ghostTable.getHeights((function(t,n){t<0?e.headerHeight=n:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return Object(Dr["cancelAnimationFrame"])(i),void(e.inProgress=!1);e.calculateRowsHeight({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},t),r=r+n.CALCULATION_STEP+1,r<o?i=Object(Dr["requestAnimationFrame"])(a):(Object(Dr["cancelAnimationFrame"])(i),e.inProgress=!1,e.hot.view.adjustElementsSize(!0),e.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&e.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},t),this.firstCalculation=!1,r=l+1),r<o?a():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings()[Ei],t=e&&Object(b["hasOwnProperty"])(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Object(b["hasOwnProperty"])(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Object(v["isVisible"])(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings()[Ei],t=n.SYNC_CALCULATION_LIMIT,r=this.hot.countRows()-1;return Object(b["isObject"])(e)&&(t=e.syncLimit,Object(L["isPercentValue"])(t)?t=Object(Tn["valueAccordingPercent"])(r,t):t>>=0),Math.min(t,r)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),r=t;return null!==n&&n>(t||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,n="number"===typeof e?{from:e,to:e}:e,r=n.from,o=n.to;this.hot.batchExecution((function(){Object(Tn["rangeEach"])(Math.min(r,o),Math.max(r,o),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!Object(N["arrayFilter"])(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,e),t){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean(),gi(ki(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ei}},{key:"PLUGIN_PRIORITY",get:function(){return ji}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),n}(Hr),Mi=n("766e"),Ai=n("3137"),Ii=n("b976");function _i(e){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(e)}function xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ni(e,t,n){return t&&Hi(e.prototype,t),n&&Hi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Di(){return Di="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Li(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Di.apply(this,arguments)}function Li(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Gi(e),null===e)break;return e}function Bi(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vi(e,t)}function Vi(e,t){return Vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vi(e,t)}function Fi(e){var t=zi();return function(){var n,r=Gi(e);if(t){var o=Gi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wi(this,n)}}function Wi(e,t){if(t&&("object"===_i(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ui(e)}function Ui(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Gi(e){return Gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gi(e)}var Yi=Object(Mi["a"])("physicallyIndexed"),Xi=Yi.getListWithInsertedItems,Ki=Yi.getListWithRemovedItems,$i=function(e){Bi(n,e);var t=Fi(n);function n(){return xi(this,n),t.call(this,(function(e){return e}))}return Ni(n,[{key:"insert",value:function(e,t){var r=Object(Ai["b"])(this.indexedValues,t);this.indexedValues=Xi(r,e,t,this.initValueOrFn),Di(Gi(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=Ki(this.indexedValues,e);this.indexedValues=Object(Ai["a"])(t,e),Di(Gi(n.prototype),"remove",this).call(this,e)}}]),n}(Ii["a"]),qi=$i;function Qi(e){return Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qi(e)}function Ji(e){return na(e)||ta(e)||ea(e)||Zi()}function Zi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ea(e,t){if(e){if("string"===typeof e)return ra(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ra(e,t):void 0}}function ta(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function na(e){if(Array.isArray(e))return ra(e)}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aa(e,t,n){return t&&ia(e.prototype,t),n&&ia(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function la(){return la="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=sa(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},la.apply(this,arguments)}function sa(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ya(e),null===e)break;return e}function ua(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ca(e,t)}function ca(e,t){return ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ca(e,t)}function fa(e){var t=pa();return function(){var n,r=ya(e);if(t){var o=ya(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ha(this,n)}}function ha(e,t){if(t&&("object"===Qi(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return da(e)}function da(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ya(e){return ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ya(e)}var va=Object(Mi["a"])("physicallyIndexed"),ga=va.getListWithInsertedItems,ba=va.getListWithRemovedItems,ma=function(e){ua(n,e);var t=fa(n);function n(){return oa(this,n),t.call(this,(function(e){return e}))}return aa(n,[{key:"insert",value:function(e,t){var r=this;this.indexedValues=ga(this.indexedValues,e,t,(function(e,t){return r.getNextValue(t)})),la(ya(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=ba(this.indexedValues,e),la(ya(n.prototype),"remove",this).call(this,e)}},{key:"getNextValue",value:function(e){return Math.max.apply(Math,Ji(this.getValues()))+1+e}}]),n}(Ii["a"]),wa=ma;function Oa(e){return Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oa(e)}function Ca(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ra(e,t,n){return t&&Sa(e.prototype,t),n&&Sa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ka(){return ka="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ea(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ka.apply(this,arguments)}function Ea(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=_a(e),null===e)break;return e}function ja(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ta(e,t)}function Ta(e,t){return Ta=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ta(e,t)}function Pa(e){var t=Ia();return function(){var n,r=_a(e);if(t){var o=_a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ma(this,n)}}function Ma(e,t){if(t&&("object"===Oa(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Aa(e)}function Aa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ia(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _a(e){return _a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_a(e)}var xa="bindRowsWithHeaders",Ha=210,Na="loose",Da=new Map([["loose",qi],["strict",wa]]),La=function(e){ja(n,e);var t=Pa(n);function n(e){var r;return Ca(this,n),r=t.call(this,e),r.headerIndexes=null,r}return Ra(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xa]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[xa];"string"!==typeof t&&(t=Na);var r=Da.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",(function(t){return e.onModifyRowHeader(t)})),ka(_a(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),ka(_a(n.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}},{key:"destroy",value:function(){ka(_a(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xa}},{key:"PLUGIN_PRIORITY",get:function(){return Ha}}]),n}(Hr),Ba=n("0d2c");function Va(e){return Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Va(e)}function Fa(e){return Ga(e)||za(e)||Ua(e)||Wa()}function Wa(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ua(e,t){if(e){if("string"===typeof e)return Ya(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ya(e,t):void 0}}function za(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ga(e){if(Array.isArray(e))return Ya(e)}function Ya(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $a(e,t,n){return t&&Ka(e.prototype,t),n&&Ka(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qa(){return qa="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Qa(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qa.apply(this,arguments)}function Qa(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ol(e),null===e)break;return e}function Ja(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Za(e,t)}function Za(e,t){return Za=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Za(e,t)}function el(e){var t=rl();return function(){var n,r=ol(e);if(t){var o=ol(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tl(this,n)}}function tl(e,t){if(t&&("object"===Va(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nl(e)}function nl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ol(e){return ol=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ol(e)}function il(e,t,n){al(e,t),t.set(e,n)}function al(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ll(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sl(e,t){var n=fl(e,t,"get");return ul(e,n)}function ul(e,t){return t.get?t.get.call(e):t.value}function cl(e,t,n){var r=fl(e,t,"set");return hl(e,r,n),n}function fl(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function hl(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var dl="collapsibleColumns",pl=290,yl=["nestedHeaders"],vl=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),gl=new WeakMap,bl=function(e){Ja(n,e);var t=el(n);function n(){var e;Xa(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),ll(nl(e),"nestedHeadersPlugin",null),ll(nl(e),"eventManager",new we["a"](nl(e))),ll(nl(e),"headerStateManager",null),il(nl(e),gl,{writable:!0,value:null}),e}return $a(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[dl]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings(),r=t.nestedHeaders;r||Object(Ba["b"])("You need to configure the Nested Headers plugin in order to use collapsible headers."),cl(this,gl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(t,n,r){return e.onBeforeOnCellMouseDown(t,n,r)})),qa(ol(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var e=this.hot.getSettings(),t=e.collapsibleColumns;"boolean"===typeof t?this.headerStateManager.mapState((function(e){return{collapsible:e.origColspan>1}})):Array.isArray(t)&&(this.headerStateManager.mapState((function(){return{collapsible:!1}})),this.headerStateManager.mergeStateWith(t))}qa(ol(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),cl(this,gl,null),this.nestedHeadersPlugin=null,this.clearButtons(),qa(ol(n.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(e){e&&e.parentNode.removeChild(e)};Object(Tn["rangeEach"])(0,e-1,(function(e){var i=t.childNodes[e],a=n.childNodes[e],l=r?r.childNodes[e]:null;Object(Tn["rangeEach"])(0,i.childNodes.length-1,(function(e){var t=i.childNodes[e].querySelector(".collapsibleIndicator");o(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".collapsibleIndicator"),o(t)),r&&l&&l.childNodes[e]&&(t=l.childNodes[e].querySelector(".collapsibleIndicator"),o(t))}))}),!0)}}},{key:"expandSection",value:function(e){this.toggleCollapsibleSection([e],"expand")}},{key:"collapseSection",value:function(e){this.toggleCollapsibleSection([e],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,n=this.headerStateManager.mapNodes((function(n){var r=n.collapsible,o=n.origColspan,i=n.headerLevel,a=n.columnIndex,l=n.isCollapsed;if(!0===r&&o>1&&(l&&"expand"===e||!l&&"collapse"===e))return{row:t.headerStateManager.levelToRowCoords(i),col:a}}));this.toggleCollapsibleSection(n,e)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var n=this;if(!vl.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(Array.isArray(e)){var r=Object(N["arrayFilter"])(e,(function(e){var t=e.row;return t<0})),o=r.length>0;Object(N["arrayEach"])(r,(function(e){var r,i=e.row,a=e.col,l=null!==(r=n.headerStateManager.getHeaderSettings(i,a))&&void 0!==r?r:{},s=l.collapsible,u=l.isCollapsed;if(!s||u&&"collapse"===t||!u&&"expand"===t)return o=!1,!1}));var i=[],a=[];o&&Object(N["arrayEach"])(r,(function(e){var r=e.row,o=e.col,l=n.headerStateManager.triggerNodeModification(t,r,o),s=l.colspanCompensation,u=l.affectedColumns,c=l.rollbackModification;s>0&&(a.push.apply(a,Fa(u)),i.push(c))}));var l=this.getCollapsedColumns(),s=[];"collapse"===t?s=Object(N["arrayUnique"])([].concat(Fa(l),a)):"expand"===t&&(s=Object(N["arrayFilter"])(l,(function(e){return!a.includes(e)})));var u=vl.get(t),c=this.hot.runHooks(u.beforeHook,l,s,o);if(!1!==c){this.hot.batchExecution((function(){Object(N["arrayEach"])(a,(function(e){sl(n,gl).setValueAtIndex(n.hot.toPhysicalColumn(e),u.hideColumn)}))}),!0);var f=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(u.afterHook,l,s,o,f),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else Object(N["arrayEach"])(i,(function(e){e()}))}}},{key:"getCollapsedColumns",value:function(){return sl(this,gl).getHiddenIndexes()}},{key:"generateIndicator",value:function(e,t){var n=this.hot.rootDocument.createElement("div"),r=this.headerStateManager.getHeaderSettings(e,t);return Object(v["addClass"])(n,"collapsibleIndicator"),r.isCollapsed?(Object(v["addClass"])(n,"collapsed"),Object(v["fastInnerText"])(n,"+")):(Object(v["addClass"])(n,"expanded"),Object(v["fastInnerText"])(n,"-")),n}},{key:"onAfterGetColHeader",value:function(e,t){var n,r=t.parentNode,o=r.parentNode,i=-1*o.childNodes.length+Array.prototype.indexOf.call(o.childNodes,r),a=null!==(n=this.headerStateManager.getHeaderSettings(i,e))&&void 0!==n?n:{},l=a.collapsible,s=a.origColspan;if(l&&s>1&&e>=this.hot.getSettings().fixedColumnsStart){var u=this.generateIndicator(i,e);t.querySelector("div:first-child").appendChild(u)}}},{key:"onBeforeOnCellMouseDown",value:function(e,t){Object(v["hasClass"])(e.target,"collapsibleIndicator")&&(Object(v["hasClass"])(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Object(v["hasClass"])(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Object(g["stopImmediatePropagation"])(e))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){cl(this,gl,null),qa(ol(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return dl}},{key:"PLUGIN_PRIORITY",get:function(){return pl}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[dl].concat(yl)}}]),n}(Hr),ml=(n("7dc0"),n("4e92"),n("acdb"),n("f74c"),n("3731")),wl=n("32f9"),Ol=(n("6315"),n("60ed"),n("e86f"));function Cl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cl(Object(n),!0).forEach((function(t){Rl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kl(e,t){return Ml(e)||Pl(e,t)||jl(e,t)||El()}function El(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jl(e,t){if(e){if("string"===typeof e)return Tl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tl(e,t):void 0}}function Tl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pl(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ml(e){if(Array.isArray(e))return e}function Al(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Il(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _l(e,t,n){return t&&Il(e.prototype,t),n&&Il(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var xl=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Hl=!1,Nl=!0,Dl=!0,Ll=function(){function e(t,n){Al(this,e),this.hot=t,this.sortingStates=new Ol["a"],this.sortEmptyCells=Hl,this.indicator=Nl,this.headerAction=Dl,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}return _l(e,[{key:"updateAllColumnsProperties",value:function(e){var t=this;Object(b["isObject"])(e)&&Object(b["objectEach"])(e,(function(e,n){xl.includes(n)&&(t[n]=e)}))}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((function(t){var n=kl(t,1),r=n[0];return r===e}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(e){return Object(b["isObject"])(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;if(null===this.sortingStates)return[];var t=this.sortingStates.getEntries();return t.map((function(t){var n=kl(t,2),r=n[0],o=n[1];return Sl({column:e.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(e){var t=this.getSortOrderOfColumn(e);if(Object(D["isDefined"])(t))return{column:e,sortOrder:t}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Bl="asc",Vl="desc",Fl="colHeader";function Wl(e){if(!1===Object(b["isObject"])(e))return!1;var t=e.column,n=e.sortOrder;return Number.isInteger(t)&&[Bl,Vl].includes(n)}function Ul(e){if(e.some((function(e){return!1===Wl(e)})))return!1;var t=e.map((function(e){var t=e.column;return t}));return new Set(t).size===t.length}function zl(e){if(e!==Vl)return e===Bl?Vl:Bl}function Gl(e){var t=e.querySelector(".".concat(Fl));return t}function Yl(e,t){if(e<0||!t.parentNode)return!1;var n=t.parentNode.parentNode.childNodes,r=Array.from(n).indexOf(t.parentNode)-n.length;return-1===r}function Xl(e,t,n){return-1===e&&t>=0&&!1===Object(g["isRightClick"])(n)}var Kl="ascending",$l="descending",ql="indicatorDisabled",Ql="columnSorting",Jl="sortAction",Zl=new Map([[Bl,Kl],[Vl,$l]]);function es(e,t,n,r){var o=[Ql];if(r&&o.push(Jl),!1===n)return o.push(ql),o;var i=e.getSortOrderOfColumn(t);return Object(D["isDefined"])(i)&&o.push(Zl.get(i)),o}function ts(){return Array.from(Zl.values()).concat(Jl,ql,Ql)}function ns(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rs(e,t,n){return t&&ns(e.prototype,t),n&&ns(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function os(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var is=rs((function e(t){os(this,e),this.data=t,this.next=null,this.prev=null})),as=function(){function e(){os(this,e),this.first=null,this.last=null}return rs(e,[{key:"push",value:function(e){var t=new is(e);if(null===this.first)this.first=t,this.last=t;else{var n=this.last;this.last=t,t.prev=n,n.next=t}}},{key:"unshift",value:function(e){var t=new is(e);if(null===this.first)this.first=t,this.last=t;else{var n=this.first;this.first=t,t.next=n,n.prev=t}}},{key:"inorder",value:function(e){var t=this.first;while(t)e(t),t=t.next}},{key:"remove",value:function(e){if(null===this.first)return!1;var t,n,r=this.first;while(r){if(r.data===e)return t=r.next,n=r.prev,t&&(t.prev=n),n&&(n.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=n),!0;r=r.next}return!1}},{key:"hasCycle",value:function(){var e=this.first,t=this.first;while(1){if(null===e)return!1;if(e=e.next,null===e)return!1;if(e=e.next,t=t.next,e===t)return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(null===this.first)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){function e(t,n){n&&(e(n,n.next),n.next=t)}if(this.first){e(this.first,this.first.next),this.first.next=null;var t=this.first;this.first=this.last,this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){var e,t=this.first.next,n=this.first;while(t)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}}}]),e}(),ls=as,ss=function(e,t){var n=e.toString(),r=t.toString();return n===r?0:n<r?-1:1};function us(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ss,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(r-n)<=1)return[];var o=Math.ceil((n+r)/2);return us(e,t,n,o),us(e,t,o,r),cs(e,t,n,o,r)}function cs(e,t,n,r,o){for(var i=new ls,a=new ls,l=r-n,s=o-r,u=Math.max(l,s),c=o-n,f=0;f<u;f+=1)f<l&&i.push(e[n+f]),f<s&&a.push(e[r+f]);var h=0;while(h<c)i.first&&a.first?t(i.first.data,a.first.data)>0?e[n+h]=a.shift().data:e[n+h]=i.shift().data:i.first?e[n+h]=i.shift().data:e[n+h]=a.shift().data,h+=1;return e}var fs=0,hs=-1,ds=1;function ps(e,t){for(var n=Ms(t),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];us(e,n.apply(void 0,o))}function ys(e,t,n){var r=t.locale;return function(t,o){var i=n.sortEmptyCells;return"string"===typeof t&&(t=t.toLocaleLowerCase(r)),"string"===typeof o&&(o=o.toLocaleLowerCase(r)),t===o?fs:Object(D["isEmpty"])(t)?Object(D["isEmpty"])(o)?fs:i&&"asc"===e?hs:ds:Object(D["isEmpty"])(o)?i&&"asc"===e?ds:hs:isNaN(t)&&!isNaN(o)?"asc"===e?ds:hs:!isNaN(t)&&isNaN(o)?"asc"===e?hs:ds:(isNaN(t)||isNaN(o)||(t=parseFloat(t),o=parseFloat(o)),t<o?"asc"===e?hs:ds:t>o?"asc"===e?ds:hs:fs)}}var vs="default";function gs(e,t,n){return function(t,r){var o=parseFloat(t),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return fs;if(a){if(Object(D["isEmpty"])(t))return"asc"===e?hs:ds;if(Object(D["isEmpty"])(r))return"asc"===e?ds:hs}return isNaN(o)?ds:isNaN(i)?hs:o<i?"asc"===e?hs:ds:o>i?"asc"===e?ds:hs:fs}}var bs="numeric";function ms(e,t,n){var r=t.checkedTemplate,o=t.uncheckedTemplate,i=n.sortEmptyCells;return function(a,l){var s=Object(D["isEmpty"])(a),u=Object(D["isEmpty"])(l),c=s?o:a,f=u?o:l,h=c===o||c===r,d=f===o||f===r;if(!1===i){if(s&&!1===u)return ds;if(!1===s&&u)return hs}return!1===h&&d?"asc"===e?hs:ds:h&&!1===d?"asc"===e?ds:hs:!1===h&&!1===d?ys(e,t,n)(a,l):c===o&&f===r?"asc"===e?hs:ds:c===r&&f===o?"asc"===e?ds:hs:fs}}var ws="checkbox";function Os(e,t,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return fs;if(Object(D["isEmpty"])(r))return Object(D["isEmpty"])(o)?fs:i&&"asc"===e?hs:ds;if(Object(D["isEmpty"])(o))return i&&"asc"===e?ds:hs;var a=t.dateFormat,l=be(r,a),s=be(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?"asc"===e?hs:ds:s.isBefore(l)?"asc"===e?ds:hs:fs:hs:ds}}var Cs="date",Ss=n("179d"),Rs=Object(Ss["a"])("sorting.compareFunctionFactory"),ks=Rs.register,Es=Rs.getItem,js=Rs.hasItem,Ts=Object(Ss["a"])("sorting.mainSortComparator"),Ps=Ts.register,Ms=Ts.getItem;function As(e){return js(e)?Es(e):Es(vs)}function Is(e){return Ds(e)||Ns(e)||xs(e)||_s()}function _s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xs(e,t){if(e){if("string"===typeof e)return Hs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hs(e,t):void 0}}function Hs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ns(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ds(e){if(Array.isArray(e))return e}function Ls(e,t){return function(n,r){var o=Is(n),i=o.slice(1),a=Is(r),l=a.slice(1);return function(n){var r=e[n],o=t[n],a=i[n],s=l[n],u=o.columnSorting,c=u.compareFunctionFactory?u.compareFunctionFactory:As(o.type),f=c(r,o,u)(a,s);return f}(0)}}function Bs(e){return Bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bs(e)}ks(bs,gs),ks(ws,ms),ks(Cs,Os),ks(vs,ys);var Vs=["column"],Fs=["column"];function Ws(e){return Ys(e)||Gs(e)||zs(e)||Us()}function Us(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zs(e,t){if(e){if("string"===typeof e)return Xs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xs(e,t):void 0}}function Gs(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ys(e){if(Array.isArray(e))return Xs(e)}function Xs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ks(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ks(Object(n),!0).forEach((function(t){qs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ks(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qs(e,t){if(null==e)return{};var n,r,o=Js(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Js(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function Zs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tu(e,t,n){return t&&eu(e.prototype,t),n&&eu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nu(){return nu="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ru(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},nu.apply(this,arguments)}function ru(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=cu(e),null===e)break;return e}function ou(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iu(e,t)}function iu(e,t){return iu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},iu(e,t)}function au(e){var t=uu();return function(){var n,r=cu(e);if(t){var o=cu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lu(this,n)}}function lu(e,t){if(t&&("object"===Bs(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return su(e)}function su(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uu(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cu(e){return cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cu(e)}var fu="columnSorting",hu=50,du="append",pu="replace";Ps(fu,Ls),Ne["a"].getSingleton().register("beforeColumnSort"),Ne["a"].getSingleton().register("afterColumnSort");var yu=function(e){ou(n,e);var t=au(n);function n(e){var r;return Zs(this,n),r=t.call(this,e),r.columnStatesManager=null,r.columnMetaCache=null,r.pluginKey=fu,r.indexesSequenceCache=null,r}return tu(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnStatesManager=new Ll(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new no["a"]((function(t){var n=e.hot.toVisualColumn(t);return null===n&&(n=t),e.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(t,n){return e.onAfterOnCellMouseDown(t,n)})),this.addHook("afterInit",(function(){return e.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.hot.view&&this.loadOrSortBySettings(),nu(cu(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this,t=function(t,n){var r=Gl(n);!1!==Yl(t,n)&&null!==r&&e.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((function(){null!==e.indexesSequenceCache&&(e.hot.rowIndexMapper.setIndexesSequence(e.indexesSequenceCache.getValues()),e.hot.rowIndexMapper.unregisterMap(e.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,nu(cu(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){var t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n),o=this.hot.runHooks("beforeColumnSort",t,n,r);!1!==o&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new wl["a"]),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(e){return Object(D["isDefined"])(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(e){var t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}},{key:"areValidSortConfigs",value:function(e){var t=this.hot.countCols();return Ul(e)&&e.every((function(e){var n=e.column;return n<=t&&n>=0}))}},{key:"saveAllSortSettings",value:function(e){var t=this,n=this.columnStatesManager.getAllColumnsProperties(),r=function(e){var n=e.column,r=Qs(e,Vs);return $s({column:t.hot.toPhysicalColumn(n)},r)};n.initialConfig=Object(N["arrayMap"])(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var e=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var n=t.value,r=function(t){var n=t.column,r=Qs(t,Fs);return $s({column:e.hot.toVisualColumn(n)},r)};return Object(D["isDefined"])(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Object(N["arrayMap"])(n.initialConfig,r)),n}},{key:"getColumnNextConfig",value:function(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);if(Object(D["isDefined"])(t)){var n=zl(t);return Object(D["isDefined"])(n)?{column:e,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:zl()}}},{key:"getNextSortConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:du,n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,o=this.getSortConfig(),i=this.getColumnNextConfig(e);if(r){if(Object(D["isUndefined"])(i))return[].concat(Ws(o.slice(0,n)),Ws(o.slice(n+1)));if(t===du)return[].concat(Ws(o.slice(0,n)),Ws(o.slice(n+1)),[i]);if(t===pu)return[].concat(Ws(o.slice(0,n)),[i],Ws(o.slice(n+1)))}return Object(D["isDefined"])(i)?o.concat(i):o}},{key:"getPluginColumnConfig",value:function(e){if(Object(b["isObject"])(e)){var t=e[this.pluginKey];if(Object(b["isObject"])(t))return t}return{}}},{key:"getMergedPluginSettings",value:function(e){var t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns[e])):Object(ml["isFunction"])(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(n,t)}},{key:"getFirstCellSettings",value:function(e){var t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}},{key:"getNumberOfRowsToSort",value:function(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}},{key:"sortByPresetSortStates",value:function(e){var t=this;if(0!==e.length){for(var n=[],r=this.hot.countRows(),o=function(n){return Object(N["arrayMap"])(e,(function(e){return t.hot.getDataAtCell(n,e.column)}))},i=0;i<this.getNumberOfRowsToSort(r);i+=1)n.push([this.hot.toPhysicalRow(i)].concat(o(i)));var a=Object(N["arrayMap"])(n,(function(e){return e[0]}));ps(n,this.pluginKey,Object(N["arrayMap"])(e,(function(e){return e.sortOrder})),Object(N["arrayMap"])(e,(function(e){return t.getFirstCellSettings(e.column)})));for(var l=n.length;l<r;l+=1)n.push([l].concat(o(l)));var s=Object(N["arrayMap"])(n,(function(e){return e[0]})),u=new Map(Object(N["arrayMap"])(a,(function(e,t){return[e,s[t]]}))),c=Object(N["arrayMap"])(this.hot.rowIndexMapper.getIndexesSequence(),(function(e){return u.has(e)?u.get(e):e}));this.hot.rowIndexMapper.setIndexesSequence(c)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var e=this.getAllSavedSortSettings();if(Object(b["isObject"])(e))this.sortBySettings(e);else{var t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}},{key:"sortBySettings",value:function(e){if(Object(b["isObject"])(e)){this.columnStatesManager.updateAllColumnsProperties(e);var t=e.initialConfig;(Array.isArray(t)||Object(b["isObject"])(t))&&this.sort(t)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){var n=Gl(t);if(!1!==Yl(e,t)&&null!==n){var r=this.getFirstCellSettings(e)[this.pluginKey],o=r.indicator,i=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,o,i)}}},{key:"updateHeaderClasses",value:function(e){if(Object(v["removeClass"])(e,ts(e)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Object(v["addClass"])(e,es.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(e){nu(cu(n.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Object(D["isDefined"])(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}},{key:"onAfterLoadData",value:function(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(e,t){var n=this.getFirstCellSettings(t)[this.pluginKey],r=n.headerAction;return r&&"SPAN"===e.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){!1!==Xl(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==Xl(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}},{key:"destroy",value:function(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),nu(cu(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fu}},{key:"PLUGIN_PRIORITY",get:function(){return hu}}]),n}(Hr);n("6b2f"),n("61cc");function vu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bu(e,t,n){return t&&gu(e.prototype,t),n&&gu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var mu,wu=function(){function e(t,n){vu(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return bu(e,[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,n=[],r=e;if(r||"function"!==typeof this.settings)return r||(r=this.settings),Object(N["arrayEach"])(r,(function(e){var r={};t.assignSetting(e,r,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,r,"reversedRowCoords",!1),t.assignSetting(e,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"sourceColumn",e.destinationColumn),t.assignSetting(e,r,"type","sum"),t.assignSetting(e,r,"forceNumeric",!1),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"customFunction",null),t.assignSetting(e,r,"readOnly",!0),t.assignSetting(e,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,n){if("function"===this.settingsType){var r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Object(N["arrayEach"])(o,(function(o){"row"===r&&o.destinationRow>=t&&("insert_row"===e?o.alterRowOffset=n:"remove_row"===e&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=t&&("insert_col"===e?o.alterColumnOffset=n:"remove_col"===e&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var l=e.indexOf("row")>-1?"row":"col",s=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===e.indexOf("move_row"),f=t;Object(N["arrayEach"])(u,(function(e){"row"===l&&e.destinationRow>=f&&(e.alterRowOffset=s*n),"col"===l&&e.destinationColumn>=f&&(e.alterColumnOffset=s*n)})),this.resetAllEndpoints(u,!c),c?Object(N["arrayEach"])(u,(function(e){i.extendEndpointRanges(e,f,r[0],r.length),i.recreatePhysicalRanges(e),i.clearOffsetInformation(e)})):Object(N["arrayEach"])(u,(function(e){i.shiftEndpointCoordinates(e,f)})),a&&this.refreshAllEndpoints()}else{var h=function e(){return i.hot.removeHook("beforeViewRender",e),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",h)}}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,n,r){Object(N["arrayEach"])(e.ranges,(function(e){e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(e){var t=this,n=e.ranges,r=[],o=[];Object(N["arrayEach"])(n,(function(e){var n=[];if(e[1])for(var r=e[0];r<=e[1];r++)n.push(t.hot.toPhysicalRow(r));else n.push(t.hot.toPhysicalRow(e[0]));o.push(n)})),Object(N["arrayEach"])(o,(function(e){var t=[];Object(N["arrayEach"])(e,(function(n,o){0===o?t.push(n):e[o]!==e[o-1]+1&&(t.push(e[o-1]),r.push(t),t=[],t.push(n)),o===e.length-1&&(t.push(n),r.push(t))}))})),e.ranges=r}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,Object(N["arrayEach"])(e.ranges,(function(n){Object(N["arrayEach"])(n,(function(r,o){r>=t&&(n[o]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.some((function(t){var n=t.alterRowOffset||0,r=t.alterColumnOffset||0;return t.destinationRow+n>=e.hot.countRows()||t.destinationColumn+r>=e.hot.countCols()}));r||(this.cellsToSetCache=[],Object(N["arrayEach"])(t,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],Object(N["arrayEach"])(this.getAllEndpoints(),(function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,n=[];this.cellsToSetCache=[],Object(N["arrayEach"])(e,(function(e,r,o){"".concat(e[2]||"")!=="".concat(e[3])&&Object(N["arrayEach"])(t.getAllEndpoints(),(function(e,i){t.hot.propToCol(o[r][1])===e.sourceColumn&&-1===n.indexOf(i)&&n.push(i)}))})),Object(N["arrayEach"])(n,(function(e){t.refreshEndpoint(t.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0,o=[this.hot.toVisualRow(e.destinationRow),this.hot.toVisualColumn(e.destinationColumn)],i=o[0],a=o[1];if(null!==a&&null!==i){var l=this.hot.getCellMeta(i,a);l.readOnly=!1,l.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}},{key:"setEndpointValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1*e.alterRowOffset||0,o=-1*e.alterColumnOffset||0,i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var a=this.hot.toVisualRow(e.destinationRow+r);if(null!==a){var l=this.hot.getCellMeta(a,e.destinationColumn+o);"init"!==t&&l.readOnly===e.readOnly||(l.readOnly=e.readOnly,l.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){Object(Ba["b"])("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}(),Ou=wu,Cu=n("e015");function Su(e){return Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Su(e)}function Ru(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ku(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ju(e,t,n){return t&&Eu(e.prototype,t),n&&Eu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tu(){return Tu="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Pu(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Tu.apply(this,arguments)}function Pu(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Nu(e),null===e)break;return e}function Mu(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Au(e,t)}function Au(e,t){return Au=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Au(e,t)}function Iu(e){var t=Hu();return function(){var n,r=Nu(e);if(t){var o=Nu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _u(this,n)}}function _u(e,t){if(t&&("object"===Su(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return xu(e)}function xu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hu(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Nu(e){return Nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nu(e)}var Du="columnSummary",Lu=220,Bu=function(e){Mu(n,e);var t=Iu(n);function n(e){var r;return ku(this,n),r=t.call(this,e),r.endpoints=null,r}return ju(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Du]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Du],this.endpoints=new Ou(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,r)})),this.addHook("beforeCreateCol",(function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,r)})),this.addHook("beforeRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,r)})),this.addHook("afterCreateCol",(function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,r)})),this.addHook("afterRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove.apply(e,arguments)})),Tu(Nu(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}},{key:"calculateSum",value:function(e){var t=this,n=0;return Object(b["objectEach"])(e.ranges,(function(r){n+=t.getPartialSum(r,e.sourceColumn)})),n}},{key:"getPartialSum",value:function(e,t){var n=0,r=e[1]||e[0],o=null,i=0;do{o=this.getCellValue(r,t)||0;var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a),n+=o||0,r-=1}while(r>=e[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(e,t){var n=this,r=null;return Object(b["objectEach"])(e.ranges,(function(o){var i=n.getPartialMinMax(o,e.sourceColumn,t);if(null===r&&null!==i&&(r=i),null!==i)switch(t){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i);break;default:break}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(e,t,n){var r,o=null,i=e[1]||e[0];do{if(r=this.getCellValue(i,t)||null,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break;default:break}i-=1}while(i>=e[0]);return o}},{key:"countEmpty",value:function(e,t){var n,r=0,o=e[1]||e[0];do{n=this.getCellValue(o,t),n||(r+=1),o-=1}while(o>=e[0]);return r}},{key:"countEntries",value:function(e){var t=this,n=0,r=e.ranges;return Object(b["objectEach"])(r,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=t.countEmpty(r,e.sourceColumn);n+=o,n-=i})),n}},{key:"calculateAverage",value:function(e){var t=this.calculateSum(e),n=this.countEntries(e);return t/n}},{key:"getCellValue",value:function(e,t){var n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t),o=this.hot.getSourceDataAtCell(e,t),i="";if(null!==n&&null!==r&&(i=this.hot.getCellMeta(n,r).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Object(Cu["a"])(mu||(mu=Ru(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),e,t));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Du}},{key:"PLUGIN_PRIORITY",get:function(){return Lu}}]),n}(Hr);function Vu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wu(e,t,n){return t&&Fu(e.prototype,t),n&&Fu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Uu=function(){function e(t,n){Vu(this,e),this.rootDocument=t,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Wu(e,[{key:"setPosition",value:function(e,t){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(t,"px")}},{key:"setSize",value:function(e,t){if(e&&t){var n=this.getInputElement();n.style.width="".concat(e,"px"),n.style.height="".concat(t,"px")}}},{key:"getSize",value:function(){return{width:Object(v["outerWidth"])(this.getInputElement()),height:Object(v["outerHeight"])(this.getInputElement())}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){var t=this.getInputElement();t.readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Object(v["addClass"])(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Object(v["addClass"])(t,e.CLASS_EDITOR),Object(v["addClass"])(n,e.CLASS_INPUT),t.appendChild(n),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}(),zu=Uu,Gu=(n("edaf"),"---------");function Yu(){return{name:Gu}}function Xu(e){return Object(N["arrayMap"])(e,(function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}}))}function Ku(e){return Object(v["hasClass"])(e,"htSeparator")}function $u(e){return Object(v["hasClass"])(e,"htSubmenu")}function qu(e){return Object(v["hasClass"])(e,"htDisabled")}function Qu(e){return Object(v["hasClass"])(e,"htSelectionDisabled")}function Ju(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function Zu(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}function ec(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}function tc(e,t){var n={};return Object(N["arrayEach"])(e,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))}))})),n}function nc(e,t,n,r,o){Object(N["arrayEach"])(e,(function(e){e.forAll((function(e,i){e>=0&&i>=0&&rc(e,i,t,n,r,o)}))}))}function rc(e,t,n,r,o,i){var a=o(e,t),l=r;a.className&&(l="vertical"===n?Zu(a.className,r):ec(a.className,r)),i(e,t,"className",l)}function oc(e,t){var n=!1;return Array.isArray(e)&&Object(N["arrayEach"])(e,(function(e){return e.forAll((function(e,r){if(e>=0&&r>=0&&t(e,r))return n=!0,!1})),n})),n}function ic(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function ac(e,t){return!e.hidden||!("function"===typeof e.hidden&&e.hidden.call(t))}function lc(e,t){for(var n=e.slice(0),r=0;r<n.length;){if(n[r].name!==t)break;n.shift()}return n}function sc(e,t){var n=e.slice(0);return n.reverse(),n=lc(n,t),n.reverse(),n}function uc(e){var t=[];return Object(N["arrayEach"])(e,(function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function cc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gu,n=e.slice(0);return n=lc(n,t),n=sc(n,t),n=uc(n),n}var fc=n("362c");function hc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pc(e,t,n){return t&&dc(e.prototype,t),n&&dc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var yc=250,vc=250,gc=function(){function e(t){hc(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return pc(e,[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")}),vc)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yc;this.showDebounced=Object(ml["debounce"])((function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)}),t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();Object(b["mixin"])(gc,fc["a"]);var bc=gc,mc=n("8034");function wc(e){return wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wc(e)}function Oc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rc(e,t,n){return t&&Sc(e.prototype,t),n&&Sc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kc(){return kc="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ec(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},kc.apply(this,arguments)}function Ec(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=_c(e),null===e)break;return e}function jc(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tc(e,t)}function Tc(e,t){return Tc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tc(e,t)}function Pc(e){var t=Ic();return function(){var n,r=_c(e);if(t){var o=_c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mc(this,n)}}function Mc(e,t){if(t&&("object"===wc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ac(e)}function Ac(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ic(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _c(e){return _c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_c(e)}var xc="comments",Hc=60,Nc=new WeakMap,Dc="comment",Lc="value",Bc="style",Vc="readOnly",Fc=function(e){jc(n,e);var t=Pc(n);function n(e){var r;return Cc(this,n),r=t.call(this,e),r.editor=null,r.displaySwitch=null,r.eventManager=null,r.range={},r.preventEditorAutoSwitch=!1,Nc.set(Ac(r),{tempEditorDimensions:{},cellBelowCursor:null}),r}return Rc(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xc]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new zu(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new we["a"](this)),this.displaySwitch||(this.displaySwitch=new bc(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addToContextMenu(t)})),this.addHook("afterRenderer",(function(t,n,r,o,i,a){return e.onAfterRenderer(t,a)})),this.addHook("afterScrollHorizontally",(function(){return e.hide()})),this.addHook("afterScrollVertically",(function(){return e.hide()})),this.addHook("afterBeginEditing",(function(){return e.hide()})),this.displaySwitch.addLocalHook("hide",(function(){return e.hide()})),this.displaySwitch.addLocalHook("show",(function(t,n){return e.showAtCell(t,n)})),this.registerListeners(),kc(_c(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),kc(_c(n.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){kc(_c(n.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this,t=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(t,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return e.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(t){return e.onEditorMouseDown(t)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(t){return e.onEditorMouseUp(t)}))}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=Object(v["closest"])(e.target,"TD","TBODY");return!!(t&&Object(v["hasClass"])(t,"htCommentCell")&&Object(v["closest"])(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),n="";null!==e&&void 0!==e?n=e:null!==t&&void 0!==t&&(n=t);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,Oc({},Lc,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Dc),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}},{key:"getComment",value:function(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,Lc)}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,Lc)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.range.from,t=e.row,n=e.col;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;var r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(r[Dc]?r[Dc][Lc]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var r=this.hot,o=r.rowIndexMapper,i=r.columnIndexMapper,a=this.range.from,l=a.row,s=a.col,u=o.getRenderableFromVisualIndex(l),c=i.getRenderableFromVisualIndex(s),f=null===u;null===u&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));var h=null===u,d=null===c;u=null!==(e=u)&&void 0!==e?e:0,c=null!==(t=c)&&void 0!==t?t:0;var p=this.hot,y=p.rootWindow,g=p.view._wt,b=g.wtTable,m=b.getCell({row:u,col:c}),w=this.getCommentMeta(l,s,Bc);w?this.editor.setSize(w.width,w.height):this.editor.resetSize();var O=d?0:b.getStretchedColumnWidth(c),C=f&&!h?Object(v["outerHeight"])(m):0,S=m.getBoundingClientRect(),R=S.left,k=S.top,E=S.width,j=S.height,T=this.editor.getSize(),P=T.width,M=T.height,A=this.hot.rootWindow,I=A.innerWidth,_=A.innerHeight,x=this.hot.rootDocument.documentElement,H=R+y.scrollX+O,N=k+y.scrollY+C;this.hot.isRtl()&&(H-=P+O),this.hot.isLtr()&&R+E+P>I?H=R+y.scrollX-P-1:this.hot.isRtl()&&H<-(x.scrollWidth-x.clientWidth)&&(H=R+y.scrollX+O+1),k+M>_&&(N-=M-j+1),this.editor.setPosition(H,N),this.editor.setReadOnlyState(this.getCommentMeta(l,s,Vc))}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;var t=!1,n=e.getTopStartCorner();return this.getCommentMeta(n.row,n.col,Lc)&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,n){var r,o=this.hot.getCellMeta(e,t)[Dc];o?(r=Object(b["deepClone"])(o),Object(b["deepExtend"])(r,n)):r=n,this.hot.setCellMeta(e,t,Dc,r)}},{key:"getCommentMeta",value:function(e,t,n){var r=this.hot.getCellMeta(e,t);if(r[Dc])return r[Dc][n]}},{key:"onMouseDown",value:function(e){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){var t=Object(v["closest"])(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}},{key:"onMouseOver",value:function(e){var t=Nc.get(this),n=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Object(v["hasClass"])(e.target,"wtBorder")||t.cellBelowCursor===e.target)&&this.editor)if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){var r=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(r)}else Object(v["isChildOf"])(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(e,t){t[Dc]&&t[Dc][Lc]&&Object(v["addClass"])(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(e){var t=Nc.get(this);t.tempEditorDimensions={width:Object(v["outerWidth"])(e.target),height:Object(v["outerHeight"])(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=Nc.get(this),n=Object(v["outerWidth"])(e.target),r=Object(v["outerHeight"])(e.target);n===t.tempEditorDimensions.width+1&&r===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,Oc({},Bc,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll((function(t,n){t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll((function(t,n){if(t>=0&&n>=0){var r=!!e.getCommentMeta(t,n,Vc);e.updateCommentMeta(t,n,Oc({},Vc,!r))}}))}},{key:"addToContextMenu",value:function(e){var t=this,n=function(){return t.hot.rowIndexMapper.getRenderableIndexesLength()>0&&t.hot.columnIndexMapper.getRenderableIndexesLength()>0};e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_EDIT_COMMENT"]):t.hot.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ADD_COMMENT"])},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_REMOVE_COMMENT"])},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_READ_ONLY_COMMENT"]),n=oc(this.getSelectedRangeLast(),(function(t,n){var r=e.getCellMeta(t,n)[Dc];if(r&&(r=r[Vc]),r)return!0}));return n&&(t=ic(t)),t},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return!n()||(!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())||!t.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings()[xc];if(Object(b["isObject"])(e))return e.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),kc(_c(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xc}},{key:"PLUGIN_PRIORITY",get:function(){return Hc}}]),n}(Hr);function Wc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zc(e,t,n){return t&&Uc(e.prototype,t),n&&Uc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Gc=function(){function e(t){Wc(this,e),this.hot=t,this.commands={},this.commonCallback=null}return zc(e,[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=e.split(":"),a=i[0],l=2===i.length?i[1]:null,s=this.commands[a];if(!s)throw new Error("Menu command '".concat(a,"' not exists."));if(l&&s.submenu&&(s=Yc(l,s.submenu.items)),!0!==s.disabled&&("function"!==typeof s.disabled||!0!==s.disabled.call(this.hot))&&!Object(b["hasOwnProperty"])(s,"submenu")){var u=[];"function"===typeof s.callback&&u.push(s.callback),"function"===typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(i.join(":")),Object(N["arrayEach"])(u,(function(e){return e.apply(t.hot,r)}))}}}]),e}();function Yc(e,t){var n;return Object(N["arrayEach"])(t,(function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}var Xc=Gc,Kc="alignment";function $c(){return{key:Kc,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT"])},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Kc,":left"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_LEFT"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(Kc,":center"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_CENTER"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(Kc,":right"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htRight"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(Kc,":justify"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{name:Gu},{key:"".concat(Kc,":top"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_TOP"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htTop"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(Kc,":middle"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(Kc,":bottom"),name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM"]),n=oc(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=tc(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,t,r,o),nc(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1}]}}}var qc="clear_column";function Qc(){return{key:qc,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_CLEAR_COLUMN"])},callback:function(e,t){var n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){var e=Ju(this);return!e||!this.selection.isSelectedByColumnHeader()}}}var Jc="col_left";function Zc(){return{key:Jc,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_INSERT_LEFT"])},callback:function(){var e=this.selection.isSelectedByCorner(),t=this.isRtl()?this.countCols():0;if(!e){var n=this.getSelectedRangeLast();if(Object(D["isDefined"])(n)){var r=n.getTopLeftCorner(),o=r.col;t=this.isRtl()?o+1:o}}this.alter("insert_col",t,1,"ContextMenu.columnLeft"),e&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Ju(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var ef="col_right";function tf(){return{key:ef,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_INSERT_RIGHT"])},callback:function(){var e=this.selection.isSelectedByCorner(),t=this.isRtl()?0:this.countCols();if(!e){var n=this.getSelectedRangeLast();if(Object(D["isDefined"])(n)){var r=n.getTopRightCorner(),o=r.col;t=this.isRtl()?o:o+1}}this.alter("insert_col",t,1,"ContextMenu.columnRight"),e&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Ju(this);return!e||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden:function(){return!this.getSettings().allowInsertColumn}}}var nf="make_read_only";function rf(){return{key:nf,name:function(){var e=this,t=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_READ_ONLY"]),n=oc(this.getSelectedRange(),(function(t,n){return e.getCellMeta(t,n).readOnly}));return n&&(t=ic(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=oc(t,(function(t,n){return e.getCellMeta(t,n).readOnly}));Object(N["arrayEach"])(t,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&e.setCellMeta(t,r,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}var of="redo";function af(){return{key:of,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_REDO"])},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var lf=n("103a");function sf(e,t){return df(e)||hf(e,t)||cf(e,t)||uf()}function uf(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cf(e,t){if(e){if("string"===typeof e)return ff(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ff(e,t):void 0}}function ff(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hf(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function df(e){if(Array.isArray(e))return e}var pf="remove_col";function yf(){return{key:pf,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=sf(e[0],4),r=n[1],o=n[3];r-o!==0&&(t=1)}return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_REMOVE_COLUMN"],t)},callback:function(){this.alter("remove_col",Object(lf["f"])(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Ju(this);if(!e)return!0;var t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function vf(e,t){return Of(e)||wf(e,t)||bf(e,t)||gf()}function gf(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bf(e,t){if(e){if("string"===typeof e)return mf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mf(e,t):void 0}}function mf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wf(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Of(e){if(Array.isArray(e))return e}var Cf="remove_row";function Sf(){return{key:Cf,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=vf(e[0],3),r=n[0],o=n[2];r-o!==0&&(t=1)}return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_REMOVE_ROW"],t)},callback:function(){this.alter("remove_row",Object(lf["g"])(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var e=Ju(this);if(!e)return!0;var t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Rf="row_above";function kf(){return{key:Rf,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ROW_ABOVE"])},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;if(!n){var o=t[Math.max(t.length-1,0)];r=o.start.row}this.alter("insert_row",r,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){var e=Ju(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Ef="row_below";function jf(){return{key:Ef,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_ROW_BELOW"])},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;if(n)r=this.countRows();else{var o,i=t[Math.max(t.length-1,0)],a=null===i||void 0===i||null===(o=i.end)||void 0===o?void 0:o.row;r=Object(D["isDefined"])(a)?a+1:0}this.alter("insert_row",r,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){var e=Ju(this);return!e||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}var Tf="no_items";function Pf(){return{key:Tf,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_NO_ITEMS"])},disabled:!0,isCommand:!1}}var Mf,Af="undo";function If(){return{key:Af,name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_UNDO"])},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function _f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xf=[Rf,Ef,Jc,ef,qc,Cf,pf,Af,of,nf,Kc,Gu,Tf],Hf=(Mf={},_f(Mf,Gu,Yu),_f(Mf,Tf,Pf),_f(Mf,Rf,kf),_f(Mf,Ef,jf),_f(Mf,Jc,Zc),_f(Mf,ef,tf),_f(Mf,qc,Qc),_f(Mf,Cf,Sf),_f(Mf,pf,yf),_f(Mf,Af,If),_f(Mf,of,af),_f(Mf,nf,rf),_f(Mf,Kc,$c),Mf);function Nf(){var e={};return Object(b["objectEach"])(Hf,(function(t,n){e[n]=t()})),e}function Df(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bf(e,t,n){return t&&Lf(e.prototype,t),n&&Lf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Vf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Df(this,e),this.hot=t,this.predefinedItems=Nf(),this.defaultOrderPattern=n}return Bf(e,[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,Object(b["objectEach"])(e,(function(e,r){var o="";e.name===Gu?(n[Gu]=e,o=Gu):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Ff(e,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function Ff(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Object(b["isObject"])(o)?Object(b["objectEach"])(o,(function(e,t){var o=n["string"===typeof e?e:t];o||(o=e),Object(b["isObject"])(e)?Object(b["extend"])(o,e):"string"===typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),r.push(o)})):Object(N["arrayEach"])(o,(function(e,t){var o=n[e];!o&&xf.indexOf(e)>=0||(o||(o={name:e,key:"".concat(t)}),Object(b["isObject"])(e)&&Object(b["extend"])(o,e),void 0===o.key&&(o.key=t),r.push(o))})),r}var Wf=Vf;n("2cf3");function Uf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gf(e,t,n){return t&&zf(e.prototype,t),n&&zf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Yf=function(){function e(t,n){Uf(this,e);var r,o,i,a,l,s,u=Object(v["getWindowScrollTop"])(n),c=Object(v["getWindowScrollLeft"])(n);this.rootWindow=n,this.type=this.getSourceType(t),"literal"===this.type?(r=parseInt(t.top,10),i=parseInt(t.left,10),l=t.height||0,s=t.width||0,o=r,a=i,r+=u,i+=c):"event"===this.type&&(r=parseInt(t.pageY,10),i=parseInt(t.pageX,10),l=t.target.clientHeight,s=t.target.clientWidth,o=r-u,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=l,this.cellWidth=s}return Gf(e,[{key:"getSourceType",value:function(e){var t="literal";return e instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}},{key:"fitsOnRight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}]),e}(),Xf=Yf,Kf=n("c76a"),$f=n("304f");function qf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qf(Object(n),!0).forEach((function(t){Jf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function th(e,t,n){return t&&eh(e.prototype,t),n&&eh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var nh=215,rh="menu",oh=rh,ih=function(){function e(t,n){Zf(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:nh,container:this.hot.rootDocument.documentElement},this.eventManager=new we["a"](this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return th(e,[{key:"registerEvents",value:function(){var e=this,t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=Object(v["getParentWindow"])(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[e]=t}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=Object(ml["debounce"])((function(t){return e.openSubMenu(t)}),300),n=this.options.minWidth||nh,r=!1,o=Object(N["arrayFilter"])(this.menuItems,(function(t){return t.key===Tf&&(r=!0),ac(t,e.hot)}));if(o.length<1&&!r)o.push(Nf()[Tf]);else if(0===o.length)return;o=cc(o,Gu);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return Object(D["isDefined"])(e)&&e<n?n:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,n,r,o,i,a){return e.menuItemRenderer(t,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)},rowHeights:function(e){return o[e].name===Gu?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),Object($f["isWindowsOS"])()&&i&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(i=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){Object($f["isWindowsOS"])()&&Object(g["isRightClick"])(t)||!i||!e.hasSelectedItem()||(Object($f["isMobileBrowser"])()||Object($f["isIpadOS"])()?setTimeout((function(){return e.close(!0)}),325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Kf["a"](this.container,a),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var l=this.hotMenu.getShortcutManager(),s=l.addContext(oh),u={group:rh},c=Qf(Qf({},u),{},{runOnlyIf:function(t){return!1===Object(v["isInput"])(t.target)||!1===e.container.contains(t.target)}});l.setActiveContextName("menu"),s.addShortcuts([{keys:[["Escape"]],callback:function(){e.keyEvent=!0,e.close(),e.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectNextCell(t[0],t[1]):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectPrevCell(t[0],t[1]):e.selectLastCell(),e.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var t=e.hotMenu.getSelectedLast();if(e.keyEvent=!0,t){var n=e.openSubMenu(t[0]);n&&n.selectFirstCell()}e.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t&&e.isSubMenu()&&(e.close(),e.parentMenu&&e.parentMenu.hotMenu.listen()),e.keyEvent=!1}},{keys:[["Enter"]],callback:function(t){var n=e.hotMenu.getSelectedLast();e.keyEvent=!0,e.hotMenu.getSourceDataAtRow(n[0]).submenu||(e.executeCommand(t),e.close(!0)),e.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(-e.hotMenu.countVisibleRows(),0):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(e.hotMenu.countVisibleRows(),0):e.selectLastCell(),e.keyEvent=!1}}],c),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!$u(n))return!1;var r=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;Object(N["arrayEach"])(this.hotMenu.getData(),(function(t,n){return e.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var n=this.hot.getSelectedRange(),r=n?Xu(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,n=e.name,r=e.disabled,o=e.submenu,i=!0===r||"function"===typeof r&&!0===r.call(this.hot);return!1===t||n===Gu||!0===i||o}},{key:"setPosition",value:function(e){var t=new Xf(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setHorizontalPositionForRtl",value:function(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}},{key:"setHorizontalPositionForLtr",value:function(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}},{key:"setPositionAboveCursor",value:function(e){var t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(t,"px")}},{key:"setPositionBelowCursor",value:function(e){var t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top="".concat(t,"px")}},{key:"setPositionOnRightOfCursor",value:function(e){var t=e.left;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.right;t+=e.cellWidth+r-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left="".concat(t,"px")}},{key:"setPositionOnLeftOfCursor",value:function(e){var t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.left;t-=e.left-r}this.container.style.left="".concat(t,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);Ku(e)||qu(e)||Qu(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);Ku(t)||qu(t)||Qu(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}},{key:"selectNextCell",value:function(e,t){var n=e+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;r&&(Ku(r)||qu(r)||Qu(r)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"selectPrevCell",value:function(e,t){var n=e-1,r=n>=0?this.hotMenu.getCell(n,t):null;r&&(Ku(r)||qu(r)||Qu(r)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"menuItemRenderer",value:function(e,t,n,r,o,i){var a=this,l=e.getSourceDataAtRow(n),s=this.hot.rootDocument.createElement("div"),u=function(e){return Object(b["hasOwnProperty"])(e,"submenu")},c=function(e){return new RegExp(Gu,"i").test(e.name)},f=function(e){return!0===e.disabled||"function"===typeof e.disabled&&!0===e.disabled.call(a.hot)},h=function(e){return e.disableSelection},d=i;"function"===typeof d&&(d=d.call(this.hot)),Object(v["empty"])(t),Object(v["addClass"])(s,"htItemWrapper"),t.appendChild(s),c(l)?Object(v["addClass"])(t,"htSeparator"):"function"===typeof l.renderer?(Object(v["addClass"])(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,s,n,r,o,d))):Object(v["fastInnerHTML"])(s,d),f(l)?(Object(v["addClass"])(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):h(l)?(Object(v["addClass"])(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):u(l)?(Object(v["addClass"])(t,"htSubmenu"),h(l)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,r,void 0,void 0,!1,!1)}))):(Object(v["removeClass"])(t,["htSubmenu","htDisabled"]),h(l)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,r,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=t;return r&&(Object(ml["isFunction"])(r)&&(r=r.call(this.hot),r=null===r||Object(D["isUndefined"])(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),e=n.querySelector(".".concat(this.options.className,".").concat(r))),e||(e=n.createElement("div"),Object(v["addClass"])(e,"htMenu ".concat(this.options.className)),r&&Object(v["addClass"])(e,r),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view._wt.wtTable,t=this.hotMenu.getSettings().data,n=e.hider.style,r=e.holder.style,o=parseInt(n.width,10),i=Object(N["arrayReduce"])(t,(function(e,t){return e+(t.name===Gu?1:26)}),0);r.width="".concat(o+3,"px"),r.height="".concat(i+3,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(e,t,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Object(v["isChildOf"])(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Object(v["isChildOf"])(e.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&Object(v["hasClass"])(e.target,"htCore")&&Object(v["isChildOf"])(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}]),e}();Object(b["mixin"])(ih,fc["a"]);var ah=ih;function lh(e){return lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lh(e)}function sh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ch(e,t,n){return t&&uh(e.prototype,t),n&&uh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function fh(){return fh="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=hh(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},fh.apply(this,arguments)}function hh(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=mh(e),null===e)break;return e}function dh(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ph(e,t)}function ph(e,t){return ph=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ph(e,t)}function yh(e){var t=bh();return function(){var n,r=mh(e);if(t){var o=mh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vh(this,n)}}function vh(e,t){if(t&&("object"===lh(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gh(e)}function gh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function mh(e){return mh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mh(e)}var wh="contextMenu",Oh=70;Ne["a"].getSingleton().register("afterContextMenuDefaultOptions"),Ne["a"].getSingleton().register("beforeContextMenuShow"),Ne["a"].getSingleton().register("afterContextMenuShow"),Ne["a"].getSingleton().register("afterContextMenuHide"),Ne["a"].getSingleton().register("afterContextMenuExecute");var Ch=function(e){dh(n,e);var t=yh(n);function n(e){var r;return sh(this,n),r=t.call(this,e),r.eventManager=new we["a"](gh(r)),r.commandExecutor=new Xc(r.hot),r.itemsFactory=null,r.menu=null,r}return ch(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wh]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[wh];"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new ah(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),this.addHook("afterOnCellContextMenu",(function(t){return e.onAfterOnCellContextMenu(t)})),fh(mh(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fh(mh(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),fh(mh(n.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(e){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;t=i-Object(v["getWindowScrollTop"])(e.view),n=a-Object(v["getWindowScrollLeft"])(e.view)}else t=-1*Object(v["getWindowScrollTop"])(this.menu.hotMenu.rootWindow),n=-1*Object(v["getWindowScrollLeft"])(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(e){var t;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"prepareMenuItems",value:function(){var e=this;this.itemsFactory=new Wf(this.hot,n.DEFAULT_ITEMS);var t=this.hot.getSettings()[wh],r={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),Object(N["arrayEach"])(o,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}},{key:"onAfterOnCellContextMenu",value:function(e){var t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders;function o(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}var i=e.target;this.close(),Object(v["hasClass"])(i,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(n||r||o(i)||Object(v["hasClass"])(i,"current")&&Object(v["hasClass"])(i,"wtBorder"))&&this.open(e))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),fh(mh(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wh}},{key:"PLUGIN_PRIORITY",get:function(){return Oh}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Rf,Ef,Gu,Jc,ef,Gu,Cf,pf,Gu,Af,of,Gu,nf,Gu,Kc]}}]),n}(Hr);Ch.SEPARATOR={name:Gu};var Sh=n("8d66");function Rh(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_COPY"])},callback:function(){e.copy()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function kh(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_CUT"])},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function Eh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Th(e,t,n){return t&&jh(e.prototype,t),n&&jh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ph=function(){function e(){Eh(this,e),this.data={}}return Th(e,[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),e}();function Mh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ah(e,t,n){return t&&Mh(e.prototype,t),n&&Mh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ih(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _h=Ah((function e(){Ih(this,e),this.clipboardData=new Ph}));function xh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nh(e,t,n){return t&&Hh(e.prototype,t),n&&Hh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Dh=function(){function e(t){xh(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new we["a"](this),this.listenersCount=new WeakSet,this.container=t}return Nh(e,[{key:"useSecondaryElement",value:function(){var e=zh(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),Wh(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),Wh(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object($f["isMobileBrowser"])()||Object(v["selectElementIfAllowed"])(this.mainElement)}}]),e}();Object(b["mixin"])(Dh,fc["a"]);var Lh=new WeakMap;function Bh(e){var t=new Dh(e),n=Lh.get(e);return n=isNaN(n)?0:n,Lh.set(e,n+1),t}function Vh(e){e.eventManager.clear()}var Fh=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function Wh(e,t,n){e.addEventListener(t,"copy",Fh("copy",n)),e.addEventListener(t,"cut",Fh("cut",n)),e.addEventListener(t,"paste",Fh("paste",n))}var Uh=new WeakMap;function zh(e){var t=Uh.get(e);if(t)return t.parentElement||e.appendChild(t),t;var n=e.defaultView?e:e.ownerDocument,r=n.createElement("textarea");return Uh.set(e,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",e.appendChild(r),r}function Gh(e){if(e instanceof Dh){var t=Lh.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),Vh(e),t<=0){t=0;var n=Uh.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),Uh.delete(e.container)),e.mainElement=null}Lh.set(e.container,t)}}var Yh=n("0f99");function Xh(e,t){return Jh(e)||Qh(e,t)||$h(e,t)||Kh()}function Kh(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $h(e,t){if(e){if("string"===typeof e)return qh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qh(e,t):void 0}}function qh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qh(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Jh(e){if(Array.isArray(e))return e}function Zh(e){return Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(e)}function ed(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function td(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nd(e,t,n){return t&&td(e.prototype,t),n&&td(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rd(){return rd="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=od(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},rd.apply(this,arguments)}function od(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=fd(e),null===e)break;return e}function id(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ad(e,t)}function ad(e,t){return ad=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ad(e,t)}function ld(e){var t=cd();return function(){var n,r=fd(e);if(t){var o=fd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sd(this,n)}}function sd(e,t){if(t&&("object"===Zh(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ud(e)}function ud(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cd(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function fd(e){return fd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fd(e)}Ne["a"].getSingleton().register("afterCopyLimit"),Ne["a"].getSingleton().register("modifyCopyableRange"),Ne["a"].getSingleton().register("beforeCut"),Ne["a"].getSingleton().register("afterCut"),Ne["a"].getSingleton().register("beforePaste"),Ne["a"].getSingleton().register("afterPaste"),Ne["a"].getSingleton().register("beforeCopy"),Ne["a"].getSingleton().register("afterCopy");var hd="copyPaste",dd=80,pd=["fragmentSelection"],yd=1/0,vd=1/0,gd=new WeakMap,bd=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),md=function(e){id(n,e);var t=ld(n);function n(e){var r;return ed(this,n),r=t.call(this,e),r.columnsLimit=vd,r.copyableRanges=[],r.focusableElement=void 0,r.pasteMode="overwrite",r.rowsLimit=yd,r.uiContainer=r.hot.rootDocument.body,gd.set(ud(r),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),r}return nd(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hd]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings(),r=t[hd],o=t.fragmentSelection,i=gd.get(this);i.isFragmentSelectionEnabled=!!o,"object"===Zh(r)&&(this.pasteMode=r.pasteMode||this.pasteMode,this.rowsLimit=isNaN(r.rowsLimit)?this.rowsLimit:r.rowsLimit,this.columnsLimit=isNaN(r.columnsLimit)?this.columnsLimit:r.columnsLimit,this.uiContainer=r.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=Bh(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),rd(fd(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),rd(fd(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&Gh(this.focusableElement),rd(fd(n.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var e=gd.get(this);e.isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){var e=gd.get(this);e.isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],r=[],o=[];return Object(N["arrayEach"])(e,(function(e){Object(Tn["rangeEach"])(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),Object(Tn["rangeEach"])(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),Object(N["arrayEach"])(r,(function(e){var r=[];Object(N["arrayEach"])(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),Object(Sh["b"])(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],r=[],o=[];return Object(N["arrayEach"])(e,(function(e){Object(Tn["rangeEach"])(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),Object(Tn["rangeEach"])(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),Object(N["arrayEach"])(r,(function(e){var r=[];Object(N["arrayEach"])(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new _h;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopStartCorner(),n=e.getBottomEndCorner(),r=t.row,o=t.col,i=n.row,a=n.col,l=Math.min(i,r+this.rowsLimit-1),s=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:l,endCol:s}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===l&&a===s||this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){var n=e.length,r=e[0].length,o=[],i=t.getTopStartCorner(),a=i.row,l=i.col,s=t.getBottomEndCorner(),u=s.row,c=s.col,f=a,h=l,d=a,p=l;while(o.length<n||f<=u){var y=this.hot.getCellMeta(f,l),v=y.skipRowOnPaste,g=y.visualRow;if(f=g+1,!0!==v){d=g,h=l;var b=[],m=o.length%n;while(b.length<r||h<=c){var w=this.hot.getCellMeta(a,h),O=w.skipColumnOnPaste,C=w.visualCol;if(h=C+1,!0!==O){p=C;var S=b.length%r;b.push(e[m][S])}}o.push(b)}}return this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,d,p]}}},{key:"onCopy",value:function(e){var t=gd.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",n,this.copyableRanges);if(r){var o=Object(Sh["b"])(n);if(e&&e.clipboardData){var i=Object(Yh["_dataToHTML"])(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[bd,i].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=gd.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges),r=!!this.hot.runHooks("beforeCut",n,this.copyableRanges);if(r){var o=Object(Sh["b"])(n);if(e&&e.clipboardData){var i=Object(Yh["_dataToHTML"])(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[bd,i].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&"undefined"!==typeof e.clipboardData){var n=Object(L["sanitize"])(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){var r=Object(Yh["htmlToGridSettings"])(n,this.hot.rootDocument);t=r.data}else t=e.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof t&&(t=Object(Sh["a"])(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var o=this.populateValues(t),i=Xh(o,4),a=i[0],l=i[1],s=i[2],u=i[3];this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:"---------"},Rh(this),kh(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=gd.get(this),t=e.isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),t&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(v["getSelectionText"])()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(Gh(this.focusableElement),this.focusableElement=null),rd(fd(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hd}},{key:"SETTING_KEYS",get:function(){return[hd].concat(pd)}},{key:"PLUGIN_PRIORITY",get:function(){return dd}}]),n}(Hr);function wd(e,t){return"border_row".concat(e,"col").concat(t)}function Od(){return{width:1,color:"#000"}}function Cd(){return{hide:!0}}function Sd(){return{width:1,color:"#000",cornerVisible:!1}}function Rd(e){var t,n;(Object(D["isDefined"])(e.start)||Object(D["isDefined"])(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(Object(D["isDefined"])(e.end)||Object(D["isDefined"])(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function kd(e){return Object(D["isDefined"])(e.start)&&(e.left=e.start),Object(D["isDefined"])(e.end)&&(e.right=e.end),e}function Ed(e,t){return{id:wd(e,t),border:Sd(),row:e,col:t,top:Cd(),bottom:Cd(),start:Cd(),end:Cd()}}function jd(e,t){return Object(b["hasOwnProperty"])(t,"border")&&t.border&&(e.border=t.border),Object(b["hasOwnProperty"])(t,"top")&&Object(D["isDefined"])(t.top)&&(t.top?(Object(b["isObject"])(t.top)||(t.top=Od()),e.top=t.top):(t.top=Cd(),e.top=t.top)),Object(b["hasOwnProperty"])(t,"bottom")&&Object(D["isDefined"])(t.bottom)&&(t.bottom?(Object(b["isObject"])(t.bottom)||(t.bottom=Od()),e.bottom=t.bottom):(t.bottom=Cd(),e.bottom=t.bottom)),Object(b["hasOwnProperty"])(t,"start")&&Object(D["isDefined"])(t.start)&&(t.start?(Object(b["isObject"])(t.start)||(t.start=Od()),e.start=t.start):(t.start=Cd(),e.start=t.start)),Object(b["hasOwnProperty"])(t,"end")&&Object(D["isDefined"])(t.end)&&(t.end?(Object(b["isObject"])(t.end)||(t.end=Od()),e.end=t.end):(t.end=Cd(),e.end=t.end)),e}function Td(e,t){var n=!1;return Object(N["arrayEach"])(e.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var i=e.getCellMeta(r,o).borders;if(i){if(!t)return n=!0,!1;if(!Object(b["hasOwnProperty"])(i[t],"hide")||!1===i[t].hide)return n=!0,!1}}}))})),n}function Pd(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Md(e){return e.some((function(e){return Object(D["isDefined"])(e.left)||Object(D["isDefined"])(e.right)}))}function Ad(e){return e.some((function(e){return Object(D["isDefined"])(e.start)||Object(D["isDefined"])(e.end)}))}var Id=new Map([["left","start"],["right","end"]]);function _d(e){var t;return null!==(t=Id.get(e))&&void 0!==t?t:e}function xd(e){return{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_BORDERS_TOP"]),t=Td(this,"top");return t&&(e=Pd(e)),e},callback:function(t,n){var r=Td(this,"top");e.prepareBorder(n,"top",r)}}}function Hd(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var e=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_BORDERS_RIGHT"]),n=Td(this,t);return n&&(e=Pd(e)),e},callback:function(n,r){var o=Td(this,t);e.prepareBorder(r,t,o)}}}function Nd(e){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_BORDERS_BOTTOM"]),t=Td(this,"bottom");return t&&(e=Pd(e)),e},callback:function(t,n){var r=Td(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function Dd(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var e=this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_BORDERS_LEFT"]),n=Td(this,t);return n&&(e=Pd(e)),e},callback:function(n,r){var o=Td(this,t);e.prepareBorder(r,t,o)}}}function Ld(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_REMOVE_BORDERS"])},callback:function(t,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Td(this)}}}function Bd(e){return Bd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bd(e)}function Vd(e,t){return Gd(e)||zd(e,t)||Wd(e,t)||Fd()}function Fd(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wd(e,t){if(e){if("string"===typeof e)return Ud(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ud(e,t):void 0}}function Ud(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zd(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Gd(e){if(Array.isArray(e))return e}function Yd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kd(e,t,n){return t&&Xd(e.prototype,t),n&&Xd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $d(){return $d="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=qd(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},$d.apply(this,arguments)}function qd(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=rp(e),null===e)break;return e}function Qd(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jd(e,t)}function Jd(e,t){return Jd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jd(e,t)}function Zd(e){var t=np();return function(){var n,r=rp(e);if(t){var o=rp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ep(this,n)}}function ep(e,t){if(t&&("object"===Bd(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return tp(e)}function tp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function np(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rp(e)}function op(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ip="customBorders",ap=90,lp=function(e){Qd(n,e);var t=Zd(n);function n(){var e;Yd(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),op(tp(e),"savedBorders",[]),e}return Kd(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ip]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),$d(rp(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),$d(rp(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),$d(rp(n.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var n=this,r=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),o=Rd(t));var i=Object(lf["c"])(e),a=Object(lf["e"])(i);Object(N["arrayEach"])(e,(function(e){for(var t=a(e),i=Vd(t,4),l=i[0],s=i[1],u=i[2],c=i[3],f=function(e){for(var t=function(t){Object(N["arrayEach"])(r,(function(r){n.prepareBorderFromCustomAdded(e,t,o,_d(r))}))},i=s;i<=c;i+=1)t(i)},h=l;h<=u;h+=1)f(h)})),this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var n=Object(lf["c"])(e),r=Object(lf["e"])(n),o=[];return Object(N["arrayEach"])(e,(function(e){for(var n=r(e),i=Vd(n,4),a=i[0],l=i[1],s=i[2],u=i[3],c=function(e){for(var n=function(n){Object(N["arrayEach"])(t.savedBorders,(function(t){t.row===e&&t.col===n&&o.push(kd(t))}))},r=l;r<=u;r+=1)n(r)},f=a;f<=s;f+=1)c(f)})),o}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):(Object(N["arrayEach"])(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange(),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(e,t){var n=this.checkSavedBorders(e);n||this.savedBorders.push(e);var r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col)),o=this.checkCustomSelections(e,r,t);o||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,n,r){var o=this.hot.countRows(),i=this.hot.countCols();if(!(e>=o||t>=i)){var a=Ed(e,t);n&&(a=jd(a,n),Object(N["arrayEach"])(this.hot.selection.highlight.customSelections,(function(e){if(a.id===e.settings.id)return Object.assign(e.settings,n),a.id=e.settings.id,a.top=e.settings.top,a.bottom=e.settings.bottom,a.start=e.settings.start,a.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",kd(a)),this.insertBorderIntoSettings(a,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(e,t){var n=this,r=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);Object(Tn["rangeEach"])(e.from.row,r,(function(r){Object(Tn["rangeEach"])(e.from.col,o,(function(o){var i=Ed(r,o),a=0;r===e.from.row&&Object(b["hasOwnProperty"])(t,"top")&&(a+=1,i.top=t.top),r===e.to.row&&Object(b["hasOwnProperty"])(t,"bottom")&&(a+=1,i.bottom=t.bottom),o===e.from.col&&Object(b["hasOwnProperty"])(t,"start")&&(a+=1,i.start=t.start),o===e.to.col&&Object(b["hasOwnProperty"])(t,"end")&&(a+=1,i.end=t.end),a>0&&(n.hot.setCellMeta(r,o,"borders",kd(i)),n.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(e,t){var n=wd(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,n,r){var o=this.hot.getCellMeta(e,t).borders;if(o=o&&void 0!==o.border?Rd(o):Ed(e,t),r){o[n]=Cd();var i=this.countHide(o);if(4===i)this.removeAllBorders(e,t);else{var a=this.checkCustomSelectionsFromContextMenu(o,n,r);a||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",kd(o))}}else{o[n]=Od();var l=this.checkCustomSelectionsFromContextMenu(o,n,r);l||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",kd(o))}}},{key:"prepareBorder",value:function(e,t,n){var r=this;Object(N["arrayEach"])(e,(function(e){var o=e.start,i=e.end;if(o.row===i.row&&o.col===i.col)"noBorders"===t?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":Object(Tn["rangeEach"])(o.col,i.col,(function(e){Object(Tn["rangeEach"])(o.row,i.row,(function(t){r.removeAllBorders(t,e)}))}));break;case"top":Object(Tn["rangeEach"])(o.col,i.col,(function(e){r.setBorder(o.row,e,t,n)}));break;case"bottom":Object(Tn["rangeEach"])(o.col,i.col,(function(e){r.setBorder(i.row,e,t,n)}));break;case"start":Object(Tn["rangeEach"])(o.row,i.row,(function(e){r.setBorder(e,o.col,t,n)}));break;case"end":Object(Tn["rangeEach"])(o.row,i.row,(function(e){r.setBorder(e,i.col,t,n)}));break;default:break}}))}},{key:"createCustomBorders",value:function(e){var t=this;Object(N["arrayEach"])(e,(function(e){var n=Rd(e);e.range?t.prepareBorderFromCustomAddedRange(e.range,n):t.prepareBorderFromCustomAdded(e.row,e.col,n)}))}},{key:"countHide",value:function(e){var t=e.top,n=e.bottom,r=e.start,o=e.end,i=[t,n,r,o];return Object(N["arrayReduce"])(i,(function(e,t){var n=e;return t&&t.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=Object(N["arrayMap"])(this.hot.selection.highlight.customSelections,(function(e){return e.settings.id})).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}},{key:"clearNullCellRange",value:function(){var e=this;Object(N["arrayEach"])(this.hot.selection.highlight.customSelections,(function(t,n){if(null===t.cellRange)return e.hot.selection.highlight.customSelections[n].destroy(),e.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var e=this;Object(N["arrayEach"])(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange()}))}},{key:"spliceBorder",value:function(e){var t=Object(N["arrayMap"])(this.savedBorders,(function(e){return e.id})).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}},{key:"checkSavedBorders",value:function(e){var t=this,n=!1,r=this.countHide(e);return 4===r?(this.spliceBorder(e.id),n=!0):Object(N["arrayEach"])(this.savedBorders,(function(r,o){if(e.id===r.id)return t.savedBorders[o]=e,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,t,n){var r=!1;return Object(N["arrayEach"])(this.hot.selection.highlight.customSelections,(function(o){if(e.id===o.settings.id)return Object(b["objectEach"])(o.instanceBorders,(function(e){e.toggleHiddenClass(t,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(e,t,n){var r=this.countHide(e),o=!1;return 4===r?(this.removeAllBorders(e.row,e.col),o=!0):Object(N["arrayEach"])(this.hot.selection.highlight.customSelections,(function(r){if(e.id===r.settings.id)return r.visualCellRange=t,r.commit(),n&&Object(b["objectEach"])(r.instanceBorders,(function(t){t.changeBorderStyle(n,e)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings()[ip];if(Array.isArray(e)){var t=Object(b["deepClone"])(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(e){var t=Md(e),n=Ad(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(e){this.hot.getSettings()[ip]&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_BORDERS"])},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[xd(this),Hd(this),Nd(this),Dd(this),Ld(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){$d(rp(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ip}},{key:"PLUGIN_PRIORITY",get:function(){return ap}}]),n}(Hr);function sp(e){return sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sp(e)}function up(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fp(e,t,n){return t&&cp(e.prototype,t),n&&cp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hp(){return hp="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=dp(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},hp.apply(this,arguments)}function dp(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=wp(e),null===e)break;return e}function pp(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yp(e,t)}function yp(e,t){return yp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yp(e,t)}function vp(e){var t=mp();return function(){var n,r=wp(e);if(t){var o=wp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gp(this,n)}}function gp(e,t){if(t&&("object"===sp(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bp(e)}function bp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function wp(e){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wp(e)}var Op="dragToScroll",Cp=100,Sp=function(e){pp(n,e);var t=vp(n);function n(e){var r;return up(this,n),r=t.call(this,e),r.eventManager=new we["a"](bp(r)),r.boundaries=null,r.callback=null,r.listening=!1,r}return fp(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Op]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(t){return e.setupListening(t)})),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.setupListening(t)})),this.registerEvents(),hp(wp(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),hp(wp(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),hp(wp(n.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"check",value:function(e,t){var n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootWindow,n=t;while(n)this.eventManager.addEventListener(n.document,"contextmenu",(function(){return e.unlisten()})),this.eventManager.addEventListener(n.document,"mouseup",(function(){return e.unlisten()})),this.eventManager.addEventListener(n.document,"mousemove",(function(t){return e.onMouseMove(t)})),n=Object(v["getParentWindow"])(n)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(e){if(!Object(g["isRightClick"])(e)){var t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(e){this.isListening()&&this.check(e.clientX,e.clientY)}},{key:"destroy",value:function(){hp(wp(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Op}},{key:"PLUGIN_PRIORITY",get:function(){return Cp}}]),n}(Hr);function Rp(e){return Rp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rp(e)}function kp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jp(e,t,n){return t&&Ep(e.prototype,t),n&&Ep(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tp(){return Tp="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Pp(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Tp.apply(this,arguments)}function Pp(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Np(e),null===e)break;return e}function Mp(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ap(e,t)}function Ap(e,t){return Ap=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ap(e,t)}function Ip(e){var t=Hp();return function(){var n,r=Np(e);if(t){var o=Np(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _p(this,n)}}function _p(e,t){if(t&&("object"===Rp(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return xp(e)}function xp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Np(e)}Ne["a"].getSingleton().register("afterDropdownMenuDefaultOptions"),Ne["a"].getSingleton().register("beforeDropdownMenuShow"),Ne["a"].getSingleton().register("afterDropdownMenuShow"),Ne["a"].getSingleton().register("afterDropdownMenuHide"),Ne["a"].getSingleton().register("afterDropdownMenuExecute");var Dp="dropdownMenu",Lp=230,Bp="changeType",Vp=function(e){Mp(n,e);var t=Ip(n);function n(e){var r;return kp(this,n),r=t.call(this,e),r.eventManager=new we["a"](xp(r)),r.commandExecutor=new Xc(r.hot),r.itemsFactory=null,r.menu=null,r.hot.addHook("afterGetColHeader",(function(e,t){return r.onAfterGetColHeader(e,t)})),r}return jp(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Dp]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new Wf(this.hot,n.DEFAULT_ITEMS);var t=this.hot.getSettings()[Dp],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),Tp(Np(n.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",r),e.itemsFactory.setPredefinedItems(r.items);var n=e.itemsFactory.getItems(t);e.menu&&e.menu.destroy(),e.menu=new ah(e.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||e.hot.rootDocument.body}),e.hot.runHooks("beforeDropdownMenuSetItems",n),e.menu.setMenuItems(n),e.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),e.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),e.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),e.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),Object(N["arrayEach"])(n,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Tp(Np(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Tp(Np(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if(e.stopPropagation(),Object(v["hasClass"])(e.target,Bp)&&!this.menu.isOpened()){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;t=i,n=a}var l=e.target.getBoundingClientRect();this.open({left:l.left+n,top:l.top+e.target.offsetHeight+3+t,width:l.width,height:l.height})}}},{key:"onAfterGetColHeader",value:function(e,t){var n=t.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(e<0||o!==r.length-1)){var i=t.querySelector(".".concat(Bp));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className=Bp,a.type="button",a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Tp(Np(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dp}},{key:"PLUGIN_PRIORITY",get:function(){return Lp}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Jc,ef,Gu,pf,Gu,qc,Gu,nf,Gu,Kc]}}]),n}(Hr);function Fp(e,t){return Yp(e)||Gp(e,t)||Up(e,t)||Wp()}function Wp(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Up(e,t){if(e){if("string"===typeof e)return zp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zp(e,t):void 0}}function zp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gp(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Yp(e){if(Array.isArray(e))return e}function Xp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $p(e,t,n){return t&&Kp(e.prototype,t),n&&Kp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Vp.SEPARATOR={name:Gu};var qp=function(){function e(t){Xp(this,e),this.hot=t,this.options={}}return $p(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,o=t.endRow,i=t.endCol,a=this.options,l=[];return Object(Tn["rangeEach"])(n,o,(function(t){var n=[];!a.exportHiddenRows&&e._isHiddenRow(t)||(Object(Tn["rangeEach"])(r,i,(function(r){!a.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))})),l.push(n))})),l}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();Object(Tn["rangeEach"])(r,o,(function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(i[n])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();Object(Tn["rangeEach"])(r,o,(function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(i[n])}))}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,n=Fp(this.options.range,4),r=n[0],o=void 0===r?0:r,i=n[1],a=void 0===i?0:i,l=n[2],s=void 0===l?t:l,u=n[3],c=void 0===u?e:u;return o=Math.max(o,0),a=Math.max(a,0),s=Math.min(s,t),c=Math.min(c,e),{startRow:o,startCol:a,endRow:s,endCol:c}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}]),e}(),Qp=qp;n("970e");function Jp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ey(e,t,n){return t&&Zp(e.prototype,t),n&&Zp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ty=function(){function e(t,n){Jp(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return ey(e,[{key:"_mergeOptions",value:function(t){var n=Object(b["clone"])(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=Object(b["extend"])(Object(b["clone"])(e.DEFAULT_OPTIONS),n),n=Object(b["extend"])(n,t),n.filename=Object(L["substitute"])(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}(),ny=ty;function ry(e){return ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ry(e)}function oy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ay(e,t,n){return t&&iy(e.prototype,t),n&&iy(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ly(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sy(e,t)}function sy(e,t){return sy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sy(e,t)}function uy(e){var t=hy();return function(){var n,r=dy(e);if(t){var o=dy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cy(this,n)}}function cy(e,t){if(t&&("object"===ry(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fy(e)}function fy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hy(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function dy(e){return dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dy(e)}var py=String.fromCharCode(13),yy=String.fromCharCode(34),vy=String.fromCharCode(10),gy=function(e){ly(n,e);var t=uy(n);function n(){return oy(this,n),t.apply(this,arguments)}return ay(n,[{key:"export",value:function(){var e=this,t=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,l=t.bom?String.fromCharCode(65279):"";return o&&(r=Object(N["arrayMap"])(r,(function(t){return e._escapeCell(t,!0)})),a&&(l+=t.columnDelimiter),l+=r.join(t.columnDelimiter),l+=t.rowDelimiter),Object(N["arrayEach"])(n,(function(n,r){r>0&&(l+=t.rowDelimiter),a&&(l+=e._escapeCell(i[r])+t.columnDelimiter),l+=n.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),l}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(D["stringify"])(e);return""!==n&&(t||n.indexOf(py)>=0||n.indexOf(yy)>=0||n.indexOf(vy)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),n}(ny),by=gy;function my(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wy="csv",Oy=my({},wy,by);function Cy(e,t,n){return"function"===typeof Oy[e]?new Oy[e](t,n):null}function Sy(e){return Sy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sy(e)}function Ry(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ky(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ey(e,t,n){return t&&ky(e.prototype,t),n&&ky(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jy(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ty(e,t)}function Ty(e,t){return Ty=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ty(e,t)}function Py(e){var t=Iy();return function(){var n,r=_y(e);if(t){var o=_y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return My(this,n)}}function My(e,t){if(t&&("object"===Sy(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ay(e)}function Ay(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iy(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _y(e){return _y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_y(e)}var xy="exportFile",Hy=240,Ny=function(e){jy(n,e);var t=Py(n);function n(){return Ry(this,n),t.apply(this,arguments)}return Ey(n,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(e,t),a=this._createBlob(i),l=o.URL||o.webkitURL,s=r.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==s.download){var c=l.createObjectURL(a);s.style.display="none",s.setAttribute("href",c),s.setAttribute("download",u),r.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),r.body.removeChild(s),setTimeout((function(){l.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Oy[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return Cy(e,new Qp(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!==typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}],[{key:"PLUGIN_KEY",get:function(){return xy}},{key:"PLUGIN_PRIORITY",get:function(){return Hy}}]),n}(Hr);n("8125");function Dy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ly(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function By(e,t,n){return t&&Ly(e.prototype,t),n&&Ly(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Vy=function(){function e(t,n){var r=n.id,o=n.stateless,i=void 0===o||o;Dy(this,e),this.hot=t,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ol["a"])}return By(e,[{key:"reset",value:function(){Object(N["arrayEach"])(this.elements,(function(e){return e.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Object(N["arrayEach"])(this.elements,(function(e){return e.destroy()})),this.state=null,this.elements=null,this.hot=null}}]),e}();Object(b["mixin"])(Vy,fc["a"]);var Fy=Vy,Wy={};function Uy(e,t){if(!Wy[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var n=Wy[e],r=n.condition,o=n.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(e){return r.apply(e.meta.instance,[].concat([e],[i]))}}function zy(e){if(!Wy[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Wy[e].descriptor}function Gy(e,t,n){n.key=e,Wy[e]={condition:t,descriptor:n}}var Yy="none";function Xy(){return!0}Gy(Yy,Xy,{name:mc["FILTERS_CONDITIONS_NONE"],inputsCount:0,showOperators:!1});var Ky="empty";function $y(e){return Object(D["isEmpty"])(e.value)}Gy(Ky,$y,{name:mc["FILTERS_CONDITIONS_EMPTY"],inputsCount:0,showOperators:!0});var qy="not_empty";function Qy(e,t){return!Uy(Ky,t)(e)}function Jy(e,t){return rv(e)||nv(e,t)||ev(e,t)||Zy()}function Zy(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ev(e,t){if(e){if("string"===typeof e)return tv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tv(e,t):void 0}}function tv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function rv(e){if(Array.isArray(e))return e}Gy(qy,Qy,{name:mc["FILTERS_CONDITIONS_NOT_EMPTY"],inputsCount:0,showOperators:!0});var ov="eq";function iv(e,t){var n=Jy(t,1),r=n[0];return Object(D["stringify"])(e.value).toLocaleLowerCase(e.meta.locale)===Object(D["stringify"])(r)}Gy(ov,iv,{name:mc["FILTERS_CONDITIONS_EQUAL"],inputsCount:1,showOperators:!0});var av="neq";function lv(e,t){return!Uy(ov,t)(e)}function sv(e,t){return dv(e)||hv(e,t)||cv(e,t)||uv()}function uv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cv(e,t){if(e){if("string"===typeof e)return fv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fv(e,t):void 0}}function fv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function dv(e){if(Array.isArray(e))return e}Gy(av,lv,{name:mc["FILTERS_CONDITIONS_NOT_EQUAL"],inputsCount:1,showOperators:!0});var pv="gt";function yv(e,t){var n=sv(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>o}function vv(e,t){return Ov(e)||wv(e,t)||bv(e,t)||gv()}function gv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bv(e,t){if(e){if("string"===typeof e)return mv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mv(e,t):void 0}}function mv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ov(e){if(Array.isArray(e))return e}Gy(pv,yv,{name:mc["FILTERS_CONDITIONS_GREATER_THAN"],inputsCount:1,showOperators:!0});var Cv="gte";function Sv(e,t){var n=vv(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>=o}function Rv(e,t){return Pv(e)||Tv(e,t)||Ev(e,t)||kv()}function kv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ev(e,t){if(e){if("string"===typeof e)return jv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jv(e,t):void 0}}function jv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Pv(e){if(Array.isArray(e))return e}Gy(Cv,Sv,{name:mc["FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL"],inputsCount:1,showOperators:!0});var Mv="lt";function Av(e,t){var n=Rv(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<o}function Iv(e,t){return Dv(e)||Nv(e,t)||xv(e,t)||_v()}function _v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xv(e,t){if(e){if("string"===typeof e)return Hv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hv(e,t):void 0}}function Hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Dv(e){if(Array.isArray(e))return e}Gy(Mv,Av,{name:mc["FILTERS_CONDITIONS_LESS_THAN"],inputsCount:1,showOperators:!0});var Lv="lte";function Bv(e,t){var n=Iv(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<=o}function Vv(e,t){return Gv(e)||zv(e,t)||Wv(e,t)||Fv()}function Fv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wv(e,t){if(e){if("string"===typeof e)return Uv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uv(e,t):void 0}}function Uv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Gv(e){if(Array.isArray(e))return e}Gy(Lv,Bv,{name:mc["FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL"],inputsCount:1,showOperators:!0});var Yv="date_after";function Xv(e,t){var n=Vv(t,1),r=n[0],o=be(e.value,e.meta.dateFormat),i=be(r,e.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}function Kv(e,t){return Zv(e)||Jv(e,t)||qv(e,t)||$v()}function $v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qv(e,t){if(e){if("string"===typeof e)return Qv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qv(e,t):void 0}}function Qv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jv(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Zv(e){if(Array.isArray(e))return e}Gy(Yv,Xv,{name:mc["FILTERS_CONDITIONS_AFTER"],inputsCount:1,showOperators:!0});var eg="date_before";function tg(e,t){var n=Kv(t,1),r=n[0],o=be(e.value,e.meta.dateFormat),i=be(r,e.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}function ng(e,t){return lg(e)||ag(e,t)||og(e,t)||rg()}function rg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function og(e,t){if(e){if("string"===typeof e)return ig(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ig(e,t):void 0}}function ig(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ag(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function lg(e){if(Array.isArray(e))return e}Gy(eg,tg,{name:mc["FILTERS_CONDITIONS_BEFORE"],inputsCount:1,showOperators:!0});var sg="between";function ug(e,t){var n=ng(t,2),r=n[0],o=n[1],i=r,a=o;if("numeric"===e.meta.type){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if("date"===e.meta.type){var u=Uy(eg,[a]),c=Uy(Yv,[i]);return u(e)&&c(e)}return e.value>=i&&e.value<=a}Gy(sg,ug,{name:mc["FILTERS_CONDITIONS_BETWEEN"],inputsCount:2,showOperators:!0});var cg="not_between";function fg(e,t){return!Uy(sg,t)(e)}function hg(e,t){return gg(e)||vg(e,t)||pg(e,t)||dg()}function dg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pg(e,t){if(e){if("string"===typeof e)return yg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yg(e,t):void 0}}function yg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vg(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function gg(e){if(Array.isArray(e))return e}Gy(cg,fg,{name:mc["FILTERS_CONDITIONS_NOT_BETWEEN"],inputsCount:2,showOperators:!0});var bg="begins_with";function mg(e,t){var n=hg(t,1),r=n[0];return Object(D["stringify"])(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Object(D["stringify"])(r))}Gy(bg,mg,{name:mc["FILTERS_CONDITIONS_BEGINS_WITH"],inputsCount:1,showOperators:!0});n("b1c4");function wg(e,t){return kg(e)||Rg(e,t)||Cg(e,t)||Og()}function Og(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Cg(e,t){if(e){if("string"===typeof e)return Sg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sg(e,t):void 0}}function Sg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rg(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function kg(e){if(Array.isArray(e))return e}var Eg="ends_with";function jg(e,t){var n=wg(t,1),r=n[0];return Object(D["stringify"])(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Object(D["stringify"])(r))}function Tg(e,t){return _g(e)||Ig(e,t)||Mg(e,t)||Pg()}function Pg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mg(e,t){if(e){if("string"===typeof e)return Ag(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ag(e,t):void 0}}function Ag(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ig(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function _g(e){if(Array.isArray(e))return e}Gy(Eg,jg,{name:mc["FILTERS_CONDITIONS_ENDS_WITH"],inputsCount:1,showOperators:!0});var xg="contains";function Hg(e,t){var n=Tg(t,1),r=n[0];return Object(D["stringify"])(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Object(D["stringify"])(r))>=0}Gy(xg,Hg,{name:mc["FILTERS_CONDITIONS_CONTAINS"],inputsCount:1,showOperators:!0});var Ng="not_contains";function Dg(e,t){return!Uy(xg,t)(e)}Gy(Ng,Dg,{name:mc["FILTERS_CONDITIONS_NOT_CONTAIN"],inputsCount:1,showOperators:!0});var Lg="date_tomorrow";function Bg(e){var t=be(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(be().subtract(-1,"days").startOf("day"),"d")}Gy(Lg,Bg,{name:mc["FILTERS_CONDITIONS_TOMORROW"],inputsCount:0});var Vg="date_today";function Fg(e){var t=be(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(be().startOf("day"),"d")}Gy(Vg,Fg,{name:mc["FILTERS_CONDITIONS_TODAY"],inputsCount:0});var Wg,Ug="date_yesterday";function zg(e){var t=be(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(be().subtract(1,"days").startOf("day"),"d")}function Gg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Gy(Ug,zg,{name:mc["FILTERS_CONDITIONS_YESTERDAY"],inputsCount:0});var Yg="numeric",Xg="text",Kg="date",$g=(Wg={},Gg(Wg,Yg,[Yy,Gu,Ky,qy,Gu,ov,av,Gu,pv,Cv,Mv,Lv,sg,cg]),Gg(Wg,Xg,[Yy,Gu,Ky,qy,Gu,ov,av,Gu,bg,Eg,Gu,xg,Ng]),Gg(Wg,Kg,[Yy,Gu,Ky,qy,Gu,ov,av,Gu,eg,Yv,sg,Gu,Lg,Vg,Ug]),Wg);function qg(e){var t=[],n=e;return $g[n]||(n=Xg),Object(N["arrayEach"])($g[n],(function(e){var n;n=e===Gu?{name:Gu}:Object(b["clone"])(zy(e)),t.push(n)})),t}function Qg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zg(e,t,n){return t&&Jg(e.prototype,t),n&&Jg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var eb="built",tb="building",nb=["click","input","keydown","keypress","keyup","focus","blur","change"],rb=function(){function e(t,n){Qg(this,e),this.hot=t,this.eventManager=new we["a"](this),this.options=Object(b["extend"])(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return Zg(e,[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===tb?this._element:this.buildState===eb?(this.update(),this._element):(this.buildState=tb,this.build(),this.buildState=eb,this._element)}},{key:"isBuilt",value:function(){return this.buildState===eb}},{key:"translateIfPossible",value:function(e){return"string"===typeof e&&e.startsWith(mc["FILTERS_NAMESPACE"])?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,t=function(t,n){e.eventManager.addEventListener(t,n,(function(t){return e.runLocalHooks(n,t,e)}))};if(this.buildState||(this.buildState=tb),this.options.className&&Object(v["addClass"])(this._element,this.options.className),this.options.children.length)Object(N["arrayEach"])(this.options.children,(function(t){return e._element.appendChild(t.element)}));else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);Object(b["objectEach"])(this.options,(function(t,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=e.translateIfPossible(t))})),this._element.appendChild(n),Object(N["arrayEach"])(nb,(function(e){return t(n,e)}))}else Object(N["arrayEach"])(nb,(function(n){return t(e._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Object(b["clone"])({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();Object(b["mixin"])(rb,fc["a"]);var ob=rb;function ib(e){return ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ib(e)}function ab(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sb(e,t,n){return t&&lb(e.prototype,t),n&&lb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ub(){return ub="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=cb(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ub.apply(this,arguments)}function cb(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=gb(e),null===e)break;return e}function fb(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hb(e,t)}function hb(e,t){return hb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hb(e,t)}function db(e){var t=vb();return function(){var n,r=gb(e);if(t){var o=gb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pb(this,n)}}function pb(e,t){if(t&&("object"===ib(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return yb(e)}function yb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function gb(e){return gb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gb(e)}var bb=new WeakMap,mb=function(e){fb(n,e);var t=db(n);function n(e,r){var o;return ab(this,n),o=t.call(this,e,Object(b["extend"])(n.DEFAULTS,r)),bb.set(yb(o),{}),o.registerHooks(),o}return sb(n,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()})),this.addLocalHook("keyup",(function(t){return e.onKeyup(t)}))}},{key:"build",value:function(){ub(gb(n.prototype),"build",this).call(this);var e=bb.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Object(v["addClass"])(this._element,"htUIInput"),Object(v["addClass"])(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=bb.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&bb.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}],[{key:"DEFAULTS",get:function(){return Object(b["clone"])({placeholder:"",type:"text",tagName:"input"})}}]),n}(ob),wb=mb;function Ob(e){return Ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ob(e)}function Cb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rb(e,t,n){return t&&Sb(e.prototype,t),n&&Sb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kb(){return kb="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Eb(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},kb.apply(this,arguments)}function Eb(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=_b(e),null===e)break;return e}function jb(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tb(e,t)}function Tb(e,t){return Tb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tb(e,t)}function Pb(e){var t=Ib();return function(){var n,r=_b(e);if(t){var o=_b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mb(this,n)}}function Mb(e,t){if(t&&("object"===Ob(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ab(e)}function Ab(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ib(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _b(e){return _b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_b(e)}var xb=new WeakMap,Hb=function(e){jb(n,e);var t=Pb(n);function n(e,r){var o;return Cb(this,n),o=t.call(this,e,Object(b["extend"])(n.DEFAULTS,r)),xb.set(Ab(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return Rb(n,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()}))}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return Object(N["arrayEach"])(e,(function(e){e.name=t.translateIfPossible(e.name)})),e}},{key:"build",value:function(){var e=this;kb(_b(n.prototype),"build",this).call(this),this.menu=new ah(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var t=new ob(this.hot,{className:"htUISelectCaption"}),r=new ob(this.hot,{className:"htUISelectDropdown"}),o=xb.get(this);o.caption=t,o.captionElement=t.element,o.dropdown=r,Object(N["arrayEach"])([t,r],(function(t){return e._element.appendChild(t.element)})),this.menu.addLocalHook("select",(function(t){return e.onMenuSelect(t)})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuClosed()})),this.update()}},{key:"update",value:function(){var e;this.isBuilt()&&(e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(mc["FILTERS_CONDITIONS_NONE"]),xb.get(this).captionElement.textContent=e,kb(_b(n.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==Gu&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=xb.get(this),t=e.caption,r=e.dropdown;t&&t.destroy(),r&&r.destroy(),kb(_b(n.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Object(b["clone"])({className:"htUISelect",wrapIt:!1})}}]),n}(ob),Nb=Hb;function Db(e){return Db="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Db(e)}function Lb(e){return Wb(e)||Fb(e)||Vb(e)||Bb()}function Bb(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vb(e,t){if(e){if("string"===typeof e)return Ub(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ub(e,t):void 0}}function Fb(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Wb(e){if(Array.isArray(e))return Ub(e)}function Ub(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yb(e,t,n){return t&&Gb(e.prototype,t),n&&Gb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xb(){return Xb="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Kb(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Xb.apply(this,arguments)}function Kb(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=tm(e),null===e)break;return e}function $b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qb(e,t)}function qb(e,t){return qb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qb(e,t)}function Qb(e){var t=em();return function(){var n,r=tm(e);if(t){var o=tm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jb(this,n)}}function Jb(e,t){if(t&&("object"===Db(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zb(e)}function Zb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function em(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tm(e)}var nm=function(e){$b(n,e);var t=Qb(n);function n(e,r){var o;return zb(this,n),o=t.call(this,e,{id:r.id,stateless:!1}),o.name=r.name,o.addSeparator=r.addSeparator,o.elements.push(new Nb(o.hot,{menuContainer:r.menuContainer})),o.elements.push(new wb(o.hot,{placeholder:mc["FILTERS_BUTTONS_PLACEHOLDER_VALUE"]})),o.elements.push(new wb(o.hot,{placeholder:mc["FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE"]})),o.registerHooks(),o}return Yb(n,[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",(function(t){return e.onConditionSelect(t)})),this.getSelectElement().addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),Object(N["arrayEach"])(this.getInputElements(),(function(t){t.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}))}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var n=Object(b["clone"])(e.command);n.name.startsWith(mc["FILTERS_CONDITIONS_NAMESPACE"])&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),Object(N["arrayEach"])(e.args,(function(e,r){if(r>n.inputsCount-1)return!1;var o=t.getInputElement(r);o.setValue(e),o[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||zy(Yy),t=[];return Object(N["arrayEach"])(this.getInputElements(),(function(n,r){e.inputsCount>r&&t.push(n.getValue())})),{command:e,args:t}}},{key:"updateState",value:function(e,t){var n=zy(e?e.name:Yy);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||Object(N["arrayEach"])(this.getInputElements(),(function(e){return e.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof Nb}))[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter((function(e){return e instanceof wb}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){Object(v["addClass"])(n.parentNode,"htFiltersMenuCondition"),e.addSeparator&&Object(v["addClass"])(n.parentNode,"border");var l=e.hot.rootDocument.createElement("div");return Object(v["addClass"])(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||Object(N["arrayEach"])(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e,t=this.hot.getPlugin("filters").getSelectedColumn(),r=t&&t.visualIndex,o=(e=this.hot).getDataType.apply(e,Lb(this.hot.getSelectedLast()||[0,r])),i=qg(o);Object(N["arrayEach"])(this.getInputElements(),(function(e){return e.hide()})),this.getSelectElement().setItems(i),Xb(tm(n.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(e){Object(N["arrayEach"])(this.getInputElements(),(function(t,n){t[e.inputsCount>n?"show":"hide"](),0===n&&setTimeout((function(){return t.focus()}),10)})),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){Object(B["isKey"])(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),Object(g["stopImmediatePropagation"])(e)):Object(B["isKey"])(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(g["stopImmediatePropagation"])(e))}}]),n}(Fy),rm=nm,om={};function im(e){if(!om[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=om[e].func;return function(e,n){return t(e,n)}}function am(e){return om[e].name}function lm(e,t,n){om[e]={name:t,func:n}}var sm="conjunction",um=mc["FILTERS_LABELS_CONJUNCTION"];function cm(e,t){return e.every((function(e){return e.func(t)}))}lm(sm,um,cm);var fm="disjunction",hm=mc["FILTERS_LABELS_DISJUNCTION"];function dm(e,t){return e.some((function(e){return e.func(t)}))}lm(fm,hm,dm);var pm="disjunctionWithExtraCondition",ym=mc["FILTERS_LABELS_DISJUNCTION"];function vm(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((function(e){return e.func(t)}))&&e[e.length-1].func(t)}function gm(e){return gm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gm(e)}function bm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wm(e,t,n){return t&&mm(e.prototype,t),n&&mm(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Om(){return Om="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Cm(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Om.apply(this,arguments)}function Cm(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Pm(e),null===e)break;return e}function Sm(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rm(e,t)}function Rm(e,t){return Rm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rm(e,t)}function km(e){var t=Tm();return function(){var n,r=Pm(e);if(t){var o=Pm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Em(this,n)}}function Em(e,t){if(t&&("object"===gm(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jm(e)}function jm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Pm(e){return Pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pm(e)}lm(pm,ym,vm);var Mm,Am=new WeakMap,Im=function(e){Sm(n,e);var t=km(n);function n(e,r){var o;return bm(this,n),o=t.call(this,e,Object(b["extend"])(n.DEFAULTS,r)),Am.set(jm(o),{}),o}return wm(n,[{key:"build",value:function(){Om(Pm(n.prototype),"build",this).call(this);var e=Am.get(this);e.input=this._element.firstChild;var t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=Am.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Am.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Object(b["clone"])({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),n}(ob),_m=Im;function xm(e){return xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xm(e)}function Hm(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Nm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lm(e,t,n){return t&&Dm(e.prototype,t),n&&Dm(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bm(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vm(e,t)}function Vm(e,t){return Vm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vm(e,t)}function Fm(e){var t=zm();return function(){var n,r=Gm(e);if(t){var o=Gm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wm(this,n)}}function Wm(e,t){if(t&&("object"===xm(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Um(e)}function Um(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Gm(e){return Gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gm(e)}var Ym=0,Xm=function(e){Bm(n,e);var t=Fm(n);function n(e,r){var o;return Nm(this,n),o=t.call(this,e,{id:r.id,stateless:!1}),o.name=r.name,o.buildOperatorsElement(),o}return Lm(n,[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Object(v["addClass"])(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||Object(N["arrayEach"])(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[sm,fm];Object(N["arrayEach"])(t,(function(n){var r=new _m(e.hot,{name:"operator",label:{htmlFor:n,textContent:am(n)},value:n,checked:n===t[Ym],id:n});r.addLocalHook("change",(function(t){return e.onRadioInputChange(t)})),e.elements.push(r)}))}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error(Object(Cu["a"])(Mm||(Mm=Hm(["Radio button with index "," doesn't exist."])),e));Object(N["arrayEach"])(this.elements,(function(t,n){t.setChecked(n===e)}))}},{key:"getActiveOperationId",value:function(){var e=this.elements.find((function(e){return e instanceof _m&&e.isChecked()}));return e?e.getValue():sm}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&Object(N["arrayEach"])(this.elements,(function(t){t.setChecked(t.getValue()===e)}))}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sm,t=arguments.length>1?arguments[1]:void 0,n=e;n===pm&&(n=fm),this.state.setValueAtIndex(t,n)}},{key:"reset",value:function(){this.setChecked(Ym)}},{key:"onRadioInputChange",value:function(e){this.setState(e.target.value)}}]),n}(Fy),Km=Xm;Object(Dr["getComparisonFunction"])();function $m(e,t){var n=e;return""===n&&(n="(".concat(t,")")),n}var qm=new Set([1]).has(1),Qm=qm&&"function"===typeof Array.from;function Jm(e){var t=e;return qm&&(t=new Set(t)),function(e){var n;return n=qm?t.has(e):!!~t.indexOf(e),n}}function Zm(e){return null===e||void 0===e?"":e}function ew(e){var t=e;return t=Qm?Array.from(new Set(t)):Object(N["arrayUnique"])(t),t=t.sort((function(e,t){return"number"===typeof e&&"number"===typeof t?e-t:e===t?0:e>t?1:-1})),t}function tw(e,t,n,r){var o,i=[],a=e===t;return a||(o=Jm(t)),Object(N["arrayEach"])(e,(function(e){var t=!1;(a||o(e))&&(t=!0);var l={checked:t,value:e,visualValue:$m(e,n)};r&&r(l),i.push(l)})),i}var nw=n("85c9");n("24cc");function rw(e){return rw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rw(e)}function ow(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aw(e,t,n){return t&&iw(e.prototype,t),n&&iw(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function lw(){return lw="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=sw(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},lw.apply(this,arguments)}function sw(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=yw(e),null===e)break;return e}function uw(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cw(e,t)}function cw(e,t){return cw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},cw(e,t)}function fw(e){var t=pw();return function(){var n,r=yw(e);if(t){var o=yw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hw(this,n)}}function hw(e,t){if(t&&("object"===rw(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return dw(e)}function dw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pw(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function yw(e){return yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yw(e)}var vw=new WeakMap,gw=function(e){uw(n,e);var t=fw(n);function n(e,r){var o;return ow(this,n),o=t.call(this,e,Object(b["extend"])(n.DEFAULTS,r)),vw.set(dw(o),{}),o}return aw(n,[{key:"build",value:function(){lw(yw(n.prototype),"build",this).call(this);var e=vw.get(this);e.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(vw.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Object(b["clone"])({href:"#",tagName:"a"})}}]),n}(ob),bw=gw;function mw(e){return mw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mw(e)}function ww(e){return Rw(e)||Sw(e)||Cw(e)||Ow()}function Ow(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Cw(e,t){if(e){if("string"===typeof e)return kw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kw(e,t):void 0}}function Sw(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Rw(e){if(Array.isArray(e))return kw(e)}function kw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ew(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tw(e,t,n){return t&&jw(e.prototype,t),n&&jw(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pw(){return Pw="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Mw(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Pw.apply(this,arguments)}function Mw(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Dw(e),null===e)break;return e}function Aw(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iw(e,t)}function Iw(e,t){return Iw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Iw(e,t)}function _w(e){var t=Nw();return function(){var n,r=Dw(e);if(t){var o=Dw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xw(this,n)}}function xw(e,t){if(t&&("object"===mw(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Hw(e)}function Hw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nw(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Dw(e){return Dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dw(e)}var Lw=new WeakMap,Bw="multipleSelect.itemBox",Vw=function(e){Aw(n,e);var t=_w(n);function n(e,r){var o;return Ew(this,n),o=t.call(this,e,Object(b["extend"])(n.DEFAULTS,r)),Lw.set(Hw(o),{}),o.searchInput=new wb(o.hot,{placeholder:mc["FILTERS_BUTTONS_PLACEHOLDER_SEARCH"],className:"htUIMultipleSelectSearch"}),o.selectAllUI=new bw(o.hot,{textContent:mc["FILTERS_BUTTONS_SELECT_ALL"],className:"htUISelectAll"}),o.clearAllUI=new bw(o.hot,{textContent:mc["FILTERS_BUTTONS_CLEAR"],className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return Tw(n,[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)})),this.searchInput.addLocalHook("input",(function(t){return e.onInput(t)})),this.selectAllUI.addLocalHook("click",(function(t){return e.onSelectAllClick(t)})),this.clearAllUI.addLocalHook("click",(function(t){return e.onClearAllClick(t)}))}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(e){this.locale=e}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return ww(this.items)}},{key:"getValue",value:function(){return Uw(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;Pw(Dw(n.prototype),"build",this).call(this);var t=this.hot.rootDocument,r=t.createElement("div"),o=new ob(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(r);var i=function(n){if(e._element){e.itemsBox&&e.itemsBox.destroy(),Object(v["addClass"])(n,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(n,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,n,r,o,i){e.title=i.instance.getDataAtRowProp(t,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-Object(v["getScrollbarWidth"])(t)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:e.hot.isRtl()?"rtl":"ltr"}),e.itemsBox.init();var r=e.itemsBox.getShortcutManager(),o=r.getContext("grid");o.addShortcut({keys:[["Escape"]],callback:function(t){e.runLocalHooks("keydown",t,e)},group:Bw})}};i(r),setTimeout((function(){return i(r)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(Ww(this.items,this.options.value)),Pw(Dw(n.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Pw(Dw(n.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t,n=this,r=e.target.value.toLocaleLowerCase(this.getLocale());t=""===r?ww(this.items):Object(N["arrayFilter"])(this.items,(function(e){return"".concat(e.value).toLocaleLowerCase(n.getLocale()).indexOf(r)>=0})),this.itemsBox.loadData(t)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this);var t=Object(ml["partial"])(B["isKey"],e.keyCode);t("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Object(g["stopImmediatePropagation"])(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(e){var t=[];e.preventDefault(),Object(N["arrayEach"])(this.itemsBox.getSourceData(),(function(e,n){e.checked=!0,t.push(Object(nw["dataRowToChangesArray"])(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}},{key:"onClearAllClick",value:function(e){var t=[];e.preventDefault(),Object(N["arrayEach"])(this.itemsBox.getSourceData(),(function(e,n){e.checked=!1,t.push(Object(nw["dataRowToChangesArray"])(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}}],[{key:"DEFAULTS",get:function(){return Object(b["clone"])({className:"htUIMultipleSelect",value:[]})}}]),n}(ob),Fw=Vw;function Ww(e,t){var n=Jm(t);return Object(N["arrayMap"])(e,(function(e){return e.checked=n(e.value),e}))}function Uw(e){var t=[];return Object(N["arrayEach"])(e,(function(e){e.checked&&t.push(e.value)})),t}function zw(e,t){return $w(e)||Kw(e,t)||Yw(e,t)||Gw()}function Gw(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yw(e,t){if(e){if("string"===typeof e)return Xw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xw(e,t):void 0}}function Xw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kw(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function $w(e){if(Array.isArray(e))return e}var qw="by_value";function Qw(e,t){var n=zw(t,1),r=n[0];return r(e.value)}function Jw(e){return Jw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jw(e)}function Zw(e,t){return oO(e)||rO(e,t)||tO(e,t)||eO()}function eO(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tO(e,t){if(e){if("string"===typeof e)return nO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nO(e,t):void 0}}function nO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rO(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function oO(e){if(Array.isArray(e))return e}function iO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lO(e,t,n){return t&&aO(e.prototype,t),n&&aO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sO(){return sO="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=uO(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},sO.apply(this,arguments)}function uO(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=vO(e),null===e)break;return e}function cO(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fO(e,t)}function hO(e){var t=yO();return function(){var n,r=vO(e);if(t){var o=vO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dO(this,n)}}function dO(e,t){if(t&&("object"===Jw(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pO(e)}function pO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yO(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function vO(e){return vO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vO(e)}Gy(qw,Qw,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){var t=zw(e,1),n=t[0];return[Jm(n)]},showOperators:!1});var gO=function(e){cO(n,e);var t=hO(n);function n(e,r){var o;return iO(this,n),o=t.call(this,e,{id:r.id,stateless:!1}),o.name=r.name,o.elements.push(new Fw(o.hot)),o.registerHooks(),o}return lO(n,[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===qw){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}},{key:"getState",value:function(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Yy:qw},args:[e.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(e){var t=this,n=function(n,r,o,i,a){var l=Object(N["arrayFilter"])(r,(function(e){return e.name===qw})),s=Zw(l,1),u=s[0],c={},f=t.hot.getTranslatedPhrase(mc["FILTERS_VALUES_BLANK_CELLS"]);if(u){var h=ew(Object(N["arrayMap"])(i(n,a),(function(e){return e.value})));o&&(u.args[0]=o);var d=[],p=tw(h,u.args[0],f,(function(e){e.checked&&d.push(e.value)})),y=e.editedConditionStack.column;c.locale=t.hot.getCellMeta(0,y).locale,c.args=[d],c.command=zy(qw),c.itemsSnapshot=p}else c.args=[],c.command=zy(Yy);t.state.setValueAtIndex(n,c)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof Fw}))[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){Object(v["addClass"])(n.parentNode,"htFiltersMenuValue");var l=e.hot.rootDocument.createElement("div");return Object(v["addClass"])(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||Object(N["arrayEach"])(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(mc["FILTERS_VALUES_BLANK_CELLS"]),t=ew(this._getColumnVisibleValues()),r=tw(t,t,e);this.getMultipleSelectElement().setItems(r),sO(vO(n.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(t);var o=this.hot.getPlugin("filters").getSelectedColumn().visualIndex;this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o).locale)}},{key:"onInputKeyDown",value:function(e){Object(B["isKey"])(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(g["stopImmediatePropagation"])(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=e&&e.visualIndex;return Object(N["arrayMap"])(this.hot.getDataAtCol(t),(function(e){return Zm(e)}))}}]),n}(Fy),bO=gO;function mO(e){return mO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mO(e)}function wO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CO(e,t,n){return t&&OO(e.prototype,t),n&&OO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function SO(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RO(e,t)}function RO(e,t){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},RO(e,t)}function kO(e){var t=TO();return function(){var n,r=PO(e);if(t){var o=PO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return EO(this,n)}}function EO(e,t){if(t&&("object"===mO(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jO(e)}function jO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TO(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function PO(e){return PO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},PO(e)}var MO,AO,IO=function(e){SO(n,e);var t=kO(n);function n(e,r){var o;return wO(this,n),o=t.call(this,e,{id:r.id,stateless:!0}),o.name=r.name,o.elements.push(new wb(o.hot,{type:"button",value:mc["FILTERS_BUTTONS_OK"],className:"htUIButton htUIButtonOK",identifier:n.BUTTON_OK})),o.elements.push(new wb(o.hot,{type:"button",value:mc["FILTERS_BUTTONS_CANCEL"],className:"htUIButton htUIButtonCancel",identifier:n.BUTTON_CANCEL})),o.registerHooks(),o}return CO(n,[{key:"registerHooks",value:function(){var e=this;Object(N["arrayEach"])(this.elements,(function(t){t.addLocalHook("click",(function(t,n){return e.onButtonClick(t,n)}))}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Object(v["addClass"])(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||Object(N["arrayEach"])(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,t){t.options.identifier===n.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),n}(Fy),_O=IO;function xO(e,t){return BO(e)||LO(e,t)||NO(e,t)||HO()}function HO(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function NO(e,t){if(e){if("string"===typeof e)return DO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DO(e,t):void 0}}function DO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LO(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function BO(e){if(Array.isArray(e))return e}function VO(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function FO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UO(e,t,n){return t&&WO(e.prototype,t),n&&WO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var zO="ConditionCollection.filteringStates",GO=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];FO(this,e),this.hot=t,this.isMapRegistrable=n,this.filteringStates=new Ol["a"],!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(zO,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return UO(e,[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(e,t){var n,r=this.filteringStates.getValueAtIndex(t),o=null!==(n=null===r||void 0===r?void 0:r.conditions)&&void 0!==n?n:[],i=null===r||void 0===r?void 0:r.operation;return this.isMatchInConditions(o,e,i)}},{key:"isMatchInConditions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sm;return!e.length||im(n)(e,t)}},{key:"addCondition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sm,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,e).locale,i=Object(N["arrayMap"])(t.args,(function(e){return"string"===typeof e?e.toLocaleLowerCase(o):e})),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);var l=this.getOperation(e);if(l){if(l!==n)throw Error(Object(Cu["a"])(MO||(MO=VO(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,l))}else if(Object(D["isUndefined"])(om[n]))throw new Error(Object(Cu["a"])(AO||(AO=VO(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var s=this.getConditions(e);0===s.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:i,func:Uy(a,i)}]},r):s.push({name:a,args:i,func:Uy(a,i)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}},{key:"getOperation",value:function(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(e){var t=xO(e,1),n=t[0];return n}))}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return Object(N["arrayReduce"])(this.filteringStates.getEntries(),(function(e,t){var n=xO(t,2),r=n[0],o=n[1],i=o.operation,a=o.conditions;return e.push({column:r,operation:i,conditions:Object(N["arrayMap"])(a,(function(e){var t=e.name,n=e.args;return{name:t,args:n}}))}),e}),[])}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),Object(N["arrayEach"])(e,(function(e){Object(N["arrayEach"])(e.conditions,(function(n){return t.addCondition(e.column,n)}))}))}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,t){var n=this.getConditions(e);return t?n.some((function(e){return e.name===t})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(zO),this.filteringStates=null,this.clearLocalHooks()}}]),e}();Object(b["mixin"])(GO,fc["a"]);var YO=GO;function XO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $O(e,t,n){return t&&KO(e.prototype,t),n&&KO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var qO=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};XO(this,e),this.conditionCollection=t,this.columnDataFactory=n}return $O(e,[{key:"filter",value:function(){var e=this,t=[];return Object(N["arrayEach"])(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=e.columnDataFactory(n);r&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(n,o)})),t}},{key:"filterByColumn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object(N["arrayEach"])(n,(function(n){void 0!==n&&t.conditionCollection.isMatch(n,e)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(e,t){var n=[];return Object(N["arrayEach"])(t,(function(t){var r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])})),n}}]),e}(),QO=qO;function JO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eC(e,t,n){return t&&ZO(e.prototype,t),n&&ZO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var tC=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};JO(this,e),this.hot=t,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(e){return r._onConditionBeforeModify(e)})),this.conditionCollection.addLocalHook("afterRemove",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("afterAdd",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}return eC(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,Object(N["arrayEach"])(this.changes,(function(t){e.updateStatesAtColumn(t)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,t){var n=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(e);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();var l=Object(ml["curry"])((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new YO(n.hot,!1),i=[].concat(e,r);o.importAllConditions(i);var a,l=n.columnDataFactory(t);a=o.isEmpty()?l:new QO(o,(function(e){return n.columnDataFactory(e)})).filter(),a=Object(N["arrayMap"])(a,(function(e){return e.meta.visualRow}));var s=Jm(a);return o.destroy(),Object(N["arrayFilter"])(l,(function(e){return s(e.meta.visualRow)}))}))(i),s=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:s},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;Object(N["arrayEach"])(this.latestOrderStack,(function(t){e.updateStatesAtColumn(t)}))}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),Object(b["objectEach"])(this,(function(t,n){e[n]=null}))}}]),e}();Object(b["mixin"])(tC,fc["a"]);var nC,rC=tC,oC=n("54fd");function iC(e){return iC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iC(e)}function aC(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lC(e,t){return hC(e)||fC(e,t)||uC(e,t)||sC()}function sC(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uC(e,t){if(e){if("string"===typeof e)return cC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cC(e,t):void 0}}function cC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fC(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function hC(e){if(Array.isArray(e))return e}function dC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yC(e,t,n){return t&&pC(e.prototype,t),n&&pC(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vC(){return vC="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=gC(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},vC.apply(this,arguments)}function gC(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=RC(e),null===e)break;return e}function bC(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mC(e,t)}function mC(e,t){return mC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mC(e,t)}function wC(e){var t=SC();return function(){var n,r=RC(e);if(t){var o=RC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OC(this,n)}}function OC(e,t){if(t&&("object"===iC(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return CC(e)}function CC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SC(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function RC(e){return RC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RC(e)}var kC="filters",EC=250,jC=function(e){bC(n,e);var t=wC(n);function n(e){var r;return dC(this,n),r=t.call(this,e),r.eventManager=new we["a"](CC(r)),r.dropdownMenuPlugin=null,r.conditionCollection=null,r.conditionUpdateObserver=null,r.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),r.lastSelectedColumn=null,r.filtersRowsMap=null,r.hot.addHook("afterGetColHeader",(function(e,t){return r.onAfterGetColHeader(e,t)})),r}return yC(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[kC]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new oC["a"]),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu,r=t&&t.uiContainer||this.hot.rootDocument.body,o=function(t){return t.addLocalHook("accept",(function(){return e.onActionBarSubmit("accept")})),t.addLocalHook("cancel",(function(){return e.onActionBarSubmit("cancel")})),t.addLocalHook("change",(function(n){return e.onComponentChange(t,n)})),t},i=function(){return"".concat(e.hot.getTranslatedPhrase(mc["FILTERS_DIVS_FILTER_BY_CONDITION"]),":")},a=function(){return"".concat(e.hot.getTranslatedPhrase(mc["FILTERS_DIVS_FILTER_BY_VALUE"]),":")};if(!this.components.get("filter_by_condition")){var l=new rm(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});l.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition",o(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Km(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var s=new rm(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});s.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(s))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new bO(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new _O(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new YO(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new rC(this.hot,this.conditionCollection,(function(t){return e.getDataMapAtColumn(t)})),this.conditionUpdateObserver.addLocalHook("update",(function(t){return e.updateComponents(t)}))),this.components.forEach((function(e){return e.show()})),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",(function(t){return e.onBeforeDropdownMenuSetItems(t)})),this.addHook("afterDropdownMenuDefaultOptions",(function(t){return e.onAfterDropdownMenuDefaultOptions(t)})),this.addHook("afterDropdownMenuShow",(function(){return e.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return e.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(t){return e.onAfterChange(t)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),vC(RC(n.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"disablePlugin",value:function(){var e,t=this;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(e,n){e.destroy(),t.components.set(n,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));vC(RC(n.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sm,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:n},r)}},{key:"removeConditions",value:function(e){var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}},{key:"filter",value:function(){var e=this,t=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions(),i=this.hot.runHooks("beforeFilter",o);if(!1!==i)if(n){var a=[];this.hot.batchExecution((function(){e.filtersRowsMap.clear(),r=Object(N["arrayMap"])(t.filter(),(function(e){return e.meta.visualRow}));var n=Jm(r);Object(Tn["rangeEach"])(e.hot.countSourceRows()-1,(function(e){n(e)||a.push(e)})),Object(N["arrayEach"])(a,(function(t){e.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var e,t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.getTopStartCorner();void 0!==t&&this.hot.selectCell(t.row,t.col)}},{key:"getDataMapAtColumn",value:function(e){var t=this,n=this.hot.toVisualColumn(e),r=[];return Object(N["arrayEach"])(this.hot.getSourceDataAtCol(n),(function(e,o){var i,a=t.hot.getCellMeta(o,n),l=a.row,s=a.col,u=a.visualCol,c=a.visualRow,f=a.type,h=a.instance,d=a.dateFormat,p=a.locale,y=null!==(i=t.hot.getDataAtCell(t.hot.toVisualRow(o),n))&&void 0!==i?i:e;r.push({meta:{row:l,col:s,visualCol:u,visualRow:c,type:f,instance:h,dateFormat:d,locale:p},value:Zm(y)})})),r}},{key:"onAfterChange",value:function(e){var t=this;e&&Object(N["arrayEach"])(e,(function(e){var n=lC(e,2),r=n[1],o=t.hot.propToCol(r);t.conditionCollection.hasConditions(o)&&t.updateValueComponentCondition(o)}))}},{key:"updateValueComponentCondition",value:function(e){var t=this.hot.getDataAtCol(e),n=ew(t);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}},{key:"restoreComponents",value:function(e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((function(e){e.isHidden()||e.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var e=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:Gu}),this.components.forEach((function(t){e.items.push(t.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(e,t,n,r){var o=e;return o===fm&&t.command.key!==Yy&&n.command.key!==Yy&&r.command.key!==Yy?o=pm:r.command.key!==Yy&&(t.command.key!==Yy&&n.command.key!==Yy||(o=sm)),o}},{key:"onActionBarSubmit",value:function(e){if("accept"===e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,i);this.conditionUpdateObserver.groupChanges();var l=this.conditionCollection.getColumnStackPosition(n);-1===l&&(l=void 0),this.conditionCollection.removeConditions(n),r.command.key!==Yy&&(this.conditionCollection.addCondition(n,r,a,l),o.command.key!==Yy&&this.conditionCollection.addCondition(n,o,a,l)),i.command.key!==Yy&&this.conditionCollection.addCondition(n,i,a,l),this.conditionUpdateObserver.flush(),this.components.forEach((function(e){return e.saveState(n)})),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin&&this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(e,t){this.updateDependentComponentsVisibility(),e.constructor!==rm||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var e=this.components.get("filter_by_condition"),t=e.getState(),n=t.command,r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents.apply(this,r):this.hideComponents.apply(this,r)}},{key:"onAfterGetColHeader",value:function(e,t){var n=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?Object(v["addClass"])(t,"htFiltersActive"):Object(v["removeClass"])(t,"htFiltersActive")}},{key:"onTableClick",value:function(e){var t=Object(v["closest"])(e.target,"TH");if(t){var n=this.hot.getCoords(t).col,r=this.hot.toPhysicalColumn(n);this.lastSelectedColumn={visualIndex:n,physicalIndex:r}}}},{key:"_createDataFilter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new QO(t,(function(t){return e.getDataMapAtColumn(t)}))}},{key:"updateComponents",value:function(e){var t;if(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled){var n=e.editedConditionStack,r=n.conditions,o=n.column,i=r.filter((function(e){return e.name===qw})),a=r.filter((function(e){return e.name!==qw}));if(i.length>=2||a.length>=3)Object(Ba["b"])(Object(Cu["a"])(nC||(nC=aC(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var l=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(a[0],o),this.components.get("filter_by_condition2").updateState(a[1],o),this.components.get("filter_operators").updateState(l,o),this.components.get("filter_by_value").updateState(e)}}}},{key:"getIndexesOfComponents",value:function(){var e=[];if(!this.dropdownMenuPlugin)return e;for(var t=this.dropdownMenuPlugin.menu,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Object(N["arrayEach"])(r,(function(n){Object(N["arrayEach"])(t.menuItems,(function(t,r){t.key===n.getMenuItemDescriptor().key&&e.push(r)}))})),e}},{key:"changeComponentsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var t=this.dropdownMenuPlugin.menu,n=t.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=this.getIndexesOfComponents.apply(this,i);e?r.showRows(l):r.hideRows(l),n.render()}}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(t))}},{key:"destroy",value:function(){var e=this;this.enabled&&(this.components.forEach((function(t,n){null!==t&&(t.destroy(),e.components.set(n,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),vC(RC(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kC}},{key:"PLUGIN_PRIORITY",get:function(){return EC}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),n}(Hr);n("89c5");function TC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TC(Object(n),!0).forEach((function(t){MC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function MC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AC="internal-use-in-handsontable",IC={licenseKey:AC,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function _C(e){var t,n;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[PS])||void 0===t||null===(n=t.language)||void 0===n?void 0:n.langCode}}function xC(e){return Object.keys(e).reduce((function(t,n){return"hyperformula"!==n&&(t[n]=e[n]),t}),{})}function HC(e){var t,n=e[PS],r=xC(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=_C(e);return PC(PC(PC({},IC),r),o)}function NC(e){var t,n=e[PS],r=xC(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=_C(e);return PC(PC({},r),o)}function DC(e){return DC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DC(e)}function LC(){var e="engine_relationship",t=Object(Ss["a"])(PS);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function BC(){var e="shared_engine_usage",t=Object(Ss["a"])(PS);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function VC(e){var t,n=e.getSettings(),r=n[PS],o=null===r||void 0===r?void 0:r.engine;if(!0===r)return null;if(Object(D["isUndefined"])(o))return null;if("function"===typeof o.hyperformula||"function"===typeof o)return FC(null!==(t=o.hyperformula)&&void 0!==t?t:o,n,e);if("object"===DC(o)&&Object(D["isUndefined"])(o.hyperformula)){var i=LC(),a=BC().get(o);return i.has(o)||i.set(o,[]),i.get(o).push(e),a&&a.push(e.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:AC}),o}return null}function FC(e,t,n){var r=t[PS],o=HC(t),i=LC(),a=BC();zC(e,r.functions),GC(e,r.language);var l=e.buildEmpty(o);return i.set(l,[n]),a.set(l,[n.guid]),YC(l,r.namedExpressions),l.on("sheetAdded",(function(){l.rebuildAndRecalculate()})),l.on("sheetRemoved",(function(){l.rebuildAndRecalculate()})),l}function WC(e){var t,n=LC(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map((function(e){return[e.getPlugin("formulas").sheetId,e]})))}function UC(e,t){if(e){var n=LC(),r=n.get(e),o=BC(),i=o.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),0===i.length&&(o.delete(e),e.destroy()))}}function zC(e,t){t&&t.forEach((function(t){var n=t.name,r=t.plugin,o=t.translations;try{e.registerFunction(n,r,o)}catch(i){Object(Ba["b"])(i.message)}}))}function GC(e,t){if(t){var n=t.langCode;try{e.registerLanguage(n,t)}catch(r){Object(Ba["b"])(r.message)}}}function YC(e,t){t&&(e.suspendEvaluation(),t.forEach((function(t){var n=t.name,r=t.expression,o=t.scope,i=t.options;try{e.addNamedExpression(n,r,o,i)}catch(a){Object(Ba["b"])(a.message)}})),e.resumeEvaluation())}function XC(e,t){return!Object(D["isUndefined"])(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}function KC(e){return"string"===typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function $C(e){return KC(e)?e.substr(1):e}function qC(e){return ZC(e)||JC(e)||iS(e)||QC()}function QC(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function JC(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ZC(e){if(Array.isArray(e))return aS(e)}function eS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eS(Object(n),!0).forEach((function(t){OS(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nS(e){return nS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nS(e)}function rS(e,t){return sS(e)||lS(e,t)||iS(e,t)||oS()}function oS(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function iS(e,t){if(e){if("string"===typeof e)return aS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aS(e,t):void 0}}function aS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lS(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function sS(e){if(Array.isArray(e))return e}function uS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fS(e,t,n){return t&&cS(e.prototype,t),n&&cS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hS(){return hS="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=dS(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},hS.apply(this,arguments)}function dS(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=wS(e),null===e)break;return e}function pS(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yS(e,t)}function yS(e,t){return yS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yS(e,t)}function vS(e){var t=mS();return function(){var n,r=wS(e);if(t){var o=wS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gS(this,n)}}function gS(e,t){if(t&&("object"===nS(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bS(e)}function bS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mS(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function wS(e){return wS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wS(e)}function OS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CS(e,t,n){SS(e,t),t.set(e,n)}function SS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(e,t,n){var r=jS(e,t,"set");return kS(e,r,n),n}function kS(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function ES(e,t){var n=jS(e,t,"get");return TS(e,n)}function jS(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function TS(e,t){return t.get?t.get.call(e):t.value}var PS="formulas",MS=260,AS="row_move";Ne["a"].getSingleton().register("afterNamedExpressionAdded"),Ne["a"].getSingleton().register("afterNamedExpressionRemoved"),Ne["a"].getSingleton().register("afterSheetAdded"),Ne["a"].getSingleton().register("afterSheetRemoved"),Ne["a"].getSingleton().register("afterSheetRenamed"),Ne["a"].getSingleton().register("afterFormulasValuesUpdate");var IS=function(e){return"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e},_S=new WeakMap,xS=new WeakMap,HS=new WeakMap,NS=function(e){pS(n,e);var t=vS(n);function n(){var e;uS(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),CS(bS(e),_S,{writable:!0,value:!1}),CS(bS(e),xS,{writable:!0,value:!1}),CS(bS(e),HS,{writable:!0,value:[["valuesUpdated",function(){var t;return(t=e).onEngineValuesUpdated.apply(t,arguments)}],["namedExpressionAdded",function(){var t;return(t=e).onEngineNamedExpressionsAdded.apply(t,arguments)}],["namedExpressionRemoved",function(){var t;return(t=e).onEngineNamedExpressionsRemoved.apply(t,arguments)}],["sheetAdded",function(){var t;return(t=e).onEngineSheetAdded.apply(t,arguments)}],["sheetRenamed",function(){var t;return(t=e).onEngineSheetRenamed.apply(t,arguments)}],["sheetRemoved",function(){var t;return(t=e).onEngineSheetRemoved.apply(t,arguments)}]]}),OS(bS(e),"staticRegister",Object(Ss["a"])("formulas")),OS(bS(e),"engine",null),OS(bS(e),"sheetName",null),e}return fS(n,[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PS]}},{key:"enablePlugin",value:function(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=VC(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==r&&(this.sheetName=r)}this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("beforeUndo",(function(e){(null===e||void 0===e?void 0:e.actionType)!==AS&&t.engine.undo()})),this.addHook("beforeRedo",(function(e){(null===e||void 0===e?void 0:e.actionType)!==AS&&t.engine.redo()})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("beforeAutofill",(function(){return t.onBeforeAutofill.apply(t,arguments)})),ES(this,HS).forEach((function(e){var n=rS(e,2),r=n[0],o=n[1];return t.engine.on(r,o)})),hS(wS(n.prototype),"enablePlugin",this).call(this)}else Object(Ba["b"])("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var e=this;ES(this,HS).forEach((function(t){var n=rS(t,2),r=n[0],o=n[1];return e.engine.off(r,o)})),UC(this.engine,this.hot),this.engine=null,hS(wS(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(e){this.engine.updateConfig(NC(this.hot.getSettings()));var t=this.hot.getSettings()[PS];if(Object(D["isDefined"])(t)&&Object(D["isDefined"])(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),!e.data&&null===this.sheetName){var r=this.hot.getSettings()[PS].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==r&&void 0!==r?r:void 0,this.hot.getSourceDataArray())}hS(wS(n.prototype),"updatePlugin",this).call(this,e)}},{key:"destroy",value:function(){var e=this;ES(this,HS).forEach((function(t){var n,r=rS(t,2),o=r[0],i=r[1];return null===(n=e.engine)||void 0===n?void 0:n.off(o,i)})),RS(this,HS,null),UC(this.engine,this.hot),this.engine=null,hS(wS(n.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(e,t,n,r,o){return!o&&e>=n?r+(e-n):t}},{key:"toPhysicalRowPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalRow(e),this.hot.countRows(),this.hot.countSourceRows(),t)}},{key:"toPhysicalColumnPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalColumn(e),this.hot.countCols(),this.hot.countSourceCols(),t)}},{key:"addSheet",value:function(e,t){if(Object(D["isDefined"])(t)&&!Object(nw["isArrayOfArrays"])(t))return Object(Ba["b"])("The provided data should be an array of arrays."),!1;if(void 0!==e&&null!==e&&this.engine.doesSheetExist(e))return Object(Ba["b"])("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!==e&&void 0!==e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(r){return Object(Ba["b"])(r.message),!1}}},{key:"switchSheet",value:function(e){if(this.engine.doesSheetExist(e)){this.sheetName=e;var t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(Object(L["toUpperCaseFirst"])(PS),".switchSheet"))}else Object(Ba["a"])("The sheet named `".concat(e,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:r,col:o}):"EMPTY"}},{key:"isFormulaCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o&&this.engine.doesCellHaveFormula({sheet:n,row:r,col:o})}},{key:"renderDependentSheets",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;e.forEach((function(e){var t,n=null===e||void 0===e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(r.has(n)||r.add(n))})),WC(this.engine).forEach((function(e,o){var i;(n||o!==t.sheetId)&&r.has(o)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.address)&&void 0!==t?t:{},r=n.row,o=n.col,i=n.sheet;return Object(D["isDefined"])(i)?"".concat(i,":").concat(r,"x").concat(o):""},o=new Set(n.map((function(e){return r(e)})));e.forEach((function(e){var n,i,a=null!==(n=e.address)&&void 0!==n?n:{},l=a.row,s=a.col,u=Object(D["isDefined"])(l)?t.hot.toVisualRow(l):null,c=Object(D["isDefined"])(s)?t.hot.toVisualColumn(s):null;if(null!==u&&null!==c){var f=null===e||void 0===e||null===(i=e.address)||void 0===i?void 0:i.sheet,h=r(e);if(void 0!==f&&!o.has(h)){var d=WC(t.engine).get(f);if(!d)return;d.validateCell(d.getDataAtCell(u,c),d.getCellMeta(u,c),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(e,t,n){var r={row:this.toPhysicalRowPosition(e),col:this.toPhysicalColumnPosition(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(r))return this.engine.setCellContents(r,n);Object(Ba["b"])("Not possible to set cell data at ".concat(JSON.stringify(r)))}},{key:"onBeforeValidate",value:function(e,t,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){var o={row:this.hot.toPhysicalRow(t),col:this.hot.toPhysicalColumn(r),sheet:this.sheetId},i=this.engine.getCellValue(o);return"object"===nS(i)&&null!==i?i.value:i}return e}},{key:"onBeforeAutofill",value:function(e,t,n){var r=this,o=function(e){return tS(tS({},e),{},{sheet:r.sheetId})},i={start:o(t.getTopStartCorner()),end:o(t.getBottomEndCorner())},a={start:o(n.getTopStartCorner()),end:o(n.getBottomEndCorner())};return!1!==this.engine.isItPossibleToSetCellContents(a)&&this.engine.getFillRangeData(i,a)}},{key:"onBeforeLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(Object(L["toUpperCaseFirst"])(PS))||RS(this,xS,Object(D["isUndefined"])(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(Object(L["toUpperCaseFirst"])(PS)))if(this.sheetName=XC(this.engine,this.hot.getSettings()[PS].sheetName),ES(this,xS))this.switchSheet(this.sheetName);else{var r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){RS(this,_S,!0);var o=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(o),RS(this,_S,!1)}}}},{key:"onModifyData",value:function(e,t,n,r){if("get"===r&&!ES(this,_S)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(e),i=this.isFormulaCellType(o,t);if(!i){var a=this.getCellType(o,t);if("ARRAY"!==a)return void(KC(n.value)&&(n.value=$C(n.value)))}var l={row:e,col:this.toPhysicalColumnPosition(t),sheet:this.sheetId},s=this.engine.getCellValue(l),u="object"===nS(s)&&null!==s?s.value:s;n.value=u}}},{key:"onModifySourceData",value:function(e,t,n,r){if("get"===r&&!ES(this,_S)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(e),i=this.hot.propToCol(t),a=this.isFormulaCellType(o,i);if(!a){var l=this.getCellType(o,i);if("ARRAY"!==l)return}var s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==s.width||0!==s.height){var u={row:e,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};n.value=this.engine.getCellSerialized(u)}}}},{key:"onAfterSetDataAtCell",value:function(e,t){var n=this;if(!IS(t)){var r=[],o=[],i=this.engine.batch((function(){e.forEach((function(e){var t=rS(e,4),i=t[0],a=t[1],l=t[3],s=n.hot.propToCol(a),u=n.hot.toPhysicalRow(i),c=n.hot.toPhysicalColumn(s),f={row:u,col:c,sheet:n.sheetId};null!==u&&null!==c?n.syncChangeWithEngine(i,s,l):r.push([i,s,l]),o.push({address:f})}))}));r.length&&this.hot.addHookOnce("afterChange",(function(){var e=n.engine.batch((function(){r.forEach((function(e){var t=rS(e,3),r=t[0],o=t[1],i=t[2];n.syncChangeWithEngine(r,o,i)}))}));n.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}}},{key:"onAfterSetSourceDataAtCell",value:function(e,t){var n=this;if(!IS(t)){var r=[],o=[];e.forEach((function(e){var t=rS(e,4),i=t[0],a=t[1],l=t[3],s=n.hot.propToCol(a);if(Object(Tn["isNumeric"])(s)){var u={row:i,col:n.toPhysicalColumnPosition(s),sheet:n.sheetId};n.engine.isItPossibleToSetCellContents(u)?(o.push({address:u}),r.push.apply(r,qC(n.engine.setCellContents(u,l)))):Object(Ba["b"])("Not possible to set source cell data at ".concat(JSON.stringify(u)))}})),this.renderDependentSheets(r),this.validateDependentCells(r,o)}}},{key:"onBeforeCreateRow",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(e),t]))return!1}},{key:"onBeforeCreateCol",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]))return!1}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this,o=n.every((function(e){return r.engine.isItPossibleToRemoveRows(r.sheetId,[e,1])}));return!1!==o&&void 0}},{key:"onBeforeRemoveCol",value:function(e,t,n){var r=this,o=n.every((function(e){return r.engine.isItPossibleToRemoveColumns(r.sheetId,[e,1])}));return!1!==o&&void 0}},{key:"onAfterCreateRow",value:function(e,t,n){if(!IS(n)){var r=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(e),t]);this.renderDependentSheets(r)}}},{key:"onAfterCreateCol",value:function(e,t,n){if(!IS(n)){var r=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]);this.renderDependentSheets(r)}}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(!IS(r)){var i=n.sort().reverse(),a=this.engine.batch((function(){i.forEach((function(e){o.engine.removeRows(o.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterRemoveCol",value:function(e,t,n,r){var o=this;if(!IS(r)){var i=n.sort().reverse(),a=this.engine.batch((function(){i.forEach((function(e){o.engine.removeColumns(o.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterDetachChild",value:function(e,t,n){var r,o=this;RS(this,_S,!0);var i=this.hot.getSourceDataArray(n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());RS(this,_S,!1),i.forEach((function(e,t){e.forEach((function(e,r){o.engine.setCellContents({col:r,row:n+t,sheet:o.sheetId},[[e]])}))}))}},{key:"onEngineValuesUpdated",value:function(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}},{key:"onEngineNamedExpressionsAdded",value:function(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}},{key:"onEngineNamedExpressionsRemoved",value:function(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}},{key:"onEngineSheetAdded",value:function(e){this.hot.runHooks("afterSheetAdded",e)}},{key:"onEngineSheetRenamed",value:function(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}},{key:"onEngineSheetRemoved",value:function(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}],[{key:"PLUGIN_KEY",get:function(){return PS}},{key:"PLUGIN_PRIORITY",get:function(){return MS}}]),n}(Hr);function DS(e,t){return WS(e)||FS(e,t)||BS(e,t)||LS()}function LS(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function BS(e,t){if(e){if("string"===typeof e)return VS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VS(e,t):void 0}}function VS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FS(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function WS(e){if(Array.isArray(e))return e}function US(e){return{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=DS(e,4),r=n[1],o=n[3];r-o!==0&&(t=1)}return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_HIDE_COLUMN"],t)},callback:function(){for(var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.max(Math.min(n.col,r.col),0),i=Math.max(n.col,r.col),a=[],l=o;l<=i;l+=1)a.push(l);e.hideColumns(a);var s=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function zS(e){return KS(e)||XS(e)||YS(e)||GS()}function GS(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YS(e,t){if(e){if("string"===typeof e)return $S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$S(e,t):void 0}}function XS(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function KS(e){if(Array.isArray(e))return $S(e)}function $S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qS(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_SHOW_COLUMN"],e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countCols();a||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var n=this,r=Object(N["arrayMap"])(e.getHiddenColumns(),(function(e){return n.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,l=this.columnIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,zS(p.filter((function(e){return r.includes(e)}))))}}else if(0===s&&s<i)f.push.apply(f,zS(c.slice(0,i)));else if(null===s)f.push.apply(f,zS(c.slice(0,this.countCols())));else{var y=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,zS(c.slice(a+1)))}return Object(N["arrayEach"])(f,(function(e){t.push(n.toVisualColumn(e))})),0===t.length}}}var QS=n("e923");function JS(e){return JS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JS(e)}function ZS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tR(e,t,n){return t&&eR(e.prototype,t),n&&eR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nR(){return nR="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=rR(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},nR.apply(this,arguments)}function rR(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=cR(e),null===e)break;return e}function oR(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},iR(e,t)}function aR(e){var t=uR();return function(){var n,r=cR(e);if(t){var o=cR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lR(this,n)}}function lR(e,t){if(t&&("object"===JS(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sR(e)}function sR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uR(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cR(e){return cR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cR(e)}function fR(e,t,n){hR(e,t),t.set(e,n)}function hR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dR(e,t){var n=vR(e,t,"get");return pR(e,n)}function pR(e,t){return t.get?t.get.call(e):t.value}function yR(e,t,n){var r=vR(e,t,"set");return gR(e,r,n),n}function vR(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function gR(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}Ne["a"].getSingleton().register("beforeHideColumns"),Ne["a"].getSingleton().register("afterHideColumns"),Ne["a"].getSingleton().register("beforeUnhideColumns"),Ne["a"].getSingleton().register("afterUnhideColumns");var bR="hiddenColumns",mR=310,wR=new WeakMap,OR=new WeakMap,CR=function(e){oR(n,e);var t=aR(n);function n(){var e;ZS(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),fR(sR(e),wR,{writable:!0,value:{}}),fR(sR(e),OR,{writable:!0,value:null}),e}return tR(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bR]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[bR];Object(b["isObject"])(t)&&(yR(this,wR,t),Object(D["isUndefined"])(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),yR(this,OR,new QS["a"]),dR(this,OR).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,dR(this,OR)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,n,r){return e.onAfterGetCellMeta(t,n,r)})),this.addHook("modifyColWidth",(function(t,n){return e.onModifyColWidth(t,n)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),nR(cR(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),nR(cR(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),yR(this,wR,{}),nR(cR(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n,i=dR(this,OR).getValues().slice(),a=e.length>0;if(r&&a){var l=e.map((function(e){return t.hot.toPhysicalColumn(e)}));Object(N["arrayEach"])(l,(function(e){i[e]=!1})),o=Object(N["arrayReduce"])(i,(function(e,n,r){return n&&e.push(t.hot.toVisualColumn(r)),e}),[])}var s=this.hot.runHooks("beforeUnhideColumns",n,o,r&&a);!1!==s&&(r&&a&&dR(this,OR).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&a,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e))));var i=this.hot.runHooks("beforeHideColumns",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){Object(N["arrayEach"])(e,(function(e){dR(t,OR).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return Object(N["arrayMap"])(dR(this,OR).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return dR(this,OR).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){Object(N["arrayEach"])(this.hot.getCellsMeta(),(function(e){e&&(e.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:dR(this,wR).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"===typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===dR(this,wR).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(dR(this,wR).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return Object(N["arrayEach"])(e,(function(e){var n=!0,o=0;Object(Tn["rangeEach"])(e.startCol,e.endCol,(function(i){t.isHidden(i)?(n||r(e.startRow,e.endRow,o,i-1),n=!0):(n&&(o=i),i===e.endCol&&r(e.startRow,e.endRow,o,i),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(e,t){if(dR(this,wR).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Object(v["addClass"])(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:Gu},US(this),qS(this))}},{key:"onMapInit",value:function(){Array.isArray(dR(this,wR).columns)&&this.hideColumns(dR(this,wR).columns)}},{key:"destroy",value:function(){yR(this,wR,null),yR(this,OR,null),nR(cR(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bR}},{key:"PLUGIN_PRIORITY",get:function(){return mR}}]),n}(Hr);function SR(e,t){return TR(e)||jR(e,t)||kR(e,t)||RR()}function RR(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kR(e,t){if(e){if("string"===typeof e)return ER(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ER(e,t):void 0}}function ER(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jR(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function TR(e){if(Array.isArray(e))return e}function PR(e){return{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=SR(e,3),r=n[0],o=n[2];r-o!==0&&(t=1)}return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_HIDE_ROW"],t)},callback:function(){for(var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.max(Math.min(n.row,r.row),0),i=Math.max(n.row,r.row),a=[],l=o;l<=i;l+=1)a.push(l);e.hideRows(a);var s=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function MR(e){return xR(e)||_R(e)||IR(e)||AR()}function AR(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IR(e,t){if(e){if("string"===typeof e)return HR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HR(e,t):void 0}}function _R(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function xR(e){if(Array.isArray(e))return HR(e)}function HR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NR(e){var t=[];return{key:"hidden_rows_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_SHOW_ROW"],e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countRows();a||this.selectRows(o,i)}},disabled:!1,hidden:function(){var n=this,r=Object(N["arrayMap"])(e.getHiddenRows(),(function(e){return n.toPhysicalRow(e)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,l=this.rowIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,MR(p.filter((function(e){return r.includes(e)}))))}}else if(0===s&&s<i)f.push.apply(f,MR(c.slice(0,i)));else if(null===s)f.push.apply(f,MR(c.slice(0,this.countRows())));else{var y=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,MR(c.slice(a+1)))}return Object(N["arrayEach"])(f,(function(e){t.push(n.toVisualRow(e))})),0===t.length}}}function DR(e){return DR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DR(e)}function LR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VR(e,t,n){return t&&BR(e.prototype,t),n&&BR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function FR(){return FR="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=WR(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},FR.apply(this,arguments)}function WR(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=$R(e),null===e)break;return e}function UR(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zR(e,t)}function zR(e,t){return zR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zR(e,t)}function GR(e){var t=KR();return function(){var n,r=$R(e);if(t){var o=$R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YR(this,n)}}function YR(e,t){if(t&&("object"===DR(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return XR(e)}function XR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KR(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $R(e){return $R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$R(e)}function qR(e,t,n){QR(e,t),t.set(e,n)}function QR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JR(e,t){var n=tk(e,t,"get");return ZR(e,n)}function ZR(e,t){return t.get?t.get.call(e):t.value}function ek(e,t,n){var r=tk(e,t,"set");return nk(e,r,n),n}function tk(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function nk(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}Ne["a"].getSingleton().register("beforeHideRows"),Ne["a"].getSingleton().register("afterHideRows"),Ne["a"].getSingleton().register("beforeUnhideRows"),Ne["a"].getSingleton().register("afterUnhideRows");var rk="hiddenRows",ok=320,ik=new WeakMap,ak=new WeakMap,lk=function(e){UR(n,e);var t=GR(n);function n(){var e;LR(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),qR(XR(e),ik,{writable:!0,value:{}}),qR(XR(e),ak,{writable:!0,value:null}),e}return VR(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[rk]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[rk];Object(b["isObject"])(t)&&(ek(this,ik,t),Object(D["isUndefined"])(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),ek(this,ak,new QS["a"]),JR(this,ak).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,JR(this,ak)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,n,r){return e.onAfterGetCellMeta(t,n,r)})),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),FR($R(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),FR($R(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ek(this,ik,{}),FR($R(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n,i=JR(this,ak).getValues().slice(),a=e.length>0;if(r&&a){var l=e.map((function(e){return t.hot.toPhysicalRow(e)}));Object(N["arrayEach"])(l,(function(e){i[e]=!1})),o=Object(N["arrayReduce"])(i,(function(e,n,r){return n&&e.push(t.hot.toVisualRow(r)),e}),[])}var s=this.hot.runHooks("beforeUnhideRows",n,o,r&&a);!1!==s&&(r&&a&&JR(this,ak).setValues(i),this.hot.runHooks("afterUnhideRows",n,o,r&&a,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e))));var i=this.hot.runHooks("beforeHideRows",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){Object(N["arrayEach"])(e,(function(e){JR(t,ak).setValueAtIndex(t.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}},{key:"getHiddenRows",value:function(){var e=this;return Object(N["arrayMap"])(JR(this,ak).getHiddenIndexes(),(function(t){return e.hot.toVisualRow(t)}))}},{key:"isHidden",value:function(e){return JR(this,ak).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){Object(N["arrayEach"])(this.hot.getCellsMeta(),(function(e){e&&(e.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?0:e}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===JR(this,ik).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(JR(this,ik).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return Object(N["arrayEach"])(e,(function(e){var n=!0,o=0;Object(Tn["rangeEach"])(e.startRow,e.endRow,(function(i){t.isHidden(i)?(n||r(o,i-1,e.startCol,e.endCol),n=!0):(n&&(o=i),i===e.endRow&&r(o,i,e.startCol,e.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(e,t){if(JR(this,ik).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Object(v["addClass"])(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:Gu},PR(this),NR(this))}},{key:"onMapInit",value:function(){Array.isArray(JR(this,ik).rows)&&this.hideRows(JR(this,ik).rows)}},{key:"destroy",value:function(){ek(this,ik,null),ek(this,ak,null),FR($R(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rk}},{key:"PLUGIN_PRIORITY",get:function(){return ok}}]),n}(Hr);function sk(e,t){return dk(e)||hk(e,t)||ck(e,t)||uk()}function uk(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ck(e,t){if(e){if("string"===typeof e)return fk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fk(e,t):void 0}}function fk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hk(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function dk(e){if(Array.isArray(e))return e}function pk(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_FREEZE_COLUMN"])},callback:function(t,n){var r=sk(n,1),o=r[0].start.col;e.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function yk(e,t){return wk(e)||mk(e,t)||gk(e,t)||vk()}function vk(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gk(e,t){if(e){if("string"===typeof e)return bk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bk(e,t):void 0}}function bk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mk(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function wk(e){if(Array.isArray(e))return e}function Ok(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_UNFREEZE_COLUMN"])},callback:function(t,n){var r=yk(n,1),o=r[0].start.col;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function Ck(e){return Ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ck(e)}function Sk(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kk(e,t,n){return t&&Rk(e.prototype,t),n&&Rk(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ek(){return Ek="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=jk(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ek.apply(this,arguments)}function jk(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=xk(e),null===e)break;return e}function Tk(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pk(e,t)}function Pk(e,t){return Pk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pk(e,t)}function Mk(e){var t=_k();return function(){var n,r=xk(e);if(t){var o=xk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ak(this,n)}}function Ak(e,t){if(t&&("object"===Ck(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ik(e)}function Ik(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _k(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function xk(e){return xk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xk(e)}Ne["a"].getSingleton().register("beforeColumnFreeze"),Ne["a"].getSingleton().register("afterColumnFreeze"),Ne["a"].getSingleton().register("beforeColumnUnfreeze"),Ne["a"].getSingleton().register("afterColumnUnfreeze");var Hk="manualColumnFreeze",Nk=110,Dk=new WeakMap,Lk=function(e){Tk(n,e);var t=Mk(n);function n(e){var r;return Sk(this,n),r=t.call(this,e),Dk.set(Ik(r),{afterFirstUse:!1}),r}return kk(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Hk]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addContextMenuEntry(t)})),this.addHook("beforeColumnMove",(function(t,n){return e.onBeforeColumnMove(t,n)})),Ek(xk(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=Dk.get(this);e.afterFirstUse=!1,Ek(xk(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ek(xk(n.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=Dk.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnFreeze",e,r);!1!==o&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}},{key:"unfreezeColumn",value:function(e){var t=Dk.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnUnfreeze",e,r);!1!==o&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}},{key:"addContextMenuEntry",value:function(e){e.items.push({name:"---------"},pk(this),Ok(this))}},{key:"onBeforeColumnMove",value:function(e,t){var n=Dk.get(this);if(n.afterFirstUse){var r=this.hot.getSettings().fixedColumnsStart;if(t<r)return!1;if(e.some((function(e){return e<r})))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return Hk}},{key:"PLUGIN_PRIORITY",get:function(){return Nk}}]),n}(Hr);function Bk(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fk(e,t,n){return t&&Vk(e.prototype,t),n&&Vk(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Wk=0,Uk=1,zk=2,Gk="px",Yk=function(){function e(t){Bk(this,e),this.hot=t,this._element=null,this.state=Wk,this.inlineProperty=t.isRtl()?"right":"left"}return Fk(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=zk}},{key:"build",value:function(){this.state===Wk&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Uk)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Wk}},{key:"isAppended",value:function(){return this.state===zk}},{key:"isBuilt",value:function(){return this.state>=Uk}},{key:"setPosition",value:function(e,t){Object(Tn["isNumeric"])(e)&&(this._element.style.top=e+Gk),Object(Tn["isNumeric"])(t)&&(this._element.style[this.inlineProperty]=t+Gk)}},{key:"getPosition",value:function(){var e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}},{key:"setSize",value:function(e,t){Object(Tn["isNumeric"])(e)&&(this._element.style.width=e+Gk),Object(Tn["isNumeric"])(t)&&(this._element.style.height=t+Gk)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){Object(Tn["isNumeric"])(e)&&(this._element.style.marginTop=e+Gk),Object(Tn["isNumeric"])(t)&&(this._element.style["margin".concat(Object(L["toUpperCaseFirst"])(this.inlineProperty))]=t+Gk)}},{key:"getOffset",value:function(){var e=this._element.style,t="margin".concat(Object(L["toUpperCaseFirst"])(this.inlineProperty));return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}]),e}(),Xk=Yk;function Kk(e){return Kk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kk(e)}function $k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qk(e,t,n){return t&&qk(e.prototype,t),n&&qk(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jk(){return Jk="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Zk(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Jk.apply(this,arguments)}function Zk(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=aE(e),null===e)break;return e}function eE(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tE(e,t)}function tE(e,t){return tE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tE(e,t)}function nE(e){var t=iE();return function(){var n,r=aE(e);if(t){var o=aE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rE(this,n)}}function rE(e,t){if(t&&("object"===Kk(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return oE(e)}function oE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iE(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function aE(e){return aE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aE(e)}var lE="ht__manualColumnMove--backlight",sE=function(e){eE(n,e);var t=nE(n);function n(){return $k(this,n),t.apply(this,arguments)}return Qk(n,[{key:"build",value:function(){Jk(aE(n.prototype),"build",this).call(this),Object(v["addClass"])(this._element,lE)}}]),n}(Xk),uE=sE;function cE(e){return cE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cE(e)}function fE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dE(e,t,n){return t&&hE(e.prototype,t),n&&hE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pE(){return pE="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=yE(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},pE.apply(this,arguments)}function yE(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=CE(e),null===e)break;return e}function vE(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gE(e,t)}function gE(e,t){return gE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gE(e,t)}function bE(e){var t=OE();return function(){var n,r=CE(e);if(t){var o=CE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mE(this,n)}}function mE(e,t){if(t&&("object"===cE(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wE(e)}function wE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OE(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function CE(e){return CE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},CE(e)}var SE="ht__manualColumnMove--guideline",RE=function(e){vE(n,e);var t=bE(n);function n(){return fE(this,n),t.apply(this,arguments)}return dE(n,[{key:"build",value:function(){pE(CE(n.prototype),"build",this).call(this),Object(v["addClass"])(this._element,SE)}}]),n}(Xk),kE=RE;function EE(e){return EE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EE(e)}function jE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PE(e,t,n){return t&&TE(e.prototype,t),n&&TE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ME(){return ME="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=AE(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ME.apply(this,arguments)}function AE(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=LE(e),null===e)break;return e}function IE(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_E(e,t)}function _E(e,t){return _E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_E(e,t)}function xE(e){var t=DE();return function(){var n,r=LE(e);if(t){var o=LE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HE(this,n)}}function HE(e,t){if(t&&("object"===EE(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return NE(e)}function NE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DE(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function LE(e){return LE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},LE(e)}Ne["a"].getSingleton().register("beforeColumnMove"),Ne["a"].getSingleton().register("afterColumnMove");var BE="manualColumnMove",VE=120,FE=new WeakMap,WE="ht__manualColumnMove",UE="show-ui",zE="on-moving--columns",GE="after-selection--columns",YE=function(e){IE(n,e);var t=xE(n);function n(e){var r;return jE(this,n),r=t.call(this,e),FE.set(NE(r),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),r.eventManager=new we["a"](NE(r)),r.backlight=new uE(e),r.guideline=new kE(e),r}return PE(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BE]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollVertically",(function(){return e.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.buildPluginUI(),this.registerEvents(),Object(v["addClass"])(this.hot.rootElement,WE),ME(LE(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ME(LE(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Object(v["removeClass"])(this.hot.rootElement,WE),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ME(LE(n.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){return this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var n=FE.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.columnIndexMapper.moveIndexes(e,t);var a=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,o,a),a}}},{key:"dragColumn",value:function(e,t){return this.dragColumns([e],t)}},{key:"dragColumns",value:function(e,t){var n=this.countFinalIndex(e,t),r=FE.get(this);return r.cachedDropIndex=t,this.moveColumns(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=n}));return!(r||o||i||a)}},{key:"isColumnOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=Object(N["arrayReduce"])(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getColumnsWidth",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=0,o=e;o<=t;o+=1){var i=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==i&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(i)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings()[BE];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}},{key:"isFixedColumnsStart",value:function(e){return e<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}},{key:"prepareColumnsToMoving",value:function(e,t){var n=[];return Object(Tn["rangeEach"])(e,t,(function(e){n.push(e)})),n}},{key:"refreshPositions",value:function(){var e=FE.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));var n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,o="number"===typeof r.scrollX?r.scrollX:r.scrollLeft,i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1),a=n.hider.offsetWidth,l=n.TBODY.offsetLeft,s=this.backlight.getOffset().start,u=this.backlight.getSize().width,c=0,f=0;if(this.hot.isRtl()){var h=this.hot.rootWindow,d=Object(v["outerWidth"])(this.hot.rootElement),p=h.innerWidth-e.rootElementOffset-d;f=h.innerWidth-e.target.eventPageX-p-(void 0===r.scrollX?o:0)}else f=e.target.eventPageX-(e.rootElementOffset-(void 0===r.scrollX?o:0));if(e.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(i+=o),i+=c,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+i<=f){var y=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=y+1,i+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;var g=f,b=i;f+u+s>=a?g=a-u-s:f+s<l+c&&(g=l+c+Math.abs(s)),i>=a-1?b=a-1:0===b?b=1:void 0!==r.scrollX&&e.hoveredColumn<e.fixedColumnsStart&&(b-=e.rootElementOffset<=r.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,g),this.guideline.setPosition(null,b)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view._wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=FE.get(this),s=Object(v["hasClass"])(e.target,"sortAction");if(!a||!i||l.pressed||0!==e.button||s)return l.pressed=!1,l.columnsToMove.length=0,void Object(v["removeClass"])(this.hot.rootElement,[zE,UE]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(t.row<0&&t.col>=d&&t.col<=p){r.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=n,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(d,p),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Object(v["offset"])(this.hot.rootElement).left;var y=l.hasRowHeaders?-1:0,g=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,b=t.col<l.fixedColumnsStart,m=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),w=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),O=this.getColumnsWidth(d,t.col-1)+w,C=this.getColumnsWidth(y,d-1)+(b?m:0)+O;this.backlight.setPosition(g,C),this.backlight.setSize(this.getColumnsWidth(d,p),o.hider.offsetHeight-g),this.backlight.setOffset(null,-O),Object(v["addClass"])(this.hot.rootElement,zE)}else Object(v["removeClass"])(this.hot.rootElement,GE),l.pressed=!1,l.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=FE.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),i=FE.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(t.col)>-1?Object(v["removeClass"])(this.hot.rootElement,UE):Object(v["addClass"])(this.hot.rootElement,UE),r.row=!0,r.column=!0,r.cell=!0,i.hoveredColumn=t.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=FE.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,Object(v["removeClass"])(this.hot.rootElement,[zE,UE,GE]),this.hot.selection.isSelectedByColumnHeader()&&Object(v["addClass"])(this.hot.rootElement,GE),!(n<1||void 0===t)){var r=e.columnsToMove[0],o=this.hot.toPhysicalColumn(r),i=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualColumn(o),l=a+n-1;this.hot.selectColumns(a,l)}}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,n=e.holder.scrollTop,r=t+n;this.backlight.setPosition(r),this.backlight.setSize(null,e.hider.offsetHeight-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ME(LE(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return BE}},{key:"PLUGIN_PRIORITY",get:function(){return VE}}]),n}(Hr);function XE(e){return XE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XE(e)}function KE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qE(e,t,n){return t&&$E(e.prototype,t),n&&$E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function QE(){return QE="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=JE(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},QE.apply(this,arguments)}function JE(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ij(e),null===e)break;return e}function ZE(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ej(e,t)}function ej(e,t){return ej=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ej(e,t)}function tj(e){var t=oj();return function(){var n,r=ij(e);if(t){var o=ij(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nj(this,n)}}function nj(e,t){if(t&&("object"===XE(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return rj(e)}function rj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ij(e){return ij=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ij(e)}var aj="manualColumnResize",lj=130,sj="manualColumnWidths",uj=new WeakMap,cj=function(e){ZE(n,e);var t=tj(n);function n(e){var r;KE(this,n),r=t.call(this,e);var o=r.hot.rootDocument;return r.currentTH=null,r.currentCol=null,r.selectedCols=[],r.currentWidth=null,r.newSize=null,r.startY=null,r.startWidth=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new we["a"](rj(r)),r.pressed=null,r.dblclick=0,r.autoresizeTimeout=null,r.columnWidthsMap=void 0,uj.set(rj(r),{config:void 0}),Object(v["addClass"])(r.handle,"manualColumnResizer"),Object(v["addClass"])(r.guide,"manualColumnResizerGuide"),r}return qE(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[aj]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnWidthsMap=new no["a"],this.columnWidthsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(t,n){return e.onModifyColWidth(t,n)})),this.addHook("beforeStretchingColumnWidth",(function(t,n){return e.onBeforeStretchingColumnWidth(t,n)})),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)})),this.bindEvents(),QE(ij(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),QE(ij(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=uj.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),QE(ij(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",sj,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",sj,e),e.value}},{key:"setManualSize",value:function(e,t){var n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(e){var t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}},{key:"onMapInit",value:function(){var e=this,t=uj.get(this),n=this.hot.getSettings()[aj],r=this.loadManualColumnWidths();"undefined"!==typeof r?this.hot.batchExecution((function(){r.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),t.config=n):!0===n&&Array.isArray(t.config)&&this.hot.batchExecution((function(){t.config.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"setupHandlePosition",value:function(e){var t=this;if(e.parentNode){this.currentTH=e;var n=this.hot.view._wt,r=n.wtTable.getCoords(this.currentTH),o=r.col;if(!(o<0)){var i,a=Object(v["outerHeight"])(this.currentTH),l=this.currentTH.getBoundingClientRect(),s=o<n.getSetting("fixedColumnsStart");s&&(i=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),i||(i=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];var u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){var c=this.hot.getSelectedRange();Object(N["arrayEach"])(c,(function(e){var n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col;Object(Tn["rangeEach"])(n,r,(function(e){t.selectedCols.includes(e)||t.selectedCols.push(e)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=i.start-6,this.startWidth=parseInt(l.width,10),this.handle.style.top="".concat(i.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(a,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(Object(v["outerHeight"])(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Object(v["addClass"])(this.handle,"active"),Object(v["addClass"])(this.guide,"active"),this.guide.style.top="".concat(t,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Object(v["removeClass"])(this.handle,"active"),Object(v["removeClass"])(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(e){return!!Object(v["closest"])(e,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}},{key:"onMouseOver",value:function(e){if(!Object(v["isDetached"])(e.target)&&this.checkIfColumnHeader(e.target)){var t=this.getClosestTHParent(e.target);if(!t)return;var n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||this.pressed||this.setupHandlePosition(t)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeColumnResize",e.newSize,n,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!0),r&&t()};if(this.dblclick>=2){var r=this.selectedCols.length;r>1?(Object(N["arrayEach"])(this.selectedCols,(function(e){n(e)})),t()):Object(N["arrayEach"])(this.selectedCols,(function(e){n(e,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;Object(v["hasClass"])(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;if(this.pressed){var n=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,Object(N["arrayEach"])(this.selectedCols,(function(e){t.newSize=t.setManualSize(e,t.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeColumnResize",e.newSize,n,!1),r&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var r=this.selectedCols.length;r>1?(Object(N["arrayEach"])(this.selectedCols,(function(e){n(e)})),t()):Object(N["arrayEach"])(this.selectedCols,(function(e){n(e,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootWindow,r=t.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(r,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(n,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(n,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyColWidth",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[aj]&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var n=this.columnWidthsMap.getValueAtIndex(t);return null===n&&(n=e),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){QE(ij(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return aj}},{key:"PLUGIN_PRIORITY",get:function(){return lj}}]),n}(Hr);function fj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dj(e,t,n){return t&&hj(e.prototype,t),n&&hj(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var pj=0,yj=1,vj=2,gj="px",bj=function(){function e(t){fj(this,e),this.hot=t,this._element=null,this.state=pj}return dj(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=vj}},{key:"build",value:function(){this.state===pj&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yj)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=pj}},{key:"isAppended",value:function(){return this.state===vj}},{key:"isBuilt",value:function(){return this.state>=yj}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+gj),void 0!==t&&(this._element.style.left=t+gj)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+gj),t&&(this._element.style.height=t+gj)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+gj),t&&(this._element.style.marginLeft=t+gj)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}(),mj=bj;function wj(e){return wj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wj(e)}function Oj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sj(e,t,n){return t&&Cj(e.prototype,t),n&&Cj(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rj(){return Rj="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=kj(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Rj.apply(this,arguments)}function kj(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Ij(e),null===e)break;return e}function Ej(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jj(e,t)}function jj(e,t){return jj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jj(e,t)}function Tj(e){var t=Aj();return function(){var n,r=Ij(e);if(t){var o=Ij(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pj(this,n)}}function Pj(e,t){if(t&&("object"===wj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Mj(e)}function Mj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ij(e){return Ij=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ij(e)}var _j="ht__manualRowMove--backlight",xj=function(e){Ej(n,e);var t=Tj(n);function n(){return Oj(this,n),t.apply(this,arguments)}return Sj(n,[{key:"build",value:function(){Rj(Ij(n.prototype),"build",this).call(this),Object(v["addClass"])(this._element,_j)}}]),n}(mj),Hj=xj;function Nj(e){return Nj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nj(e)}function Dj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bj(e,t,n){return t&&Lj(e.prototype,t),n&&Lj(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vj(){return Vj="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Fj(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Vj.apply(this,arguments)}function Fj(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Kj(e),null===e)break;return e}function Wj(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uj(e,t)}function Uj(e,t){return Uj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Uj(e,t)}function zj(e){var t=Xj();return function(){var n,r=Kj(e);if(t){var o=Kj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Gj(this,n)}}function Gj(e,t){if(t&&("object"===Nj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Yj(e)}function Yj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Kj(e){return Kj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kj(e)}var $j="ht__manualRowMove--guideline",qj=function(e){Wj(n,e);var t=zj(n);function n(){return Dj(this,n),t.apply(this,arguments)}return Bj(n,[{key:"build",value:function(){Vj(Kj(n.prototype),"build",this).call(this),Object(v["addClass"])(this._element,$j)}}]),n}(mj),Qj=qj;function Jj(e){return Jj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jj(e)}function Zj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tT(e,t,n){return t&&eT(e.prototype,t),n&&eT(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nT(){return nT="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=rT(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},nT.apply(this,arguments)}function rT(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=cT(e),null===e)break;return e}function oT(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iT(e,t)}function iT(e,t){return iT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},iT(e,t)}function aT(e){var t=uT();return function(){var n,r=cT(e);if(t){var o=cT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lT(this,n)}}function lT(e,t){if(t&&("object"===Jj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sT(e)}function sT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uT(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cT(e){return cT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cT(e)}Ne["a"].getSingleton().register("beforeRowMove"),Ne["a"].getSingleton().register("afterRowMove");var fT="manualRowMove",hT=140,dT=new WeakMap,pT="ht__manualRowMove",yT="show-ui",vT="on-moving--rows",gT="after-selection--rows",bT=function(e){oT(n,e);var t=aT(n);function n(e){var r;return Zj(this,n),r=t.call(this,e),dT.set(sT(r),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),r.eventManager=new we["a"](sT(r)),r.backlight=new Hj(e),r.guideline=new Qj(e),r}return tT(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fT]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollHorizontally",(function(){return e.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.buildPluginUI(),this.registerEvents(),Object(v["addClass"])(this.hot.rootElement,pT),nT(cT(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),nT(cT(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Object(v["removeClass"])(this.hot.rootElement,pT),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),nT(cT(n.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){return this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var n=dT.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.rowIndexMapper.moveIndexes(e,t);var a=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,o,a),a}}},{key:"dragRow",value:function(e,t){return this.dragRows([e],t)}},{key:"dragRows",value:function(e,t){var n=this.countFinalIndex(e,t),r=dT.get(this);return r.cachedDropIndex=t,this.moveRows(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=n}));return!(r||o||i||a)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=Object(N["arrayReduce"])(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getRowsHeight",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=0,o=e;o<=t;o++){var i=n.getRenderableFromVisualIndex(o);null!==i&&(r+=this.hot.view._wt.wtTable.getRowHeight(i)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings()[fT];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;var n=e.from,r=e.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return Object(Tn["rangeEach"])(o,i,(function(e){t.push(e)})),t}},{key:"refreshPositions",value:function(){var e=dT.get(this),t=e.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(t.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(t.row)&&r<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);var i=this.hot.view._wt.wtTable,a=e.target.TD,l=Object(v["offset"])(this.hot.rootElement),s=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),u=e.target.eventPageY-l.top+i.holder.scrollTop,c=i.hider.offsetHeight,f=i.TBODY.offsetTop,h=this.backlight.getOffset().top,d=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(s+=i.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:a.offsetHeight/2+s<=u?(e.target.row=t.row+1,s+=0===t.row?a.offsetHeight-1:a.offsetHeight):e.target.row=t.row;var p=u,y=s;u+d+h>=c?p=c-d-h:u+h<f&&(p=f+Math.abs(h)),s>=c-1&&(y=c-1),this.backlight.setPosition(p),this.guideline.setPosition(y)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view._wt,i=o.wtTable,a=o.wtViewport,l=this.hot.selection.isSelectedByRowHeader(),s=this.hot.getSelectedRangeLast(),u=dT.get(this);if(!s||!l||u.pressed||0!==e.button)return u.pressed=!1,u.rowsToMove.length=0,void Object(v["removeClass"])(this.hot.rootElement,[vT,yT]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=s.from,d=s.to,p=Math.min(h.row,d.row),y=Math.max(h.row,d.row);if(t.col<0&&t.row>=p&&t.row<=y){r.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving();var g=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,g),this.backlight.setSize(i.hider.offsetWidth-g,this.getRowsHeight(p,y)),this.backlight.setOffset(-1*(this.getRowsHeight(p,t.row-1)+e.offsetY),null),Object(v["addClass"])(this.hot.rootElement,vT),this.refreshPositions()}else Object(v["removeClass"])(this.hot.rootElement,gT),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=dT.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),i=dT.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(t.row)>-1?Object(v["removeClass"])(this.hot.rootElement,yT):Object(v["addClass"])(this.hot.rootElement,yT),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=t,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=dT.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,Object(v["removeClass"])(this.hot.rootElement,[vT,yT,gT]),this.hot.selection.isSelectedByRowHeader()&&Object(v["addClass"])(this.hot.rootElement,gT),!(n<1||void 0===t)){var r=e.rowsToMove[0],o=this.hot.toPhysicalRow(r),i=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualRow(o),l=a+n-1;this.hot.selectRows(a,l)}}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=e.holder.scrollLeft,r=t+n;this.backlight.setPosition(null,r),this.backlight.setSize(e.hider.offsetWidth-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),nT(cT(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fT}},{key:"PLUGIN_PRIORITY",get:function(){return hT}}]),n}(Hr),mT=n("38f3");function wT(e){return wT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wT(e)}function OT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ST(e,t,n){return t&&CT(e.prototype,t),n&&CT(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function RT(){return RT="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=kT(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},RT.apply(this,arguments)}function kT(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=IT(e),null===e)break;return e}function ET(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jT(e,t)}function jT(e,t){return jT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jT(e,t)}function TT(e){var t=AT();return function(){var n,r=IT(e);if(t){var o=IT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return PT(this,n)}}function PT(e,t){if(t&&("object"===wT(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return MT(e)}function MT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AT(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function IT(e){return IT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},IT(e)}var _T,xT,HT,NT,DT="manualRowResize",LT=30,BT="manualRowHeights",VT=new WeakMap,FT=function(e){ET(n,e);var t=TT(n);function n(e){var r;OT(this,n),r=t.call(this,e);var o=r.hot.rootDocument;return r.currentTH=null,r.currentRow=null,r.selectedRows=[],r.currentHeight=null,r.newSize=null,r.startY=null,r.startHeight=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new we["a"](MT(r)),r.pressed=null,r.dblclick=0,r.autoresizeTimeout=null,r.rowHeightsMap=void 0,VT.set(MT(r),{config:void 0}),Object(v["addClass"])(r.handle,"manualRowResizer"),Object(v["addClass"])(r.guide,"manualRowResizerGuide"),r}return ST(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[DT]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.rowHeightsMap=new no["a"],this.rowHeightsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.bindEvents(),RT(IT(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),RT(IT(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=VT.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),RT(IT(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",BT,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",BT,e),e.value}},{key:"setManualSize",value:function(e,t){var n=this.hot.toPhysicalRow(e),r=Math.max(t,mT["a"].DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var n=this.hot.view,r=n._wt,o=r.wtTable.getCoords(this.currentTH),i=o.row;if(!(i<0)){var a,l=Object(v["outerWidth"])(this.currentTH),s=this.currentTH.getBoundingClientRect(),u=i<r.getSetting("fixedRowsTop"),c=i>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");u?a=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):c&&(a=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),a||(a=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){var h=this.hot.getSelectedRange();Object(N["arrayEach"])(h,(function(e){var n=e.getTopStartCorner().row,r=e.getBottomStartCorner().row;Object(Tn["rangeEach"])(n,r,(function(e){t.selectedRows.includes(e)||t.selectedRows.push(e)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=a.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(a.start,"px"),this.handle.style.width="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(Object(v["outerWidth"])(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Object(v["addClass"])(this.handle,"active"),Object(v["addClass"])(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(t,"px"),this.guide.style.width="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Object(v["removeClass"])(this.handle,"active"),Object(v["removeClass"])(this.guide,"active")}},{key:"checkIfRowHeader",value:function(e){var t,n,r=Object(v["closest"])(e,["TH"],this.hot.rootElement);return r&&"TBODY"===(null===(t=e.parentNode)||void 0===t||null===(n=t.parentNode)||void 0===n?void 0:n.tagName)}},{key:"getClosestTHParent",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}},{key:"getActualRowHeight",value:function(e){var t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}},{key:"onMouseOver",value:function(e){if(!Object(v["isDetached"])(e.target)&&this.checkIfRowHeader(e.target)){var t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!0);void 0!==o&&(e.newSize=o),e.setManualSize(n,e.newSize),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!0),r&&t()};if(this.dblclick>=2){var r=this.selectedRows.length;r>1?(Object(N["arrayEach"])(this.selectedRows,(function(e){n(e)})),t()):Object(N["arrayEach"])(this.selectedRows,(function(e){n(e,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;Object(v["hasClass"])(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),Object(N["arrayEach"])(this.selectedRows,(function(e){t.newSize=t.setManualSize(e,t.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!1),r&&t(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var r=this.selectedRows.length;r>1?(Object(N["arrayEach"])(this.selectedRows,(function(e){n(e)})),t()):Object(N["arrayEach"])(this.selectedRows,(function(e){n(e,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootElement,r=t.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(n,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(r,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(r,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[DT]&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var e=this,t=VT.get(this),n=this.hot.getSettings()[DT],r=this.loadManualRowHeights();this.hot.batchExecution((function(){"undefined"!==typeof r?r.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})):Array.isArray(n)?(n.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})),t.config=n):!0===n&&Array.isArray(t.config)&&t.config.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"destroy",value:function(){RT(IT(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DT}},{key:"PLUGIN_PRIORITY",get:function(){return LT}}]),n}(Hr);function WT(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function UT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GT(e,t,n){return t&&zT(e.prototype,t),n&&zT(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var YT,XT=function(){function e(t,n,r,o,i,a){UT(this,e),this.row=t,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return GT(e,[{key:"normalize",value:function(e){var t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",i=e[0]?"col":"row",a=Math.min(t,r),l=Math.max(t,r),s=this[i],u=this[i]+this[o]-1;if(s>=t&&(this[i]+=n),n>0)t<=u&&t>s&&(this[o]+=n);else if(n<0){if(a<=s&&l>=u)return this.removed=!0,!1;if(s>=a&&s<=l){var c=l-s+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(s<=a&&u>=l)this[o]+=n;else if(s<=a&&u>=a&&u<l){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return Object(Cu["a"])(_T||(_T=WT(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return Object(Cu["a"])(xT||(xT=WT(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return Object(Cu["a"])(HT||(HT=WT(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return Object(Cu["a"])(NT||(NT=WT(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}}]),e}(),KT=XT;function $T(e,t,n,r){t?t.row===n&&t.col===r?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function qT(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function QT(e){return tP(e)||eP(e)||ZT(e)||JT()}function JT(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ZT(e,t){if(e){if("string"===typeof e)return nP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nP(e,t):void 0}}function eP(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function tP(e){if(Array.isArray(e))return nP(e)}function nP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iP(e,t,n){return t&&oP(e.prototype,t),n&&oP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var aP=function(){function e(t){rP(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return iP(e,[{key:"get",value:function(e,t){var n=this.mergedCells,r=!1;return Object(N["arrayEach"])(n,(function(n){return!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t)||(r=n,!1)})),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return Object(N["arrayEach"])(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t,n)})),n}},{key:"getWithinRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,o=[],i=e;if(!i.includesRange){var a=this.hot._createCellCoords(i.from.row,i.from.col),l=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(a,a,l)}return Object(N["arrayEach"])(r,(function(e){var r=t.hot._createCellCoords(e.row,e.col),a=t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),l=t.hot._createCellRange(r,r,a);n?i.overlaps(l)&&o.push(e):i.includesRange(l)&&o.push(e)})),!!o.length&&o}},{key:"add",value:function(t){var n=this.mergedCells,r=t.row,o=t.col,i=t.rowspan,a=t.colspan,l=new KT(r,o,i,a,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(r,o),u=this.isOverlapping(l);return s||u?(Object(Ba["b"])(e.IS_OVERLAPPING_WARNING(l)),!1):(this.hot&&l.normalize(this.hot),n.push(l),l)}},{key:"remove",value:function(e,t){var n=this.mergedCells,r=this.get(e,t),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,n=[],r=[];Object(N["arrayEach"])(t,(function(t){var r=e.hot.getCell(t.row,t.col);r&&n.push([r,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,Object(N["arrayEach"])(n,(function(t,o){Object(Tn["rangeEach"])(0,t.rowspan-1,(function(n){Object(Tn["rangeEach"])(0,t.colspan-1,(function(o){if(0!==o||0!==n){var i=e.hot.getCell(t.row+n,t.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),Object(N["arrayEach"])(n,(function(e){$T.apply(void 0,QT(e))})),Object(N["arrayEach"])(r,(function(e){$T.apply(void 0,QT(e))}))}},{key:"isOverlapping",value:function(e){var t=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),r=!1;return Object(N["arrayEach"])(this.mergedCells,(function(e){var o=t.hot._createCellRange(t.hot._createCellCoords(0,0),t.hot._createCellCoords(e.row,e.col),t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));return!o.overlaps(n)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(e,t){var n=this.get(e,t);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);var r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,o)}},{key:"shiftCollections",value:function(e,t,n){var r=this,o=[0,0];switch(e){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break;default:}Object(N["arrayEach"])(this.mergedCells,(function(e){e.shift(o,t)})),Object(Tn["rangeEachReverse"])(this.mergedCells.length-1,0,(function(e){var t=r.mergedCells[e];t&&t.removed&&r.mergedCells.splice(r.mergedCells.indexOf(t),1)}))}}],[{key:"IS_OVERLAPPING_WARNING",value:function(e){return Object(Cu["a"])(YT||(YT=qT(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),e.row,e.col)}}]),e}(),lP=aP;function sP(e,t){return dP(e)||hP(e,t)||cP(e,t)||uP()}function uP(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cP(e,t){if(e){if("string"===typeof e)return fP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fP(e,t):void 0}}function fP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hP(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function dP(e){if(Array.isArray(e))return e}function pP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vP(e,t,n){return t&&yP(e.prototype,t),n&&yP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var gP=function(){function e(t){pP(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return vP(e,[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){var n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}},{key:"snapDragArea",value:function(e,t,n,r){var o=t.slice(0),i=this.getAutofillSize(e,t,n),a=sP(e,4),l=a[0],s=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(n)>-1,h=f?u-l+1:c-s+1,d=Math.floor(i/h)*h,p=i-d,y=this.getFarthestCollection(e,t,n,r);if(y)if("down"===n){var v=y.row+y.rowspan-l-p,g=o[2]+v;g>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?v:0}else if("right"===n){var b=y.col+y.colspan-s-p,m=o[3]+b;m>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?b:0}else if("up"===n){var w=u-p-y.row+1,O=o[0]+w;O<0?o[0]+=p:o[0]-=p?w:0}else if("left"===n){var C=c-p-y.col+1,S=o[1]+C;S<0?o[1]+=p:o[1]-=p?C:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:h}),o}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),Object(b["extend"])(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,n){var r=sP(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=sP(t,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-l;default:return null}}},{key:"getDragArea",value:function(e,t,n){var r=sP(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=sP(t,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return[u,c,o-1,l];case"down":return[a+1,i,f,l];case"left":return[u,c,a,i-1];case"right":return[o,l+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(e,t,n,r){var o=sP(e,4),i=o[0],a=o[1],l=o[2],s=o[3],u=["up","down"].indexOf(n)>-1,c=u?l:s,f=u?i:a,h=this.getAutofillSize(e,t,n),d=u?l-i+1:s-a+1,p=Math.floor(h/d)*d,y=h-p,v=null,g=null,b=null;switch(n){case"up":v="includesVertically",b=c-y+1;break;case"left":v="includesHorizontally",b=c-y+1;break;case"down":v="includesVertically",b=f+y-1;break;case"right":v="includesHorizontally",b=f+y-1;break;default:}return Object(N["arrayEach"])(r,(function(e){e[v](b)&&e.isFarther(g,n)&&(g=e)})),g}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(e,n){switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}},i=0,a=null,l=1;do{for(var s=0;s<n.length;s+=1){if(a=n[s],i=l*this.currentFillData.cycleLength,o(a,i))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan});break;default:}s===n.length-1&&(l+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,n={min:null,max:null},r={min:null,max:null};return Object(N["arrayEach"])(e,(function(e){var o=e[0],i=t.plugin.hot.propToCol(e[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,n){var r=this.getDragArea(e,t,n),o=sP(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.plugin.hot._createCellCoords(i,a),c=this.plugin.hot._createCellCoords(l,s),f=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(f,!0)}}]),e}(),bP=gP;function mP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OP(e,t,n){return t&&wP(e.prototype,t),n&&wP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var CP=function(){function e(t){mP(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return OP(e,[{key:"snapDelta",value:function(e,t,n){var r=t.to,o=r.row+e.row,i=r.col+e.col;e.row?this.jumpOverMergedCell(e,n,o):e.col&&this.jumpOverMergedCell(e,n,i)}},{key:"jumpOverMergedCell",value:function(e,t,n){var r=e.row||e.col,o=null,i=null,a=null;e.row?(o=t.includesVertically(n),i=t.row,a=t.getLastRow()):e.col&&(o=t.includesHorizontally(n),i=t.col,a=t.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),e.row?e.row=r:e.col&&(e.col=r))}},{key:"getUpdatedSelectionRange",value:function(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,n,r){var o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0!==r){var s=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t);if(s){var u=this.plugin.mergedCellsCollection.get(e,t);if(u){var c=u.getLastRow(),f=u.getLastColumn(),h=o<=u.row&&i<=u.col&&a>=c&&l>=f;return h?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}}},{key:"isMergeCellFullySelected",value:function(e,t){var n=[];if(!t||!e)return!1;for(var r=0;r<e.rowspan;r+=1)for(var o=0;o<e.colspan;o+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],l=0;l<t.length;l+=1)a[l]=t[l].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}]),e}(),SP=CP;function RP(e){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_UNMERGE_CELLS"])}return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_MERGE_CELLS"])},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();if(!e)return!0;var t=KT.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1});return t||this.selection.isSelectedByCorner()},hidden:!1}}function kP(e){return kP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kP(e)}function EP(e,t){return PP(e)||TP(e,t)||IP(e,t)||jP()}function jP(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function TP(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function PP(e){if(Array.isArray(e))return e}function MP(e){return xP(e)||_P(e)||IP(e)||AP()}function AP(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IP(e,t){if(e){if("string"===typeof e)return HP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HP(e,t):void 0}}function _P(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function xP(e){if(Array.isArray(e))return HP(e)}function HP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LP(e,t,n){return t&&DP(e.prototype,t),n&&DP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function BP(){return BP="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=VP(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},BP.apply(this,arguments)}function VP(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=XP(e),null===e)break;return e}function FP(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WP(e,t)}function WP(e,t){return WP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},WP(e,t)}function UP(e){var t=YP();return function(){var n,r=XP(e);if(t){var o=XP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zP(this,n)}}function zP(e,t){if(t&&("object"===kP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return GP(e)}function GP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YP(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function XP(e){return XP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},XP(e)}Ne["a"].getSingleton().register("beforeMergeCells"),Ne["a"].getSingleton().register("afterMergeCells"),Ne["a"].getSingleton().register("beforeUnmergeCells"),Ne["a"].getSingleton().register("afterUnmergeCells");var KP,$P="mergeCells",qP=150,QP=new WeakMap,JP=$P,ZP=function(e){FP(n,e);var t=UP(n);function n(e){var r;return NP(this,n),r=t.call(this,e),QP.set(GP(r),{lastDesiredCoords:null}),r.mergedCellsCollection=null,r.autofillCalculations=null,r.selectionCalculations=null,r}return LP(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$P]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new lP(this),this.autofillCalculations=new bP(this),this.selectionCalculations=new SP(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),this.addHook("beforeUndoStackChange",(function(e,t){if("MergeCells"===t)return!1})),this.registerShortcuts(),BP(XP(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),BP(XP(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings()[$P];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),BP(XP(n.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(KT.containsNegativeValues(e)?(Object(Ba["b"])(KT.NEGATIVE_VALUES_WARNING(e)),t=!1):KT.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Object(Ba["b"])(KT.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):KT.isSingleCell(e)?(Object(Ba["b"])(KT.IS_SINGLE_CELL(e)),t=!1):KT.containsZeroSpan(e)&&(Object(Ba["b"])(KT.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var n,r=[];Object(N["arrayEach"])(e,(function(e){if(t.validateSetting(e)){var n=t.hot._createCellCoords(e.row,e.col),o=t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),i=t.hot._createCellRange(n,n,o);r.push(t.mergeRange(i,!0,!0))}})),r=r.filter((function(e){return!0!==e}));var o=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,MP(o))}}},{key:"getBulkCollectionData",value:function(e){var t,n=this.getBulkCollectionDataRange(e),r=(t=this.hot).getData.apply(t,MP(n)),o=r.splice(0);return Object(N["arrayEach"])(e,(function(e){var t=EP(e,3),r=t[0],i=t[1],a=t[2];Object(N["arrayEach"])(a,(function(e,t){Object(N["arrayEach"])(e,(function(e,a){o[r-n[0]+t][i-n[1]+a]=e}))}))})),[n[0],n[1],o]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],n=[0,0],r=null,o=null,i=null;return Object(N["arrayEach"])(e,(function(e){r=e[0],o=e[1],i=e[2],t[0]=Math.min(r,t[0]),t[1]=Math.min(o,t[1]),n[0]=Math.max(r+i.length-1,n[0]),n[1]=Math.max(o+i[0].length-1,n[1])})),[].concat(t,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var t=e.from,n=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var t=e.from,n=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,n=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getTopStartCorner(),i=e.getBottomEndCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},l=[],s=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",e,n),Object(Tn["rangeEach"])(0,a.rowspan-1,(function(e){Object(Tn["rangeEach"])(0,a.colspan-1,(function(n){var r=null;l[e]||(l[e]=[]),0===e&&0===n?r=t.hot.getDataAtCell(a.row,a.col):t.hot.setCellMeta(a.row+e,a.col+n,"hidden",!0),l[e][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var u=this.mergedCellsCollection.add(a);return!u||(r?s=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,a,n),s)}},{key:"unmergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),Object(N["arrayEach"])(r,(function(e){t.mergedCellsCollection.remove(e.row,e.col),Object(Tn["rangeEach"])(0,e.rowspan-1,(function(n){Object(Tn["rangeEach"])(0,e.colspan-1,(function(r){t.hot.removeCellMeta(e.row+n,e.col+r,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col),n=t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col;n?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,n,r){var o=this.hot._createCellCoords(e,t),i=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(o,o,i))}},{key:"unmerge",value:function(e,t,n,r){var o=this.hot._createCellCoords(e,t),i=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[$P]),this.hot.render()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),n=t.getContext("grid");n.addShortcut({keys:[["Control","m"]],callback:function(){e.toggleMerge(e.hot.getSelectedRangeLast()),e.hot.render()},runOnlyIf:function(e){return!e.altKey},group:JP})}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(JP)}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<t.length;r+=1)if(n.from.row===t[r].row&&n.from.col===t[r].col&&n.to.row===t[r].row+t[r].rowspan-1&&n.to.col===t[r].col+t[r].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t=QP.get(this),n=this.hot.getSelectedRangeLast(),r={row:e.row,col:e.col},o=null,i=this.hot._createCellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){var l=this.hot._createCellCoords(a.row,a.col),s=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),u=this.hot._createCellRange(l,l,s);u.includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),r.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-i.row:r.row,r.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-i.col:r.col,e.row>0?r.row=a.row+a.rowspan-1-i.row+e.row:e.row<0&&(r.row=i.row-a.row+e.row),e.col>0?r.col=a.col+a.colspan-1-i.col+e.col:e.col<0&&(r.col=i.col-a.col+e.col)}o=this.hot._createCellCoords(n.highlight.row+r.row,n.highlight.col+r.col);var c=this.mergedCellsCollection.get(o.row,o.col);if(c){var f=this.mergedCellsCollection.getFirstRenderableCoords(c.row,c.col);t.lastDesiredCoords=o,r={row:f.row-i.row,col:f.col-i.col}}0!==r.row&&(e.row=r.row),0!==r.col&&(e.col=r.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,n=this.hot.getSelectedRangeLast(),r=Object(b["clone"])(e),o=this.selectionCalculations.getUpdatedSelectionRange(n,e),i=Object(b["clone"])(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=Object(b["clone"])(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),Object(N["arrayEach"])(a,(function(e){t.selectionCalculations.snapDelta(r,n,e)}))}while(r.row!==i.row||r.col!==i.col);e.row=r.row,e.col=r.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var n=this.mergedCellsCollection.get(e,t);if(n){var r=n.row,o=n.col,i=n.colspan,a=n.rowspan;return[r,o,r+a-1,o+i-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){e.items.push({name:"---------"},RP(this))}},{key:"onAfterRenderer",value:function(e,t,n){var r=this.mergedCellsCollection.get(t,n),o=Object(b["isObject"])(r)?Object(b["clone"])(r):void 0;if(Object(b["isObject"])(o)){var i=this.hot,a=i.rowIndexMapper,l=i.columnIndexMapper,s=o.row,u=o.col,c=o.colspan,f=o.rowspan,h=this.translateMergedCellToRenderable(s,f,u,c),d=EP(h,2),p=d[0],y=d[1],v=a.getRenderableFromVisualIndex(t),g=l.getRenderableFromVisualIndex(n),m=p-v+1,w=y-g+1;o.row=a.getNearestNotHiddenIndex(o.row,1),o.col=l.getNearestNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,m),o.colspan=Math.min(o.colspan,w)}$T(e,o,t,n)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),n=[t.row,t.col];e.row=n[0],e.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r],i=o.getRange();t.expandByRange(i)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(e,t,n){var r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(r,o);if(Object(b["isObject"])(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.row,1));if(a<e.startRow)return e.startRow=a,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(r,o);if(Object(b["isObject"])(i)){var a=i.row+i.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow)return e.endRow=l,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,r);if(Object(b["isObject"])(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.col,1));if(a<e.startColumn)return e.startColumn=a,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,r);if(Object(b["isObject"])(i)){var a=i.col+i.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn)return e.endColumn=l,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,n,r){var o,i,a=this.hot,l=a.rowIndexMapper,s=a.columnIndexMapper;o=0===t?l.getNearestNotHiddenIndex(e,1):l.getNearestNotHiddenIndex(e+t-1,-1),i=0===r?s.getNearestNotHiddenIndex(n,1):s.getNearestNotHiddenIndex(n+r-1,-1);var u=e>=0?l.getRenderableFromVisualIndex(o):e,c=n>=0?s.getRenderableFromVisualIndex(i):n;return[u,c]}},{key:"onModifyAutofillRange",value:function(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var n=this.autofillCalculations.getDirection(t,e),r=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,r,n))return r=t,r;var o=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return o?(r=this.autofillCalculations.snapDragArea(t,r,n,o),r):r}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);Object(N["arrayEach"])(r,(function(t){n.getBottomEndCorner().row===t.getLastRow()&&n.getBottomEndCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,n){if(this.enabled){var r=this.mergedCellsCollection.get(e.row,e.col);if(r){var o=t>0,i=t<0,a=n<0,l=n>0,s=r.row+r.rowspan-1===this.hot.countRows()-1,u=0===r.row,c=r.col+r.colspan-1===this.hot.countCols()-1,f=0===r.col;(o&&s||i&&u||l&&c||a&&f)&&(e.row=r.row,e.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return $P}},{key:"PLUGIN_PRIORITY",get:function(){return qP}}]),n}(Hr);function eM(e){return iM(e)||oM(e)||nM(e)||tM()}function tM(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nM(e,t){if(e){if("string"===typeof e)return rM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rM(e,t):void 0}}function rM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oM(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function iM(e){if(Array.isArray(e))return e}function aM(e,t){return function(n,r){var o=eM(n),i=o.slice(1),a=eM(r),l=a.slice(1);return function n(r){var o=e[r],a=t[r],s=i[r],u=l[r],c=a.multiColumnSorting,f=c.compareFunctionFactory?c.compareFunctionFactory:As(a.type),h=f(o,a,c)(s,u);if(h===fs){var d=r+1;if("undefined"!==typeof t[d])return n(d)}return h}(0)}}function lM(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function sM(){Object(Ba["b"])(Object(Cu["a"])(KP||(KP=lM(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var uM="sort";function cM(e,t,n){var r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push("".concat(uM,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),r}function fM(e){var t=e.className.split(" "),n=new RegExp("^".concat(uM,"-[0-9]{1,2}$"));return t.filter((function(e){return n.test(e)}))}function hM(e){return hM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hM(e)}function dM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yM(e,t,n){return t&&pM(e.prototype,t),n&&pM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vM(){return vM="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=gM(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},vM.apply(this,arguments)}function gM(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=RM(e),null===e)break;return e}function bM(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mM(e,t)}function mM(e,t){return mM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mM(e,t)}function wM(e){var t=SM();return function(){var n,r=RM(e);if(t){var o=RM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OM(this,n)}}function OM(e,t){if(t&&("object"===hM(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return CM(e)}function CM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function RM(e){return RM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RM(e)}var kM="multiColumnSorting",EM=170,jM="append",TM="columnSorting";Ps(kM,aM);var PM=function(e){bM(n,e);var t=wM(n);function n(e){var r;return dM(this,n),r=t.call(this,e),r.pluginKey=kM,r}return yM(n,[{key:"isEnabled",value:function(){return vM(RM(n.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[TM]&&sM(),vM(RM(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){vM(RM(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){vM(RM(n.prototype),"sort",this).call(this,e)}},{key:"clearSort",value:function(){vM(RM(n.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return vM(RM(n.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(e){return vM(RM(n.prototype),"getSortConfig",this).call(this,e)}},{key:"setSortConfig",value:function(e){vM(RM(n.prototype),"setSortConfig",this).call(this,e)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(e){for(var t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];(t=vM(RM(n.prototype),"updateHeaderClasses",this)).call.apply(t,[this,e].concat(o)),Object(v["removeClass"])(e,fM(e)),!1!==this.enabled&&Object(v["addClass"])(e,cM.apply(void 0,o))}},{key:"onUpdateSettings",value:function(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[TM]&&sM(),vM(RM(n.prototype),"onUpdateSettings",this).call(this,e)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==Xl(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,jM))):this.sort(this.getColumnNextConfig(t.col)))}}],[{key:"PLUGIN_KEY",get:function(){return kM}},{key:"PLUGIN_PRIORITY",get:function(){return EM}}]),n}(yu);function MM(e){return MM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MM(e)}function AM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _M(e,t,n){return t&&IM(e.prototype,t),n&&IM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function xM(){return xM="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=HM(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xM.apply(this,arguments)}function HM(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=WM(e),null===e)break;return e}function NM(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DM(e,t)}function DM(e,t){return DM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},DM(e,t)}function LM(e){var t=FM();return function(){var n,r=WM(e);if(t){var o=WM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BM(this,n)}}function BM(e,t){if(t&&("object"===MM(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return VM(e)}function VM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function WM(e){return WM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},WM(e)}var UM="multipleSelectionHandles",zM=160,GM=function(e){NM(n,e);var t=LM(n);function n(e){var r;return AM(this,n),r=t.call(this,e),r.dragged=[],r.eventManager=null,r.lastSetCell=null,r}return _M(n,[{key:"isEnabled",value:function(){return Object($f["isMobileBrowser"])()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new we["a"](this)),this.registerListeners(),xM(WM(n.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var e=this,t=this,n=this.hot.rootElement;function r(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(e){var n;return Object(v["hasClass"])(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):Object(v["hasClass"])(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(e){return Object(v["hasClass"])(e.target,"topSelectionHandle-HitArea")?(r.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):Object(v["hasClass"])(e.target,"bottomSelectionHandle-HitArea")?(r.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,i,a,l,s,u=e.hot.rootDocument;if(0!==t.dragged.length){var c=u.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);c&&c!==t.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(r=t.hot.getCoords(c),-1===r.col&&(r.col=0),o=t.hot.getSelectedRangeLast(),i=o.getWidth(),a=o.getHeight(),l=o.getDirection(),1===i&&1===a&&t.hot.selection.setRangeEnd(r),s=t.getCurrentRangeCoords(o,r,t.touchStartRange.direction,l,t.dragged[0]),null!==s.start&&t.hot.selection.setRangeStart(s.start),t.hot.selection.setRangeEnd(s.end),t.lastSetCell=c),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(e,t,n,r,o){var i=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),s=e.getTopEndCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="top"===o?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,i.col)};break;case"SE-NW":"bottom"===o&&(u={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,i.col)});break;default:break}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?u={start:t,end:l}:u.end=t;break;case"NW-SE":"top"===o?u={start:t,end:a}:u.end=t;break;case"SE-NW":"top"===o?u={start:t,end:i}:u.end=t;break;case"SW-NE":"top"===o?u={start:t,end:s}:u.end=t;break;default:break}break;case"SW-NE":switch(r){case"NW-SE":u="bottom"===o?{start:this.hot._createCellCoords(t.row,i.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(i.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":u="top"===o?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:{start:this.hot._createCellCoords(t.row,i.col),end:this.hot._createCellCoords(i.row,t.col)};break;case"SE-NW":"bottom"===o?u={start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(i.row,t.col)}:"top"===o&&(u={start:l,end:t});break;default:break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(u.end=t);break;case"SE-NW":"top"===o?u.end=t:u={start:t,end:i};break;default:break}break;default:break}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return UM}},{key:"PLUGIN_PRIORITY",get:function(){return zM}}]),n}(Hr),YM=n("b0e6");function XM(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.label,n=void 0===t?"":t,r=e.colspan,o=void 0===r?1:r,i=e.origColspan,a=void 0===i?1:i,l=e.collapsible,s=void 0!==l&&l,u=e.crossHiddenColumns,c=void 0===u?[]:u,f=e.isCollapsed,h=void 0!==f&&f,d=e.isHidden,p=void 0!==d&&d,y=e.isRoot,v=void 0!==y&&y,g=e.isPlaceholder,b=void 0!==g&&g;return{label:n,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:v,isPlaceholder:b}}function KM(){return{label:"",isPlaceholder:!0}}function $M(e){return ZM(e)||JM(e)||QM(e)||qM()}function qM(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function QM(e,t){if(e){if("string"===typeof e)return eA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eA(e,t):void 0}}function JM(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ZM(e){if(Array.isArray(e))return eA(e)}function eA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===t)return n;Object(N["arrayEach"])(e,(function(e){var r=[],o=0;n.push(r),Object(N["arrayEach"])(e,(function(e){var n=XM();if(Object(b["isObject"])(e)){var i=e.label,a=e.colspan;n.label=Object(D["stringify"])(i),"number"===typeof a&&a>1&&(n.colspan=a,n.origColspan=a)}else n.label=Object(D["stringify"])(e);o+=n.origColspan;var l=!1;if(o>=t&&(n.colspan=n.origColspan-(o-t),n.origColspan=n.colspan,l=!0),r.push(n),n.colspan>1)for(var s=0;s<n.colspan-1;s++)r.push(KM());return!l}))}));var r=Math.max.apply(Math,$M(Object(N["arrayMap"])(n,(function(e){return e.length}))));return Object(N["arrayEach"])(n,(function(e){if(e.length<r){var t=Object(N["arrayMap"])(new Array(r-e.length),(function(){return XM()}));e.splice.apply(e,[e.length,0].concat($M(t)))}})),n}var nA=["row","col"];function rA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rA(Object(n),!0).forEach((function(t){iA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function iA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aA(e,t){if(null==e)return{};var n,r,o=lA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function lA(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function sA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cA(e,t,n){return t&&uA(e.prototype,t),n&&uA(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function fA(e,t,n){hA(e,t),t.set(e,n)}function hA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dA(e,t){var n=vA(e,t,"get");return pA(e,n)}function pA(e,t){return t.get?t.get.call(e):t.value}function yA(e,t,n){var r=vA(e,t,"set");return gA(e,r,n),n}function vA(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function gA(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var bA=["label","collapsible"],mA=new WeakMap,wA=new WeakMap,OA=new WeakMap,CA=function(){function e(){sA(this,e),fA(this,mA,{writable:!0,value:[]}),fA(this,wA,{writable:!0,value:0}),fA(this,OA,{writable:!0,value:1/0})}return cA(e,[{key:"setColumnsLimit",value:function(e){yA(this,OA,e)}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];yA(this,mA,tA(e,dA(this,OA))),yA(this,wA,dA(this,mA).length)}},{key:"getData",value:function(){return dA(this,mA)}},{key:"mergeWith",value:function(e){var t=this;Object(N["arrayEach"])(e,(function(e){var n=e.row,r=e.col,o=aA(e,nA),i=t.getHeaderSettings(n,r);null!==i&&Object(b["extend"])(i,o,bA)}))}},{key:"map",value:function(e){Object(N["arrayEach"])(dA(this,mA),(function(t){Object(N["arrayEach"])(t,(function(t){var n=e(oA({},t));Object(b["isObject"])(n)&&Object(b["extend"])(t,n,bA)}))}))}},{key:"getHeaderSettings",value:function(e,t){var n;if(e>=dA(this,wA)||e<0)return null;var r=dA(this,mA)[e];return t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(e>=dA(this,wA)||e<0)return r;for(var o=dA(this,mA)[e],i=0,a=t;a<o.length;a++){var l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),i===n)break;if(i>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return dA(this,wA)}},{key:"getColumnsCount",value:function(){return dA(this,wA)>0?dA(this,mA)[0].length:0}},{key:"clear",value:function(){yA(this,mA,[]),yA(this,wA,0)}}]),e}();function SA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function RA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SA(Object(n),!0).forEach((function(t){TA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jA(e,t,n){return t&&EA(e.prototype,t),n&&EA(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function TA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PA(e){return _A(e)||IA(e)||AA(e)||MA()}function MA(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function AA(e,t){if(e){if("string"===typeof e)return xA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xA(e,t):void 0}}function IA(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _A(e){if(Array.isArray(e))return xA(e)}function xA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var HA="DF-pre-order";function NA(e,t){for(var n=e.call(t,this),r=0;r<this.childs.length;r++){if(!1===n)return!1;n=NA.call(this.childs[r],e,t)}return n}var DA="DF-post-order";function LA(e,t){for(var n=0;n<this.childs.length;n++){var r=LA.call(this.childs[n],e,t);if(!1===r)return!1}return e.call(t,this)}var BA="BF";function VA(e,t){var n=[this];function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,PA(o.childs)),!1!==e.call(t,o)&&r()}}r()}var FA=BA,WA=new Map([[HA,NA],[DA,LA],[BA,VA]]),UA=function(){function e(t){kA(this,e),TA(this,"data",{}),TA(this,"parent",null),TA(this,"childs",[]),this.data=t}return jA(e,[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new e(RA({},t.data)),r=0;r<t.childs.length;r++)n.addChild(this.cloneTree(t.childs[r]));return n}},{key:"replaceTreeWith",value:function(e){this.data=RA({},e.data),this.childs=[];for(var t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}},{key:"walkDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FA;if(!WA.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));WA.get(t).call(this,e,this)}},{key:"walkUp",value:function(e){var t=this,n=function n(r){var o=e.call(t,r);!1!==o&&null!==r.parent&&n(r.parent)};n(this)}}]),e}();function zA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zA(Object(n),!0).forEach((function(t){YA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function YA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XA(e,t){return JA(e)||QA(e,t)||$A(e,t)||KA()}function KA(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $A(e,t){if(e){if("string"===typeof e)return qA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qA(e,t):void 0}}function qA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QA(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function JA(e){if(Array.isArray(e))return e}function ZA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tI(e,t,n){return t&&eI(e.prototype,t),n&&eI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nI(e,t,n){rI(e,t),t.set(e,n)}function rI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oI(e,t){var n=lI(e,t,"get");return iI(e,n)}function iI(e,t){return t.get?t.get.call(e):t.value}function aI(e,t,n){var r=lI(e,t,"set");return sI(e,r,n),n}function lI(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function sI(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var uI,cI,fI=new WeakMap,hI=new WeakMap,dI=new WeakMap,pI=function(){function e(t){ZA(this,e),nI(this,fI,{writable:!0,value:new Map}),nI(this,hI,{writable:!0,value:new Map}),nI(this,dI,{writable:!0,value:null}),aI(this,dI,t)}return tI(e,[{key:"getRoots",value:function(){return Array.from(oI(this,fI).values())}},{key:"getRootByColumn",value:function(e){var t;return oI(this,hI).has(e)&&(t=oI(this,fI).get(oI(this,hI).get(e))),t}},{key:"getNode",value:function(e,t){var n=this.getRootByColumn(t);if(n){var r,o=t-oI(this,hI).get(t),i=0;return n.walkDown((function(t){var n=t.data,a=n.origColspan,l=n.headerLevel;if(e===l){if(o>=i&&o<=i+a-1)return r=t,!1;i+=a}})),r}}},{key:"rebuildTreeIndex",value:function(){var e=this,t=0;oI(this,hI).clear(),Object(N["arrayEach"])(oI(this,fI),(function(n){for(var r=XA(n,2),o=r[1].data.colspan,i=t;i<t+o;i++)oI(e,hI).set(i,t);t+=o}))}},{key:"buildTree",value:function(){this.clear();var e=oI(this,dI).getColumnsCount(),t=0;while(t<e){var n=oI(this,dI).getHeaderSettings(0,t),r=new UA;oI(this,fI).set(t,r),this.buildLeaves(r,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=oI(this,dI).getHeadersSettings(n,t,o);n+=1,Object(N["arrayEach"])(i,(function(o){var i,a=GA(GA({},o),{},{headerLevel:n-1,columnIndex:t});1===n?(e.data=a,i=e):(i=new UA(a),e.addChild(i)),n<oI(r,dI).getLayersCount()&&r.buildLeaves(i,t,n,o.origColspan),t+=o.origColspan}))}},{key:"clear",value:function(){oI(this,fI).clear(),oI(this,hI).clear()}}]),e}();function yI(e,t){e.walkDown((function(e){var n=e.data,r=e.childs;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(var o=1;o<n.colspan;o++)t(n.columnIndex+o)}))}function vI(e,t){var n=e.childs;if(0!==n.length)return n[0].data[t]}function gI(e){return vI(e,"origColspan")===e.data.origColspan}function bI(e){var t=e.data,n=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var r=gI(e);if(r)return bI(n[0]);t.isCollapsed=!1;var o=n.slice(1),i=new Set,a=0;if(o.length>0)Object(N["arrayEach"])(o,(function(e){e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;var t=e.data;a+=t.colspan,yI(e,(function(e){i.add(e)}))}));else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var c=1;c<s;c++)i.add(u+c)}return e.walkUp((function(e){var t=e.data;t.colspan+=a,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):gI(e)&&(t.isCollapsed=vI(e,"isCollapsed"))})),{rollbackModification:function(){return mI(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function mI(e){var t,n=e.data,r=e.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=gI(e);if(o)return mI(r[0]);n.isCollapsed=!0;var i=r.slice(1),a=new Set;if(i.length>0)Object(N["arrayEach"])(i,(function(e){yI(e,(function(e){a.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((function(e){var t=e.data;t.isHidden=!0}))}));else for(var l=n.origColspan,s=n.columnIndex,u=1;u<l;u++){var c=s+u;a.add(c)}var f=n.colspan-(null!==(t=vI(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((function(e){var t=e.data;t.colspan-=f,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):gI(e)&&(t.isCollapsed=vI(e,"isCollapsed"))})),{rollbackModification:function(){return bI(e)},affectedColumns:Array.from(a),colspanCompensation:f}}function wI(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function OI(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Object(Cu["a"])(uI||(uI=wI(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));var n=e.data.crossHiddenColumns;if(!n.includes(t)){var r=!1;e.walkUp((function(e){var t=e.data.collapsible;if(t)return r=!0,!1})),r||e.walkUp((function(e){var n=e.data;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}}function CI(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function SI(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Object(Cu["a"])(cI||(cI=CI(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));var n=e.data.crossHiddenColumns;if(n.includes(t)){var r=!1;e.walkUp((function(e){var t=e.data.collapsible;if(t)return r=!0,!1})),r||e.walkUp((function(e){var n=e.data;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}}var RI=new Map([["collapse",mI],["expand",bI],["hide-column",OI],["show-column",SI]]);function kI(e,t,n){if(!RI.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return RI.get(e)(t,n)}var EI=["crossHiddenColumns"];function jI(e,t){if(null==e)return{};var n,r,o=TI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function TI(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function PI(e){var t=[];return Object(N["arrayEach"])(e,(function(e){e.walkDown((function(e){for(var n=e.data,r=n.origColspan,o=n.columnIndex,i=n.headerLevel,a=n.crossHiddenColumns,l=AI(t,i),s=!1,u=o;u<o+r;u++){var c=a.includes(u);if(c||s)l.push(KM(n));else{var f=MI(n);f.isRoot=!0,l.push(f),s=!0}}}))})),t}function MI(e){var t=XM(e),n=(t.crossHiddenColumns,jI(t,EI));return n}function AI(e,t){var n;return Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n),n}var II=["row"];function _I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_I(Object(n),!0).forEach((function(t){HI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NI(e,t){if(null==e)return{};var n,r,o=DI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function DI(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function LI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VI(e,t,n){return t&&BI(e.prototype,t),n&&BI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function FI(e,t,n){WI(e,t),t.set(e,n)}function WI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UI(e,t,n){var r=YI(e,t,"set");return zI(e,r,n),n}function zI(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function GI(e,t){var n=YI(e,t,"get");return XI(e,n)}function YI(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function XI(e,t){return t.get?t.get.call(e):t.value}var KI=new WeakMap,$I=new WeakMap,qI=new WeakMap,QI=function(){function e(){LI(this,e),FI(this,KI,{writable:!0,value:new CA}),FI(this,$I,{writable:!0,value:new pI(GI(this,KI))}),FI(this,qI,{writable:!0,value:[[]]})}return VI(e,[{key:"setState",value:function(e){GI(this,KI).setData(e);var t=!1;try{GI(this,$I).buildTree()}catch(n){GI(this,$I).clear(),GI(this,KI).clear(),t=!0}return UI(this,qI,PI(GI(this,$I).getRoots())),t}},{key:"setColumnsLimit",value:function(e){GI(this,KI).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var t=this,n=Object(N["arrayMap"])(e,(function(e){var n=e.row,r=NI(e,II);return xI({row:n<0?t.rowCoordsToLevel(n):n},r)}));GI(this,KI).mergeWith(n),GI(this,$I).buildTree(),UI(this,qI,PI(GI(this,$I).getRoots()))}},{key:"mapState",value:function(e){GI(this,KI).map(e),GI(this,$I).buildTree(),UI(this,qI,PI(GI(this,$I).getRoots()))}},{key:"mapNodes",value:function(e){return Object(N["arrayReduce"])(GI(this,$I).getRoots(),(function(t,n){return n.walkDown((function(n){var r=e(n.data);void 0!==r&&t.push(r)})),t}),[])}},{key:"triggerNodeModification",value:function(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));var r,o=GI(this,$I).getNode(t,n);return o&&(r=kI(e,o,n),UI(this,qI,PI(GI(this,$I).getRoots()))),r}},{key:"triggerColumnModification",value:function(e,t){return this.triggerNodeModification(e,-1,t)}},{key:"rowCoordsToLevel",value:function(e){var t=Math.max(this.getLayersCount(),1),n=t-1,r=0;return Math.min(Math.max(e+t,r),n)}},{key:"levelToRowCoords",value:function(e){var t=Math.max(this.getLayersCount(),1),n=-1,r=-t;return Math.min(Math.max(e-t,r),n)}},{key:"getHeaderSettings",value:function(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),e>=this.getLayersCount()?null:null!==(n=null===(r=GI(this,qI)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(e,t){e<0&&(e=this.rowCoordsToLevel(e));var n=GI(this,$I).getNode(e,t);return n?xI({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(e,t){var n,r=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0},o=r.isRoot;if(o)return t;var i=t-1;while(i>=0){var a,l=null!==(a=this.getHeaderSettings(e,i))&&void 0!==a?a:{isRoot:!0},s=l.isRoot;if(s)break;i-=1}return i}},{key:"getLayersCount",value:function(){return GI(this,KI).getLayersCount()}},{key:"getColumnsCount",value:function(){return GI(this,KI).getColumnsCount()}},{key:"clear",value:function(){UI(this,qI,[]),GI(this,KI).clear(),GI(this,$I).clear()}}]),e}();function JI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e_(e,t,n){return t&&ZI(e.prototype,t),n&&ZI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function t_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var n_,r_,o_=function(){function e(t,n){JI(this,e),t_(this,"hot",void 0),t_(this,"nestedHeaderSettingsGetter",void 0),t_(this,"layersCount",0),t_(this,"container",void 0),t_(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return e_(e,[{key:"setLayersCount",value:function(e){return this.layersCount=e,this}},{key:"getWidth",value:function(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(var n=0;n<t;n++){var r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(e){for(var t=this.hot,n=t.rootDocument,r=t.columnIndexMapper,o=n.createDocumentFragment(),i=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=r.getRenderableIndexesLength(),s=0;s<this.layersCount;s++){for(var u=n.createElement("tr"),c=0;c<l;c++){var f=r.getVisualFromRenderableIndex(c);null===f&&(f=c);var h=n.createElement("th"),d=this.nestedHeaderSettingsGetter(s,f);if(d&&(!d.isPlaceholder||d.isHidden)){var p=d.label;a&&(p+='<button class="changeType"></button>'),Object(v["fastInnerHTML"])(h,p),h.colSpan=d.colspan,u.appendChild(h)}}i.appendChild(u)}o.appendChild(i),e.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}(),i_=o_;function a_(e){return a_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a_(e)}function l_(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function s_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c_(e,t,n){return t&&u_(e.prototype,t),n&&u_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f_(){return f_="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=h_(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},f_.apply(this,arguments)}function h_(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=m_(e),null===e)break;return e}function d_(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p_(e,t)}function y_(e){var t=b_();return function(){var n,r=m_(e);if(t){var o=m_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v_(this,n)}}function v_(e,t){if(t&&("object"===a_(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g_(e)}function g_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b_(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function m_(e){return m_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m_(e)}function w_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O_(e,t,n){C_(e,t),t.set(e,n)}function C_(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S_(e,t,n){var r=E_(e,t,"set");return R_(e,r,n),n}function R_(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function k_(e,t){var n=E_(e,t,"get");return j_(e,n)}function E_(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function j_(e,t){return t.get?t.get.call(e):t.value}var T_="nestedHeaders",P_=280,M_=new WeakMap,A_=new WeakMap,I_=function(e){d_(n,e);var t=y_(n);function n(){var e;s_(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O_(g_(e),M_,{writable:!0,value:new QI}),O_(g_(e),A_,{writable:!0,value:null}),w_(g_(e),"ghostTable",new i_(e.hot,(function(t,n){return e.getHeaderSettings(t,n)}))),w_(g_(e),"detectedOverlappedHeaders",!1),e}return c_(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[T_]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings(),r=t.nestedHeaders;Array.isArray(r)&&Array.isArray(r[0])||Object(Ba["b"])(Object(Cu["a"])(n_||(n_=l_(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return e.onAfterOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(t){return e.onAfterGetColumnHeaderRenderers(t)})),this.addHook("modifyColWidth",(function(){return e.onModifyColWidth.apply(e,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return e.onBeforeHighlightingColumnHeader.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),f_(m_(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var e=this;if(this.hot.view){var t=this.hot.getSettings(),r=t.nestedHeaders;k_(this,M_).setColumnsLimit(this.hot.countCols()),Array.isArray(r)&&(this.detectedOverlappedHeaders=k_(this,M_).setState(r)),this.detectedOverlappedHeaders&&Object(Ba["b"])(Object(Cu["a"])(r_||(r_=l_(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(t,n){var r=!0===t?"hide-column":"show-column";k_(e,M_).triggerColumnModification(r,n)})),!k_(this,A_)&&this.enabled&&S_(this,A_,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(t){t.forEach((function(t){var n=t.op,r=t.index,o=t.newValue;if("replace"===n){var i=!0===o?"hide-column":"show-column";k_(e,M_).triggerColumnModification(i,r)}})),e.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),f_(m_(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),k_(this,M_).clear(),k_(this,A_).unsubscribe(),S_(this,A_,null),this.ghostTable.clear(),f_(m_(n.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return k_(this,M_)}},{key:"getLayersCount",value:function(){return k_(this,M_).getLayersCount()}},{key:"getHeaderSettings",value:function(e,t){return k_(this,M_).getHeaderSettings(e,t)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view._wt,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var a=n.childNodes[i];if(!a)break;for(var l=r.childNodes[i],s=o?o.childNodes[i]:null,u=0,c=a.childNodes.length;u<c;u++)a.childNodes[u].removeAttribute("colspan"),Object(v["removeClass"])(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),Object(v["removeClass"])(l.childNodes[u],"hiddenHeader")),o&&s&&s.childNodes[u]&&(s.childNodes[u].removeAttribute("colspan"),Object(v["removeClass"])(s.childNodes[u],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(e){var t=this,n=this.hot.view._wt.getSetting("fixedColumnsStart");return function(r,o){var i,a=t.hot,l=a.rootDocument,s=a.columnIndexMapper,u=a.view,c=s.getVisualFromRenderableIndex(r);null===c&&(c=r),o.removeAttribute("colspan"),Object(v["removeClass"])(o,"hiddenHeader");var f=null!==(i=k_(t,M_).getHeaderSettings(e,c))&&void 0!==i?i:{label:""},h=f.colspan,d=f.label,p=f.isHidden,y=f.isPlaceholder;if(y||p)Object(v["addClass"])(o,"hiddenHeader");else if(h>1){var g,b,m=u._wt.wtOverlays,w=null===(g=m.topInlineStartCornerOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(o),O=null===(b=m.inlineStartOverlay)||void 0===b?void 0:b.clone.wtTable.THEAD.contains(o),C=w||O?Math.min(h,n-r):h;C>1&&o.setAttribute("colspan",C)}var S=l.createElement("div"),R=l.createElement("span");Object(v["addClass"])(S,"relative"),Object(v["addClass"])(R,"colHeader"),Object(v["fastInnerHTML"])(R,d),S.appendChild(R),Object(v["empty"])(o),o.appendChild(S),t.hot.runHooks("afterGetColHeader",c,o)}}},{key:"onBeforeHighlightingColumnHeader",value:function(e,t,n){var r=k_(this,M_).getHeaderTreeNodeData(t,e);if(!r)return e;var o=n.classNames,i=n.columnCursor,a=n.selectionType,l=n.selectionWidth,s=k_(this,M_).getHeaderSettings(t,e),u=s.isRoot,c=s.colspan;if(a===YM["f"]){if(!u)return r.columnIndex}else a===YM["a"]&&(c>l-i||!u)&&(o.length=0);return e}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this._getHeaderTreeNodeDataByCoords(t);o&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){var n=this._getHeaderTreeNodeDataByCoords(t);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,i=[],a=n.columnIndex,l=n.origColspan,s=!r.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?i.push(o.getTopEndCorner().col,a,t.row):t.col>o.from.col?i.push(o.getTopStartCorner().col,a+l-1,t.row):i.push(a,a+l-1,t.row):(Object(g["isLeftClick"])(e)||Object(g["isRightClick"])(e)&&s)&&i.push(a,a+l-1,t.row),r.selectColumns.apply(r,i)}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o;if(this.hot.view.isMouseDown()){var i=this._getHeaderTreeNodeDataByCoords(t);if(i){var a=i.columnIndex,l=i.origColspan,s=this.hot.getSelectedRangeLast(),u=s.getTopStartCorner(),c=s.getBottomEndCorner(),f=s.from;r.column=!0,r.cell=!0;var h=[];t.col<f.col?h.push(c.col,a):t.col>f.col?h.push(u.col,a+l-1):h.push(a,a+l-1),(o=this.hot).selectColumns.apply(o,h)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){if(e){e.length=0;for(var t=0;t<k_(this,M_).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){for(var t=k_(this,M_).getLayersCount(),n=e.startColumn,r=!!t,o=0;o<t;o++){var i=k_(this,M_).findLeftMostColumnIndex(o,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(i);if(i>=0&&(r=!1),Object(Tn["isNumeric"])(a)&&a<e.startColumn){n=a;break}}e.startColumn=r?k_(this,M_).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(e,t){var n=this.ghostTable.getWidth(t);return e>n?e:n}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){S_(this,M_,null),null!==k_(this,A_)&&(k_(this,A_).unsubscribe(),S_(this,A_,null)),f_(m_(n.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(e){if(!(e.row>=0||e.col<0))return k_(this,M_).getHeaderTreeNodeData(e.row,e.col)}}],[{key:"PLUGIN_KEY",get:function(){return T_}},{key:"PLUGIN_PRIORITY",get:function(){return P_}}]),n}(Hr);function __(e){return D_(e)||N_(e)||H_(e)||x_()}function x_(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function H_(e,t){if(e){if("string"===typeof e)return L_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L_(e,t):void 0}}function N_(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function D_(e){if(Array.isArray(e))return L_(e)}function L_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B_(e){return B_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B_(e)}function V_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W_(e,t,n){return t&&F_(e.prototype,t),n&&F_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var U_=function(){function e(t,n){V_(this,e),this.hot=n,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return W_(e,[{key:"setData",value:function(e){this.data=e}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(e){this.setData(e),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Object(Tn["rangeEach"])(0,this.data.length-1,(function(t){e.cacheNode(e.data[t],0,null)}))}},{key:"cacheNode",value:function(e,t,n){var r=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&Object(N["arrayEach"])(e.__children,(function(n){r.cacheNode(n,t+1,e)}))}},{key:"getDataObject",value:function(e){return null===e||void 0===e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,n,r){var o=this,i=!1,a=t;if(isNaN(a)&&a.end)return a;var l=e;return l||(l={__children:this.data},i=!0,a-=1),null!==n&&void 0!==n&&a===n?{result:l,end:!0}:null!==r&&void 0!==r&&l===r?{result:a,end:!0}:(a+=1,l.__children&&Object(N["arrayEach"])(l.__children,(function(e){if(o.parentReference.set(e,i?null:l),a=o.readTreeNodes(e,a,n,r),isNaN(a)&&a.end)return!1})),a)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return Object(b["objectEach"])(this.data[0],(function(t,n){e[n]=null})),e}},{key:"getRowIndex",value:function(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null===n||void 0===n?this.data.indexOf(t):n.__children.indexOf(t)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var t=this,n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(Object(N["arrayEach"])(r.__children,(function(e){n+=1,e.__children&&(n+=t.countChildren(e))})),n):0}},{key:"getRowParent",value:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return e&&"object"===B_(e)?this.cache.nodeInfo.get(e).parent:null}},{key:"getRowLevel",value:function(e){var t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isChild",value:function(e){return null!==this.getRowParent(e)}},{key:"getChild",value:function(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var t,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}},{key:"addChild",value:function(e,t){var n=t;this.hot.runHooks("beforeAddChild",e,n);var r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",e,n)}},{key:"addChildAtIndex",value:function(e,t,n){var r,o=n;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){var i=this.getRowIndex(e),a=i+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,o,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break;default:break}}},{key:"detachFromParent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(e)?(Object(Tn["rangeEach"])(e[0],e[2],(function(e){var n=t.translateTrimmedRow(e);o.push(t.getDataObject(n))})),Object(Tn["rangeEach"])(0,o.length-2,(function(e){t.detachFromParent(o[e],!1)})),r=o[o.length-1]):r=e;var i=this.getRowIndex(r),a=this.countChildren(r),l=this.getRowIndexWithinParent(r),s=this.getRowParent(r),u=this.getRowParent(s),c=this.getRowIndex(u),f=null;if(this.hot.runHooks("beforeDetachChild",s,r),null!==l&&void 0!==l){var h=Array.from(new Array(i+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",i,a+1,h,this.plugin.pluginName),s.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,a+1,h,this.plugin.pluginName),u){f=c+this.countChildren(u);var d=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",p+1,a+1,this.plugin.pluginName),u.__children.push(r)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,r,this.getRowIndex(r)),n&&this.hot.render()}},{key:"filterData",value:function(e,t,n){var r=this,o=[];Object(N["arrayEach"])(n,(function(e){o.push(r.getDataObject(e))})),Object(N["arrayEach"])(o,(function(e){var t=r.getRowIndexWithinParent(e),n=r.getRowParent(e);null===n?r.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}},{key:"spliceData",value:function(e,t,n){var r,o=this.getDataObject(e-1),i=null,a=e;if(o&&o.__children&&0===o.__children.length?(i=o,a=0):e<this.countAllRows()&&(i=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),i)n?(r=i.__children).splice.apply(r,[a,t].concat(__(n))):i.__children.splice(a,t);else if(n){var l;(l=this.data).splice.apply(l,[a,t].concat(__(n)))}else this.data.splice(a,t);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var t=e,n=null;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,t,n,r){var o=t===this.hot.countRows(),i=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=i.__children.slice(a,a+1),s=e>t,u=o?this.getRowParent(t-1):this.getRowParent(t);null!==u&&void 0!==u||(u=this.getRowParent(t-1)),null!==u&&void 0!==u||(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);var c=o||n||r?u.__children.length:this.getRowIndexWithinParent(t),f=i===u;u.__children.splice(c,0,l[0]),i.__children.splice(a+(s&&f?1:0),1),this.syncRowWithRawSource(i),f||this.syncRowWithRawSource(u)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}]),e}(),z_=U_;function G_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y_(e,t,n){return t&&G_(e.prototype,t),n&&G_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function X_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var K_=Y_((function e(t,n){X_(this,e),this.hot=n,this.plugin=t})),$_=K_;function q_(e){return q_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q_(e)}function Q_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z_(e,t,n){return t&&J_(e.prototype,t),n&&J_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ex(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tx(e,t)}function tx(e,t){return tx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tx(e,t)}function nx(e){var t=ix();return function(){var n,r=ax(e);if(t){var o=ax(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rx(this,n)}}function rx(e,t){if(t&&("object"===q_(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ox(e)}function ox(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ix(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ax(e){return ax=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ax(e)}var lx=function(e){ex(n,e);var t=nx(n);function n(e,r){var o;return Q_(this,n),o=t.call(this,e,r),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return Z_(n,[{key:"appendLevelIndicators",value:function(e,t){var r=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),a=t.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),s=a.querySelectorAll('[class^="ht_nesting"]');if(Object(N["arrayEach"])(s,(function(e){e&&a.removeChild(e)})),Object(v["addClass"])(t,n.CSS_CLASSES.indicatorContainer),o){var u=this.hot.rootDocument,c=l.cloneNode(!0);a.innerHTML="",Object(Tn["rangeEach"])(0,o-1,(function(){var e=u.createElement("SPAN");Object(v["addClass"])(e,n.CSS_CLASSES.emptyIndicator),a.appendChild(e)})),a.appendChild(c)}if(this.dataManager.hasChildren(i)){var f=this.hot.rootDocument.createElement("DIV");Object(v["addClass"])(t,n.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Object(v["addClass"])(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.expandButton)):Object(v["addClass"])(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.collapseButton)),a.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(e){var t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),n}($_),sx=lx;function ux(e){return ux="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ux(e)}function cx(e){return px(e)||dx(e)||hx(e)||fx()}function fx(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hx(e,t){if(e){if("string"===typeof e)return yx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yx(e,t):void 0}}function dx(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function px(e){if(Array.isArray(e))return yx(e)}function yx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bx(e,t,n){return t&&gx(e.prototype,t),n&&gx(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function mx(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wx(e,t)}function wx(e,t){return wx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wx(e,t)}function Ox(e){var t=Rx();return function(){var n,r=kx(e);if(t){var o=kx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cx(this,n)}}function Cx(e,t){if(t&&("object"===ux(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Sx(e)}function Sx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function kx(e){return kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kx(e)}var Ex=function(e){mx(n,e);var t=Ox(n);function n(e,r){var o;return vx(this,n),o=t.call(this,e,r),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,e)},shiftStash:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t&&void 0!==t||(t=1/0),Object(N["arrayEach"])(o.lastCollapsedRows,(function(r,i){r>=e&&r<t&&(o.lastCollapsedRows[i]=r+n)}))},applyStash:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,e),o.lastCollapsedRows=void 0},trimStash:function(e,t){Object(Tn["rangeEach"])(e,e+t-1,(function(e){var t=o.lastCollapsedRows.indexOf(e);t>-1&&o.lastCollapsedRows.splice(t,1)}))}},o}return bx(n,[{key:"collapseChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(i)&&Object(N["arrayEach"])(i.__children,(function(e){o.push(t.dataManager.getRowIndex(e))})),l=this.collapseRows(o,!0,!1),r&&this.trimRows(l),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),l}},{key:"collapseMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(N["arrayEach"])(e,(function(e){o.push.apply(o,cx(t.collapseChildren(e,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}},{key:"collapseRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(N["arrayEach"])(e,(function(e){o.push(e),n&&t.collapseChildRows(e,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);Object(N["arrayEach"])(o.__children,(function(e){var r=t.dataManager.getRowIndex(e);n.push(r),t.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}},{key:"expandRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(N["arrayEach"])(e,(function(e){o.push(e),n&&t.expandChildRows(e,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);Object(N["arrayEach"])(o.__children,(function(e){if(!t.isAnyParentCollapsed(e)){var r=t.dataManager.getRowIndex(e);n.push(r),t.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&Object(N["arrayEach"])(i.__children,(function(e){var n=t.dataManager.getRowIndex(e);o.push(n)})),l=this.expandRows(o,!0,!1),r&&this.untrimRows(l),n&&this.renderAndAdjust(),l}},{key:"expandMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(N["arrayEach"])(e,(function(e){o.push.apply(o,cx(t.expandChildren(e,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,t=this.dataManager.getData(),n=[];Object(N["arrayEach"])(t,(function(t){e.dataManager.hasChildren(t)&&n.push(t)})),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,t=this.dataManager.getData(),n=[];Object(N["arrayEach"])(t,(function(t){e.dataManager.hasChildren(t)&&n.push(t)})),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"trimRows",value:function(e){var t=this;this.hot.batchExecution((function(){Object(N["arrayEach"])(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"untrimRows",value:function(e){var t=this;this.hot.batchExecution((function(){Object(N["arrayEach"])(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(e){var t=this,n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&Object(N["arrayEach"])(n.__children,(function(e){var n=t.dataManager.getRowIndex(e);if(!t.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(e){var t=e;while(null!==t){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(e,t){if(!(t.col>=0)){var n=this.translateTrimmedRow(t.row);Object(v["hasClass"])(e.target,sx.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Object(g["stopImmediatePropagation"])(e))}}},{key:"translateTrimmedRow",value:function(e){return this.hot.toPhysicalRow(e)}},{key:"untranslateTrimmedRow",value:function(e){return this.hot.toVisualRow(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),n}($_),jx=Ex;function Tx(e){return Tx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tx(e)}function Px(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ax(e,t,n){return t&&Mx(e.prototype,t),n&&Mx(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ix(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_x(e,t)}function _x(e,t){return _x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_x(e,t)}function xx(e){var t=Dx();return function(){var n,r=Lx(e);if(t){var o=Lx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hx(this,n)}}function Hx(e,t){if(t&&("object"===Tx(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Nx(e)}function Nx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Lx(e){return Lx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lx(e)}var Bx,Vx=new WeakMap,Fx=function(e){Ix(n,e);var t=xx(n);function n(e,r){var o;return Px(this,n),o=t.call(this,e,r),Vx.set(Nx(o),{row_above:function(e,t){var n=t[t.length-1];o.dataManager.addSibling(n.start.row,"above")},row_below:function(e,t){var n=t[t.length-1];o.dataManager.addSibling(n.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return Ax(n,[{key:"appendOptions",value:function(e){var t=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD"])},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelectedLast();return!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(mc["CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD"])},callback:function(){t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var e=t.hot.getSelectedLast(),n=t.dataManager.translateTrimmedRow(e[0]),r=t.dataManager.getRowParent(n);return!r||!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return Object(Tn["rangeEach"])(0,e.items.length-1,(function(t){if(0===t)return Object(N["arrayEach"])(n,(function(n,r){e.items.splice(t+r,0,n)})),!1})),this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=Vx.get(this);return Object(Tn["rangeEach"])(0,e.items.length-1,(function(n){var r=t[e.items[n].key];null!==r&&void 0!==r&&(e.items[n].callback=r)})),e}}]),n}($_),Wx=Fx;function Ux(e){return Xx(e)||Yx(e)||Gx(e)||zx()}function zx(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gx(e,t){if(e){if("string"===typeof e)return Kx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kx(e,t):void 0}}function Yx(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Xx(e){if(Array.isArray(e))return Kx(e)}function Kx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $x(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jx(e,t,n){return t&&Qx(e.prototype,t),n&&Qx(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Zx=function(){function e(t){qx(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return Jx(e,[{key:"onBeforeRowMove",value:function(e,t,n,r){var o=this,i=this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r});if(i)return!1;this.movedToCollapsed=!1;var a=n===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),s=!0,u=e.map((function(e){if(!s)return!1;var t=o.dataManager.translateTrimmedRow(e);return s=o.shouldAllowMoving(t,l),t})),c=-1===u.indexOf(l);if(!s||!c)return!1;var f=this.getBaseParent(u),h=this.getTargetParent(a,l),d=f===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,l,d),this.moveRows(u,l,h),this.dataManager.rewriteCache(),this.moveCellsMeta(u,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var t=e.rows,n=e.finalIndex,r=e.dropIndex,o=e.movePossible,i=!1;return Object(D["isUndefined"])(r)&&(Object(Ba["b"])(Object(Cu["a"])(Bx||(Bx=$x(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",t,n,r,o,!1),i=!0),i}},{key:"shouldAllowMoving",value:function(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,t){var n=this.dataManager.getRowParent(e?t-1:t);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(t-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(e,t,n){n||(Math.max.apply(Math,Ux(e))<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}},{key:"moveRows",value:function(e,t,n){var r=this,o=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){e.forEach((function(e){r.dataManager.moveRow(e,t,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(e,t){var n,r=this,o=[],i=Math.max.apply(Math,Ux(e))<t;e.forEach((function(e){o.push(r.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),(n=this.hot).spliceCellsMeta.apply(n,[t-(i?o.length:0),0].concat(o))}},{key:"selectCells",value:function(e,t){var n=e.length,r=0,o=0,i=null,a=null;if(this.movedToCollapsed){var l=null;l=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);var s=this.dataManager.getRowParent(null===l?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(u),o=r}else e[n-1]<t?(o=t-1,r=o-n+1):(r=t,o=r+n-1);i=this.hot.selection,a=this.hot.countCols()-1,i.setRangeStart(this.hot._createCellCoords(r,0)),i.setRangeEnd(this.hot._createCellCoords(o,a),!0)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}}]),e}();function eH(e){return eH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eH(e)}function tH(e){return iH(e)||oH(e)||rH(e)||nH()}function nH(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rH(e,t){if(e){if("string"===typeof e)return aH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aH(e,t):void 0}}function oH(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function iH(e){if(Array.isArray(e))return aH(e)}function aH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uH(e,t,n){return t&&sH(e.prototype,t),n&&sH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function cH(){return cH="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=fH(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},cH.apply(this,arguments)}function fH(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=bH(e),null===e)break;return e}function hH(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dH(e,t)}function dH(e,t){return dH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dH(e,t)}function pH(e){var t=gH();return function(){var n,r=bH(e);if(t){var o=bH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yH(this,n)}}function yH(e,t){if(t&&("object"===eH(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vH(e)}function vH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gH(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function bH(e){return bH=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bH(e)}var mH="nestedRows",wH=300,OH=new WeakMap,CH="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",SH=function(e){hH(n,e);var t=pH(n);function n(e){var r;return lH(this,n),r=t.call(this,e),r.dataManager=null,r.headersUI=null,r.collapsedRowsMap=null,OH.set(vH(r),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),r}return uH(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[mH]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new oC["a"]),this.dataManager=new z_(this,this.hot),this.collapsingUI=new jx(this,this.hot),this.headersUI=new sx(this,this.hot),this.contextMenuUI=new Wx(this,this.hot),this.rowMoveController=new Zx(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeViewRender",(function(){return e.onBeforeViewRender.apply(e,arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData.apply(e,arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength.apply(e,arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice.apply(e,arguments)})),this.addHook("filterData",(function(){return e.onFilterData.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild.apply(e,arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild.apply(e,arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild.apply(e,arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove.apply(e,arguments)})),this.addHook("beforeLoadData",(function(t){return e.onBeforeLoadData(t)})),cH(bH(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),cH(bH(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),cH(bH(n.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}},{key:"disableCoreAPIModifiers",value:function(){var e=OH.get(this);e.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var e=OH.get(this);e.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n){this.collapsingUI.toggleState(e,t,n)}},{key:"onModifyRowData",value:function(e){var t=OH.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){var e=OH.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,n){var r=OH.get(this);return!(!r.skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}},{key:"onFilterData",value:function(e,t,n){var r=OH.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(r!==this.pluginName){var i=OH.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this,o=Array.from(n.reduce((function(e,t){if(r.dataManager.isParent(t)){var n=r.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((function(t){return e.add(r.dataManager.getRowIndex(t))})),e}return e.add(t)}),new Set));n.length=0,n.push.apply(n,tH(o))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var e=Math.max.apply(Math,tH(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeViewRender",value:function(e,t){var n=OH.get(this);n.skipRender&&(t.skipRender=!0)}},{key:"destroy",value:function(){cH(bH(n.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(e){if(!Object(nw["isArrayOfObjects"])(e))return Object(Ba["a"])(CH),this.hot.getSettings()[mH]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return mH}},{key:"PLUGIN_PRIORITY",get:function(){return wH}}]),n}(Hr);function RH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EH(e,t,n){return t&&kH(e.prototype,t),n&&kH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var jH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;RH(this,e),this.rootWindow=n,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return EH(e,[{key:"saveValue",value:function(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,t){var n="undefined"===typeof e?t:e,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;Object(N["arrayEach"])(this.savedKeys,(function(t,n){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"===typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}(),TH=jH;function PH(e){return PH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PH(e)}function MH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IH(e,t,n){return t&&AH(e.prototype,t),n&&AH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _H(){return _H="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=xH(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_H.apply(this,arguments)}function xH(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=FH(e),null===e)break;return e}function HH(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NH(e,t)}function NH(e,t){return NH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},NH(e,t)}function DH(e){var t=VH();return function(){var n,r=FH(e);if(t){var o=FH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LH(this,n)}}function LH(e,t){if(t&&("object"===PH(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return BH(e)}function BH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VH(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function FH(e){return FH=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},FH(e)}Ne["a"].getSingleton().register("persistentStateSave"),Ne["a"].getSingleton().register("persistentStateLoad"),Ne["a"].getSingleton().register("persistentStateReset");var WH="persistentState",UH=0,zH=function(e){HH(n,e);var t=DH(n);function n(e){var r;return MH(this,n),r=t.call(this,e),r.storage=void 0,r}return IH(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[WH]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.storage||(this.storage=new TH(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(t,n){return e.saveValue(t,n)})),this.addHook("persistentStateLoad",(function(t,n){return e.loadValue(t,n)})),this.addHook("persistentStateReset",(function(){return e.resetValue()})),_H(FH(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,_H(FH(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_H(FH(n.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(e,t){t.value=this.storage.loadValue(e)}},{key:"saveValue",value:function(e,t){this.storage.saveValue(e,t)}},{key:"resetValue",value:function(e){"undefined"===typeof e?this.storage.resetAll():this.storage.reset(e)}},{key:"destroy",value:function(){_H(FH(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return WH}},{key:"PLUGIN_PRIORITY",get:function(){return UH}}]),n}(Hr);function GH(e){return GH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GH(e)}function YH(e){return qH(e)||$H(e)||KH(e)||XH()}function XH(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function KH(e,t){if(e){if("string"===typeof e)return QH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QH(e,t):void 0}}function $H(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function qH(e){if(Array.isArray(e))return QH(e)}function QH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eN(e,t,n){return t&&ZH(e.prototype,t),n&&ZH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function tN(){return tN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=nN(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tN.apply(this,arguments)}function nN(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=uN(e),null===e)break;return e}function rN(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oN(e,t)}function oN(e,t){return oN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oN(e,t)}function iN(e){var t=sN();return function(){var n,r=uN(e);if(t){var o=uN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aN(this,n)}}function aN(e,t){if(t&&("object"===GH(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lN(e)}function lN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function uN(e){return uN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uN(e)}var cN="search",fN=190,hN="htSearchResult",dN=function(e,t,n,r,o){e.getCellMeta(t,n).isSearchResult=o},pN=function(e,t,n){return!(Object(D["isUndefined"])(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!Object(D["isUndefined"])(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))},yN=function(e){rN(n,e);var t=iN(n);function n(e){var r;return JH(this,n),r=t.call(this,e),r.callback=dN,r.queryMethod=pN,r.searchResultClass=hN,r}return eN(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[cN]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[cN];this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer.apply(e,arguments)})),tN(uN(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e=this,t=function(){return e.onBeforeRenderer.apply(e,arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("beforeRenderer",t)})),tN(uN(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),tN(uN(n.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],l=this.hot;return Object(Tn["rangeEach"])(0,o-1,(function(o){Object(Tn["rangeEach"])(0,i-1,(function(i){var s=t.hot.getDataAtCell(o,i),u=t.hot.getCellMeta(o,i),c=u.search.callback||n,f=u.search.queryMethod||r,h=f(e,s,u);if(h){var d={row:o,col:i,data:s};a.push(d)}c&&c(l,o,i,s,h)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(e){this.queryMethod=e}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(e){this.searchResultClass=e}},{key:"updatePluginSettings",value:function(e){Object(b["isObject"])(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}},{key:"onBeforeRenderer",value:function(e,t,n,r,o,i){var a,l=i.className||[],s=[];"string"===typeof l?s=l.split(" "):(a=s).push.apply(a,YH(l));this.isEnabled()&&i.isSearchResult?s.includes(this.searchResultClass)||s.push("".concat(this.searchResultClass)):s.includes(this.searchResultClass)&&s.splice(s.indexOf(this.searchResultClass),1),i.className=s.join(" ")}},{key:"destroy",value:function(){tN(uN(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cN}},{key:"PLUGIN_PRIORITY",get:function(){return fN}}]),n}(Hr);function vN(e){return vN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vN(e)}function gN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mN(e,t,n){return t&&bN(e.prototype,t),n&&bN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function wN(){return wN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ON(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},wN.apply(this,arguments)}function ON(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=TN(e),null===e)break;return e}function CN(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SN(e,t)}function SN(e,t){return SN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},SN(e,t)}function RN(e){var t=jN();return function(){var n,r=TN(e);if(t){var o=TN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kN(this,n)}}function kN(e,t){if(t&&("object"===vN(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return EN(e)}function EN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function TN(e){return TN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},TN(e)}var PN="touchScroll",MN=200,AN=function(e){CN(n,e);var t=RN(n);function n(e){var r;return gN(this,n),r=t.call(this,e),r.scrollbars=[],r.clones=[],r.lockedCollection=!1,r.freezeOverlays=!1,r}return mN(n,[{key:"isEnabled",value:function(){return Object(Dr["isTouchSupported"])()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterViewRender",(function(){return e.onAfterViewRender()})),this.registerEvents(),wN(TN(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,wN(TN(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){wN(TN(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var e=this.hot.view._wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,r=e.inlineStartOverlay,o=e.topInlineStartCornerOverlay,i=e.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(N["arrayEach"])(this.clones,(function(e){Object(v["addClass"])(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,Object(N["arrayEach"])(this.clones,(function(e){Object(v["removeClass"])(e,"hide-tween"),Object(v["addClass"])(e,"show-tween")})),this.hot._registerTimeout((function(){Object(N["arrayEach"])(e.clones,(function(e){Object(v["removeClass"])(e,"show-tween")}))}),400),Object(N["arrayEach"])(this.scrollbars,(function(e){e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return PN}},{key:"PLUGIN_PRIORITY",get:function(){return MN}},{key:"SETTING_KEYS",get:function(){return!0}}]),n}(Hr);function IN(e){return IN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},IN(e)}function _N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HN(e,t,n){return t&&xN(e.prototype,t),n&&xN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function NN(){return NN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=DN(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},NN.apply(this,arguments)}function DN(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=zN(e),null===e)break;return e}function LN(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BN(e,t)}function BN(e,t){return BN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BN(e,t)}function VN(e){var t=UN();return function(){var n,r=zN(e);if(t){var o=zN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FN(this,n)}}function FN(e,t){if(t&&("object"===IN(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return WN(e)}function WN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function zN(e){return zN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zN(e)}var GN="trimRows",YN=330,XN=function(e){LN(n,e);var t=VN(n);function n(e){var r;return _N(this,n),r=t.call(this,e),r.trimmedRowsMap=null,r}return HN(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[GN]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new oC["a"]),this.trimmedRowsMap.addLocalHook("init",(function(){return e.onMapInit()})),NN(zN(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var e=this,t=this.hot.getSettings()[GN];Array.isArray(t)&&this.hot.batchExecution((function(){e.trimmedRowsMap.clear(),Object(N["arrayEach"])(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),NN(zN(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),NN(zN(n.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(e){var t=this,n=this.getTrimmedRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e))));var i=this.hot.runHooks("beforeTrimRow",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){Object(N["arrayEach"])(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e),r=t,o=this.trimmedRowsMap.getValues().slice(),i=e.length>0;n&&i&&(Object(N["arrayEach"])(e,(function(e){o[e]=!1})),r=Object(N["arrayReduce"])(o,(function(e,t,n){return t&&e.push(n),e}),[]));var a=this.hot.runHooks("beforeUntrimRow",t,r,n&&i);!1!==a&&(n&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,r,n&&i,n&&r.length<t.length))}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(e){var t=this.hot.countSourceRows();return e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"onMapInit",value:function(){var e=this,t=this.hot.getSettings()[GN];Array.isArray(t)&&this.hot.batchExecution((function(){Object(N["arrayEach"])(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"destroy",value:function(){NN(zN(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return GN}},{key:"PLUGIN_PRIORITY",get:function(){return YN}}]),n}(Hr);function KN(e){return KN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KN(e)}function $N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QN(e,t,n){return t&&qN(e.prototype,t),n&&qN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JN(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZN(e,t)}function ZN(e,t){return ZN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ZN(e,t)}function eD(e){var t=rD();return function(){var n,r=oD(e);if(t){var o=oD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tD(this,n)}}function tD(e,t){if(t&&("object"===KN(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nD(e)}function nD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rD(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function oD(e){return oD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oD(e)}function iD(e){return sD(e)||lD(e)||fD(e)||aD()}function aD(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lD(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function sD(e){if(Array.isArray(e))return hD(e)}function uD(e,t){return pD(e)||dD(e,t)||fD(e,t)||cD()}function cD(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fD(e,t){if(e){if("string"===typeof e)return hD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hD(e,t):void 0}}function hD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dD(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function pD(e){if(Array.isArray(e))return e}var yD="undoRedo",vD="undoRedo";function gD(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(n,r){var o=this,i=n&&n.length;if(i){var a=n.find((function(e){var t=uD(e,4),n=t[2],r=t[3];return n!==r}));if(a){var l=function(){var t=n.reduce((function(e,t){return e.push(iD(t)),e}),[]);Object(N["arrayEach"])(t,(function(t){t[1]=e.propToCol(t[1])}));var r=i>1?o.getSelected():[[t[0][0],t[0][1]]];return new gD.ChangeAction(t,r)};t.done(l,r)}}})),e.addHook("afterCreateRow",(function(e,n,r){t.done((function(){return new gD.CreateRowAction(e,n)}),r)})),e.addHook("beforeRemoveRow",(function(n,r,o,i){var a=function(){var o=t.instance.getSourceDataArray(),i=(o.length+n)%o.length,a=e.toPhysicalRow(i),l=Object(b["deepClone"])(o.slice(a,a+r));return new gD.RemoveRowAction(i,l,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop)};t.done(a,i)})),e.addHook("afterCreateCol",(function(e,n,r){t.done((function(){return new gD.CreateColumnAction(e,n)}),r)})),e.addHook("beforeRemoveCol",(function(n,r,o,i){var a=function(){var o=t.instance.getSourceDataArray(),i=(t.instance.countCols()+n)%t.instance.countCols(),a=[],l=[],s=[];Object(Tn["rangeEach"])(o.length-1,(function(t){var n=[],l=o[t];Object(Tn["rangeEach"])(i,i+(r-1),(function(t){n.push(l[e.toPhysicalColumn(t)])})),a.push(n)})),Object(Tn["rangeEach"])(r-1,(function(t){s.push(e.toPhysicalColumn(i+t))})),Array.isArray(e.getSettings().colHeaders)&&Object(Tn["rangeEach"])(r-1,(function(t){l.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}));var u=e.columnIndexMapper.getIndexesSequence(),c=e.rowIndexMapper.getIndexesSequence();return new gD.RemoveColumnAction(i,s,a,l,u,c,e.getSettings().fixedColumnsStart)};t.done(a,i)})),e.addHook("beforeCellAlignment",(function(e,n,r,o){t.done((function(){return new gD.CellAlignmentAction(e,n,r,o)}))})),e.addHook("beforeFilter",(function(e){t.done((function(){return new gD.FiltersAction(e)}))})),e.addHook("beforeRowMove",(function(e,n){!1!==e&&t.done((function(){return new gD.RowMoveAction(e,n)}))})),e.addHook("beforeMergeCells",(function(n,r){r||t.done((function(){return new gD.MergeCellsAction(e,n)}))})),e.addHook("afterUnmergeCells",(function(n,r){r||t.done((function(){return new gD.UnmergeCellsAction(e,n)}))})),e.addHook("afterInit",(function(){t.init()}))}gD.prototype.done=function(e,t){if(!this.ignoreNewActions){var n="UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;if(!n){var r=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",r,t);if(!1!==o){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}},gD.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var n=Object(b["deepClone"])(t),r=this.instance.runHooks("beforeUndo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,(function(){o.ignoreNewActions=!1,o.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},gD.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var n=Object(b["deepClone"])(t),r=this.instance.runHooks("beforeRedo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,(function(){o.ignoreNewActions=!1,o.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},gD.prototype.isUndoAvailable=function(){return this.doneActions.length>0},gD.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},gD.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},gD.prototype.isEnabled=function(){return this.enabled},gD.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,OD(e),this.registerShortcuts(),e.addHook("afterChange",wD)}},gD.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,CD(e),this.unregisterShortcuts(),e.removeHook("afterChange",wD)}},gD.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},gD.Action=function(){},gD.Action.prototype.undo=function(){},gD.Action.prototype.redo=function(){},gD.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},Object(b["inherit"])(gD.ChangeAction,gD.Action),gD.ChangeAction.prototype.undo=function(e,t){for(var n=Object(b["deepClone"])(this.changes),r=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");for(var l=0,s=n.length;l<s;l++){var u=uD(n[l],2),c=u[0],f=u[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&r===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},gD.ChangeAction.prototype.redo=function(e,t){for(var n=Object(b["deepClone"])(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},gD.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},Object(b["inherit"])(gD.CreateRowAction,gD.Action),gD.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},gD.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},gD.RemoveRowAction=function(e,t,n,r){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r},Object(b["inherit"])(gD.RemoveRowAction,gD.Action),gD.RemoveRowAction.prototype.undo=function(e,t){var n=e.getSettings();n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},gD.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},gD.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},Object(b["inherit"])(gD.CreateColumnAction,gD.Action),gD.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},gD.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},gD.RemoveColumnAction=function(e,t,n,r,o,i,a){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a},Object(b["inherit"])(gD.RemoveColumnAction,gD.Action),gD.RemoveColumnAction.prototype.undo=function(e,t){var n=this,r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(e,t,r){return r[n.indexes.indexOf(o[t])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(Object(N["arrayMap"])(this.data[s],i));var u=Object(N["arrayMap"])(this.headers,i),c=[];e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Object(N["arrayEach"])(e.getSourceDataArray(),(function(e,t){Object(N["arrayEach"])(o,(function(n,r){e[n]=l[t][r],c.push([t,n,e[n]])}))})),e.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),"undefined"!==typeof this.headers&&Object(N["arrayEach"])(u,(function(t,n){e.getSettings().colHeaders[o[n]]=t})),e.batchExecution((function(){e.rowIndexMapper.setIndexesSequence(n.rowPositions),e.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()},gD.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},gD.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},gD.CellAlignmentAction.prototype.undo=function(e,t){var n=this;Object(N["arrayEach"])(this.range,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&e.setCellMeta(t,r,"className",n.stateBefore[t][r]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()},gD.CellAlignmentAction.prototype.redo=function(e,t){nc(this.range,this.type,this.alignment,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),e.addHookOnce("afterViewRender",t),e.render()},gD.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},Object(b["inherit"])(gD.FiltersAction,gD.Action),gD.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},gD.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var bD=function(e){JN(n,e);var t=eD(n);function n(e,r){var o;$N(this,n),o=t.call(this),o.cellRange=r;var i=o.cellRange.getTopStartCorner(),a=o.cellRange.getBottomEndCorner();return o.rangeData=e.getData(i.row,i.col,a.row,a.col),o}return QN(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}]),n}(gD.Action);gD.MergeCellsAction=bD;var mD=function(e){JN(n,e);var t=eD(n);function n(e,r){var o;return $N(this,n),o=t.call(this),o.cellRange=r,o}return QN(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}]),n}(gD.Action);function wD(e,t){var n=this;if("loadData"===t)return n.undoRedo.clear()}function OD(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function CD(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}gD.UnmergeCellsAction=mD,gD.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"},Object(b["inherit"])(gD.RowMoveAction,gD.Action),gD.RowMoveAction.prototype.undo=function(e,t){var n=this,r=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((function(e){return e>n.finalIndex})),a=o.filter((function(e){return e<=n.finalIndex})),l=i.sort((function(e,t){return t-e})).concat(a.sort((function(e,t){return e-t})));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);r.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},gD.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},gD.prototype.init=function(){var e=this.instance.getSettings().undo,t="undefined"===typeof e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},gD.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=function(e){return!e.altKey},o={runOnlyIf:r,group:yD};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)},gD.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(yD)};var SD=Ne["a"].getSingleton();SD.add("afterUpdateSettings",(function(){var e;null===(e=this.getPlugin("undoRedo"))||void 0===e||e.init()})),SD.register("beforeUndo"),SD.register("afterUndo"),SD.register("beforeRedo"),SD.register("afterRedo"),gD.PLUGIN_KEY=vD,gD.SETTING_KEYS=!0;var RD=gD;function kD(){Object(vr["d"])(jo),Object(vr["d"])(ai),Object(vr["d"])(Pi),Object(vr["d"])(La),Object(vr["d"])(bl),Object(vr["d"])(yu),Object(vr["d"])(Bu),Object(vr["d"])(Fc),Object(vr["d"])(Ch),Object(vr["d"])(md),Object(vr["d"])(lp),Object(vr["d"])(Sp),Object(vr["d"])(Vp),Object(vr["d"])(Ny),Object(vr["d"])(jC),Object(vr["d"])(NS),Object(vr["d"])(CR),Object(vr["d"])(lk),Object(vr["d"])(Lk),Object(vr["d"])(YE),Object(vr["d"])(cj),Object(vr["d"])(bT),Object(vr["d"])(FT),Object(vr["d"])(ZP),Object(vr["d"])(PM),Object(vr["d"])(GM),Object(vr["d"])(I_),Object(vr["d"])(SH),Object(vr["d"])(zH),Object(vr["d"])(yN),Object(vr["d"])(AN),Object(vr["d"])(XN),Object(vr["d"])(RD)}function ED(){an(),Nn(),qn(),yr(),kD()}var jD,TD,PD,MD,AD,ID=n("097b");function _D(e){var t="undefined"!==typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var n,r=this.first(),o=r.data("handsontable");if("string"!==typeof t){var i=t||{};return o?o.updateSettings(i):(o=new e.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if("undefined"===typeof o[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var a,l=arguments.length,s=new Array(l>1?l-1:0),u=1;u<l;u++)s[u-1]=arguments[u];n=(a=o[t]).call.apply(a,[o].concat(s)),"destroy"===t&&r.removeData()}return n})}ED(),_D(p["a"]),p["a"].__GhostTable=Kr,p["a"]._getListenersCounter=we["b"],p["a"]._getRegisteredMapsCounter=ID["b"],p["a"].EventManager=we["a"];var xD=[N,$f,nw,r,Dr,ml,D,Tn,b,L,B,Yh],HD=[v,g];p["a"].helper={},p["a"].dom={},N["arrayEach"](xD,(function(e){N["arrayEach"](Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(p["a"].helper[t]=e[t])}))})),N["arrayEach"](HD,(function(e){N["arrayEach"](Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(p["a"].dom[t]=e[t])}))})),p["a"].cellTypes=null!==(jD=p["a"].cellTypes)&&void 0!==jD?jD:{},N["arrayEach"](Object(pr["b"])(),(function(e){p["a"].cellTypes[e]=Object(pr["a"])(e)})),p["a"].cellTypes.registerCellType=pr["d"],p["a"].cellTypes.getCellType=pr["a"],p["a"].editors=null!==(TD=p["a"].editors)&&void 0!==TD?TD:{},N["arrayEach"](Object(on["c"])(),(function(e){p["a"].editors["".concat(L["toUpperCaseFirst"](e),"Editor")]=Object(on["a"])(e)})),p["a"].editors.registerEditor=on["e"],p["a"].editors.getEditor=on["a"],p["a"].renderers=null!==(PD=p["a"].renderers)&&void 0!==PD?PD:{},N["arrayEach"](Object(Hn["a"])(),(function(e){var t=Object(Hn["b"])(e);"base"===e&&(p["a"].renderers.cellDecorator=t),p["a"].renderers["".concat(L["toUpperCaseFirst"](e),"Renderer")]=t})),p["a"].renderers.registerRenderer=Hn["d"],p["a"].renderers.getRenderer=Hn["b"],p["a"].validators=null!==(MD=p["a"].validators)&&void 0!==MD?MD:{},N["arrayEach"](Object($n["a"])(),(function(e){p["a"].validators["".concat(L["toUpperCaseFirst"](e),"Validator")]=Object($n["b"])(e)})),p["a"].validators.registerValidator=$n["d"],p["a"].validators.getValidator=$n["b"],p["a"].plugins=null!==(AD=p["a"].plugins)&&void 0!==AD?AD:{},N["arrayEach"](Object(vr["b"])(),(function(e){p["a"].plugins[e]=Object(vr["a"])(e)})),p["a"].plugins["".concat(L["toUpperCaseFirst"](Hr.PLUGIN_KEY),"Plugin")]=Hr,p["a"].plugins.registerPlugin=vr["d"],p["a"].plugins.getPlugin=vr["a"];var ND=p["a"],DD=function(e,t){var n=t.className;void 0!==n&&ND.dom.addClass(e,n)},LD=function(e,t,n,r,o,i,a){var l=document.createElement("div");l.style.width=10*i+"px",DD(t,a),ND.dom.addClass(l,"progressBar"),ND.dom.empty(t),t.appendChild(l)},BD=function(e,t,n,r,o,i,a){ND.renderers.TextRenderer.apply(this,[e,t,n,r,o,"★".repeat(i),a])},VD=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),FD=function(e,t,n,r,o,i){if(0===n){var a=e.parentElement;null!==a&&(i.instance.getDataAtRowProp(t,"0")?ND.dom.addClass(a,f):ND.dom.removeClass(a,f),t%2===0?ND.dom.addClass(a,h):ND.dom.removeClass(a,h))}},WD=function(e,t){var n=document.createElement("input");n.type="checkbox",e>=0&&this.getDataAtRowProp(e,"0")&&(n.checked=!0),ND.dom.empty(t),t.appendChild(n)};function UD(e,t){if(!(e<0)){var n=this.isRtl()?"htRight":"htLeft";t.firstChild&&(VD.has(e.toString())?(ND.dom.removeClass(t.firstChild,n),ND.dom.addClass(t.firstChild,VD.get(e.toString()))):ND.dom.addClass(t.firstChild,n))}}var zD=function(e,t){var n=e.target;-1===t.col&&e.target&&"INPUT"===n.nodeName&&(e.preventDefault(),this.setDataAtRowProp(t.row,"0",!n.checked))},GD={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:zD,afterGetColHeader:UD,afterGetRowHeader:WD,beforeRenderer:FD,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:LD,readOnly:!0,className:"htMiddle"},{data:9,renderer:BD,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:d()}},components:{HotTable:u["a"]}},YD=GD,XD=(n("75e0"),n("a6c2")),KD=Object(XD["a"])(YD,l,s,!1,null,null,null),$D=KD.exports,qD={name:"App",components:{DataGrid:$D}},QD=qD,JD=Object(XD["a"])(QD,i,a,!1,null,null,null),ZD=JD.exports;console.log("Handsontable: v"+ND.version+" ("+ND.buildDate+") Wrapper: v"+u["a"].version+" Vue: v"+o["a"].version),o["a"].config.silent=!0,new o["a"]({render:function(e){return e(ZD)}}).$mount("#app")},cffe:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n("3128"),n("83a9"),n("bebe"),n("c9cc"),n("7003"),n("7cd7"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("b976"),o=n("8fc6");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(){return u="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=c(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},u.apply(this,arguments)}function c(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=g(e),null===e)break;return e}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function d(e){var t=v();return function(){var n,r=g(e);if(t){var o=g(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){if(t&&("object"===i(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var b=function(e){f(n,e);var t=d(n);function n(){return a(this,n),t.apply(this,arguments)}return s(n,[{key:"insert",value:function(e,t){this.indexedValues=Object(o["a"])(this.indexedValues,e,t,this.initValueOrFn),u(g(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Object(o["b"])(this.indexedValues,e),u(g(n.prototype),"remove",this).call(this,e)}}]),n}(r["a"])},d1f5:function(e,t,n){"use strict";n.r(t),n.d(t,"to2dArray",(function(){return r})),n.d(t,"extendArray",(function(){return o})),n.d(t,"pivot",(function(){return i})),n.d(t,"arrayReduce",(function(){return a})),n.d(t,"arrayFilter",(function(){return l})),n.d(t,"arrayMap",(function(){return s})),n.d(t,"arrayEach",(function(){return u})),n.d(t,"arraySum",(function(){return c})),n.d(t,"arrayMax",(function(){return f})),n.d(t,"arrayMin",(function(){return h})),n.d(t,"arrayAvg",(function(){return d})),n.d(t,"arrayFlatten",(function(){return p})),n.d(t,"arrayUnique",(function(){return y})),n.d(t,"getDifferenceOfArrays",(function(){return v})),n.d(t,"getIntersectionOfArrays",(function(){return g})),n.d(t,"getUnionOfArrays",(function(){return b})),n.d(t,"stringToArray",(function(){return m}));n("841e"),n("5d07"),n("2a17"),n("212c"),n("b43b"),n("129d"),n("bebe"),n("267c"),n("986e"),n("8116"),n("bdb6"),n("d562"),n("2931"),n("b503");function r(e){var t=e.length,n=0;while(n<t)e[n]=[e[n]],n+=1}function o(e,t){var n=t.length,r=0;while(r<n)e.push(t[r]),r+=1}function i(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function a(e,t,n,r){var o=-1,i=e,a=n;Array.isArray(e)||(i=Array.from(e));var l=i.length;r&&l&&(o+=1,a=i[o]),o+=1;while(o<l)a=t(a,i[o],o,i),o+=1;return a}function l(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];t(l,n,r)&&(a+=1,i[a]=l),n+=1}return i}function s(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];a+=1,i[a]=t(l,n,r),n+=1}return i}function u(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));var o=r.length;while(n<o){if(!1===t(r[n],n,r))break;n+=1}return e}function c(e){return a(e,(function(e,t){return e+t}),0)}function f(e){return a(e,(function(e,t){return e>t?e:t}),Array.isArray(e)?e[0]:void 0)}function h(e){return a(e,(function(e,t){return e<t?e:t}),Array.isArray(e)?e[0]:void 0)}function d(e){return e.length?c(e)/e.length:0}function p(e){return a(e,(function(e,t){return e.concat(Array.isArray(t)?p(t):t)}),[])}function y(e){var t=[];return u(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return u(i,(function(e){a=a.filter((function(t){return!e.includes(t)}))})),a}function g(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return u(i,(function(e){a=a.filter((function(t){return e.includes(t)}))})),a}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=new Set(o);return u(i,(function(e){u(e,(function(e){a.has(e)||a.add(e)}))})),Array.from(a)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}},e015:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("2931"),n("7ae5"),n("ba9f");var r=n("d1f5");function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=Object(r["arrayReduce"])(e,(function(e,t,r){var o=t.replace(/\r?\n\s*/g,""),i=n[r]?n[r]:"";return e+o+i}),"");return i.trim()}},e0a9:function(e,t,n){"use strict";n.r(t),n.d(t,"toUpperCaseFirst",(function(){return i})),n.d(t,"equalsIgnoreCase",(function(){return a})),n.d(t,"randomString",(function(){return l})),n.d(t,"isPercentValue",(function(){return s})),n.d(t,"substitute",(function(){return u})),n.d(t,"stripTags",(function(){return c})),n.d(t,"sanitize",(function(){return f}));n("212c"),n("bebe"),n("bfe9"),n("2931"),n("7ae5");var r=n("780f"),o=n("c61e");function i(e){return e[0].toUpperCase()+e.substr(1)}function a(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.length;while(i){i-=1;var a=Object(o["stringify"])(n[i]).toLowerCase();-1===e.indexOf(a)&&e.push(a)}return 1===e.length}function l(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function s(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}function c(e){return f("".concat(e),{ALLOWED_TAGS:[]})}function f(e,t){return r.sanitize(e,t)}},e86f:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));n("2a17"),n("60ed"),n("8116"),n("bebe"),n("d562"),n("267c"),n("986e"),n("9827"),n("3128"),n("83a9"),n("c9cc"),n("7003"),n("7cd7"),n("2b96"),n("3d35"),n("213d"),n("5d07"),n("841e"),n("b43b"),n("0a66"),n("2931");var r=n("b976"),o=n("8fc6"),i=n("349e"),a=n("3137"),l=n("3731");function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e){return d(e)||h(e)||f(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function h(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){if(Array.isArray(e))return p(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(){return b="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=m(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b.apply(this,arguments)}function m(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=E(e),null===e)break;return e}function w(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function C(e){var t=k();return function(){var n,r=E(e);if(t){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){if(t&&("object"===s(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(e){w(n,e);var t=C(n);function n(){var e;y(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),j(R(e),"orderOfIndexes",[]),e}return g(n,[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){this.orderOfIndexes=u(Array(e.length).keys()),b(E(n.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=Object(i["b"])(this.orderOfIndexes,[e]),Object(l["isFunction"])(this.initValueOrFn)?b(E(n.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):b(E(n.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,b(E(n.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=Object(o["a"])(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Object(a["b"])(this.orderOfIndexes,t),b(E(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Object(o["b"])(this.indexedValues,e),this.orderOfIndexes=Object(i["b"])(this.orderOfIndexes,e),this.orderOfIndexes=Object(a["a"])(this.orderOfIndexes,e),b(E(n.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}]),n}(r["a"])},e901:function(e,t,n){"use strict";n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){l(e,t),t.set(e,n)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=h(e,t,"get");return c(e,n)}function c(e,t){return t.get?t.get.call(e):t.value}function f(e,t,n){var r=h(e,t,"set");return d(e,r,n),n}function h(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function d(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var p=new WeakMap,y=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,e),s(this,"row",null),s(this,"col",null),a(this,p,{writable:!0,value:!1}),f(this,p,o),"undefined"!==typeof t&&"undefined"!==typeof n&&(this.row=t,this.col=n)}return i(e,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&(u(this,p)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&(u(this,p)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&(u(this,p)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&(u(this,p)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,u(this,p))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();t["a"]=y},e923:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));n("3128"),n("83a9"),n("bebe"),n("c9cc"),n("2b96"),n("3d35"),n("213d"),n("8116"),n("5d07"),n("d562");var r=n("cffe"),o=n("d1f5");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function f(e){var t=p();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===i(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var v=function(e){u(n,e);var t=f(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a(this,n),t.call(this,e)}return s(n,[{key:"getHiddenIndexes",value:function(){return Object(o["arrayReduce"])(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}]),n}(r["a"])},f253:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"g",(function(){return k})),n.d(t,"b",(function(){return j})),n.d(t,"f",(function(){return T})),n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return M})),n.d(t,"e",(function(){return I}));var r=n("bb9b"),o=n("d1f5"),i=n("c61e"),a=n("1f1d"),l=n("179d");n("4e92"),n("acdb");function s(e,t){var n=Array.isArray(e)&&Number.isInteger(t);return n?e[t]:e}var u=Object(l["a"])("phraseFormatters"),c=u.register,f=u.getValues;function h(e,t){c(e,t)}function d(){return f()}h("pluralize",s);var p,y=n("8034");function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var g=(p={languageCode:"en-US"},v(p,y["CONTEXTMENU_ITEMS_NO_ITEMS"],"No available options"),v(p,y["CONTEXTMENU_ITEMS_ROW_ABOVE"],"Insert row above"),v(p,y["CONTEXTMENU_ITEMS_ROW_BELOW"],"Insert row below"),v(p,y["CONTEXTMENU_ITEMS_INSERT_LEFT"],"Insert column left"),v(p,y["CONTEXTMENU_ITEMS_INSERT_RIGHT"],"Insert column right"),v(p,y["CONTEXTMENU_ITEMS_REMOVE_ROW"],["Remove row","Remove rows"]),v(p,y["CONTEXTMENU_ITEMS_REMOVE_COLUMN"],["Remove column","Remove columns"]),v(p,y["CONTEXTMENU_ITEMS_UNDO"],"Undo"),v(p,y["CONTEXTMENU_ITEMS_REDO"],"Redo"),v(p,y["CONTEXTMENU_ITEMS_READ_ONLY"],"Read only"),v(p,y["CONTEXTMENU_ITEMS_CLEAR_COLUMN"],"Clear column"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT"],"Alignment"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_LEFT"],"Left"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_CENTER"],"Center"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT"],"Right"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY"],"Justify"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_TOP"],"Top"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE"],"Middle"),v(p,y["CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM"],"Bottom"),v(p,y["CONTEXTMENU_ITEMS_FREEZE_COLUMN"],"Freeze column"),v(p,y["CONTEXTMENU_ITEMS_UNFREEZE_COLUMN"],"Unfreeze column"),v(p,y["CONTEXTMENU_ITEMS_BORDERS"],"Borders"),v(p,y["CONTEXTMENU_ITEMS_BORDERS_TOP"],"Top"),v(p,y["CONTEXTMENU_ITEMS_BORDERS_RIGHT"],"Right"),v(p,y["CONTEXTMENU_ITEMS_BORDERS_BOTTOM"],"Bottom"),v(p,y["CONTEXTMENU_ITEMS_BORDERS_LEFT"],"Left"),v(p,y["CONTEXTMENU_ITEMS_REMOVE_BORDERS"],"Remove border(s)"),v(p,y["CONTEXTMENU_ITEMS_ADD_COMMENT"],"Add comment"),v(p,y["CONTEXTMENU_ITEMS_EDIT_COMMENT"],"Edit comment"),v(p,y["CONTEXTMENU_ITEMS_REMOVE_COMMENT"],"Delete comment"),v(p,y["CONTEXTMENU_ITEMS_READ_ONLY_COMMENT"],"Read-only comment"),v(p,y["CONTEXTMENU_ITEMS_MERGE_CELLS"],"Merge cells"),v(p,y["CONTEXTMENU_ITEMS_UNMERGE_CELLS"],"Unmerge cells"),v(p,y["CONTEXTMENU_ITEMS_COPY"],"Copy"),v(p,y["CONTEXTMENU_ITEMS_CUT"],"Cut"),v(p,y["CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD"],"Insert child row"),v(p,y["CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD"],"Detach from parent"),v(p,y["CONTEXTMENU_ITEMS_HIDE_COLUMN"],["Hide column","Hide columns"]),v(p,y["CONTEXTMENU_ITEMS_SHOW_COLUMN"],["Show column","Show columns"]),v(p,y["CONTEXTMENU_ITEMS_HIDE_ROW"],["Hide row","Hide rows"]),v(p,y["CONTEXTMENU_ITEMS_SHOW_ROW"],["Show row","Show rows"]),v(p,y["FILTERS_CONDITIONS_NONE"],"None"),v(p,y["FILTERS_CONDITIONS_EMPTY"],"Is empty"),v(p,y["FILTERS_CONDITIONS_NOT_EMPTY"],"Is not empty"),v(p,y["FILTERS_CONDITIONS_EQUAL"],"Is equal to"),v(p,y["FILTERS_CONDITIONS_NOT_EQUAL"],"Is not equal to"),v(p,y["FILTERS_CONDITIONS_BEGINS_WITH"],"Begins with"),v(p,y["FILTERS_CONDITIONS_ENDS_WITH"],"Ends with"),v(p,y["FILTERS_CONDITIONS_CONTAINS"],"Contains"),v(p,y["FILTERS_CONDITIONS_NOT_CONTAIN"],"Does not contain"),v(p,y["FILTERS_CONDITIONS_GREATER_THAN"],"Greater than"),v(p,y["FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL"],"Greater than or equal to"),v(p,y["FILTERS_CONDITIONS_LESS_THAN"],"Less than"),v(p,y["FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL"],"Less than or equal to"),v(p,y["FILTERS_CONDITIONS_BETWEEN"],"Is between"),v(p,y["FILTERS_CONDITIONS_NOT_BETWEEN"],"Is not between"),v(p,y["FILTERS_CONDITIONS_AFTER"],"After"),v(p,y["FILTERS_CONDITIONS_BEFORE"],"Before"),v(p,y["FILTERS_CONDITIONS_TODAY"],"Today"),v(p,y["FILTERS_CONDITIONS_TOMORROW"],"Tomorrow"),v(p,y["FILTERS_CONDITIONS_YESTERDAY"],"Yesterday"),v(p,y["FILTERS_VALUES_BLANK_CELLS"],"Blank cells"),v(p,y["FILTERS_DIVS_FILTER_BY_CONDITION"],"Filter by condition"),v(p,y["FILTERS_DIVS_FILTER_BY_VALUE"],"Filter by value"),v(p,y["FILTERS_LABELS_CONJUNCTION"],"And"),v(p,y["FILTERS_LABELS_DISJUNCTION"],"Or"),v(p,y["FILTERS_BUTTONS_SELECT_ALL"],"Select all"),v(p,y["FILTERS_BUTTONS_CLEAR"],"Clear"),v(p,y["FILTERS_BUTTONS_OK"],"OK"),v(p,y["FILTERS_BUTTONS_CANCEL"],"Cancel"),v(p,y["FILTERS_BUTTONS_PLACEHOLDER_SEARCH"],"Search"),v(p,y["FILTERS_BUTTONS_PLACEHOLDER_VALUE"],"Value"),v(p,y["FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE"],"Second value"),p),b=g,m=b.languageCode,w=Object(l["a"])("languagesDictionaries"),O=w.register,C=w.getItem,S=w.hasItem,R=w.getValues;function k(e,t){var n=e,o=t;return Object(r["isObject"])(e)&&(o=e,n=o.languageCode),E(n,o),O(n,Object(r["deepClone"])(o)),Object(r["deepClone"])(o)}function E(e,t){e!==m&&Object(a["a"])(t,C(m))}function j(e){return T(e)?Object(r["deepClone"])(C(e)):null}function T(e){return S(e)}function P(){return R()}function M(e,t,n){var r=j(e);if(null===r)return null;var o=r[t];if(Object(i["isUndefined"])(o))return null;var a=A(o,n);return Array.isArray(a)?a[0]:a}function A(e,t){var n=e;return Object(o["arrayEach"])(d(),(function(r){n=r(e,t)})),n}function I(e){var t=Object(a["b"])(e);return T(t)||(t=m,Object(a["c"])(e)),t}k(b)},f65c:function(e,t,n){"use strict";var r=n("c76a"),o=n("fe8a"),i=n("cb3f"),a=n("0393"),l=n("f253"),s=n("844f"),u=n("f6e6"),c=n("55a6");function f(e,t){var n=new r["a"](e,t||{},o["d"]);return n.init(),n}Object(s["d"])(u["a"]),f.editors={BaseEditor:c["a"]},f.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r["a"](e,t,o["d"])},f.DefaultSettings=Object(i["a"])(),f.hooks=a["a"].getSingleton(),f.packageName="handsontable",f.buildDate="05/07/2022 13:14:36",f.version="12.1.1",f.languages={dictionaryKeys:l["a"],getLanguageDictionary:l["b"],getLanguagesDictionaries:l["c"],registerLanguageDictionary:l["g"],getTranslatedPhrase:l["d"]},t["a"]=f},f6e6:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("88eb"),o=n("2d75"),i="text",a={CELL_TYPE:i,editor:r["a"],renderer:o["a"]}},fe8a:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));n("8116"),n("bebe"),n("5d07"),n("dd0b"),n("d562"),n("2b96"),n("3d35");var r=new WeakMap,o=Symbol("rootInstance");function i(e){r.set(e,!0)}function a(e){return e===o}function l(e){return r.has(e)}}});
//# sourceMappingURL=app.71e35f37.js.map